{"version":3,"file":"feathers-pinia.umd.cjs","sources":["../node_modules/fast-deep-equal/index.js","../node_modules/fast-copy/dist/esm/index.mjs","../src/utils/define-properties.ts","../src/utils/convert-data.ts","../src/utils/utils.ts","../src/utils/use-counter.ts","../src/utils/deep-unref.ts","../src/utils/use-instance-defaults.ts","../node_modules/@vueuse/shared/index.mjs","../node_modules/fast-json-stable-stringify/index.js","../src/use-find-get/utils.ts","../src/use-find-get/utils-pagination.ts","../src/use-find-get/use-find.ts","../src/use-find-get/use-get.ts","../src/create-pinia-service.ts","../node_modules/sift/es5m/index.js","../src/stores/utils-custom-operators.ts","../src/stores/local-queries.ts","../src/stores/storage.ts","../src/stores/temps.ts","../src/stores/clones.ts","../src/stores/all-storage-types.ts","../node_modules/isomorphic-mongo-objectid/src/isomorphic-mongo-objectid.js","../node_modules/isomorphic-mongo-objectid/index.js","../src/modeling/use-model-instance.ts","../src/stores/use-data-store.ts","../node_modules/@feathersjs/commons/lib/debug.js","../node_modules/@feathersjs/commons/lib/index.js","../src/stores/pagination.ts","../src/stores/pending.ts","../src/stores/event-locks.ts","../src/stores/use-service-store.ts","../src/stores/event-queue-promise.ts","../node_modules/just-debounce/index.js","../src/stores/events.ts","../src/hooks/0-prepare-query.ts","../src/hooks/1-set-pending.ts","../src/hooks/2-event-locks.ts","../src/hooks/3-sync-store.ts","../src/hooks/4-model-instances.ts","../src/hooks/5-handle-find-ssr.ts","../src/hooks/6-normalize-find.ts","../src/hooks/7-skip-get-if-exists.ts","../src/hooks/8-patch-diffs.ts","../src/hooks/index.ts","../src/modeling/use-feathers-instance.ts","../src/modeling/store-associated.ts","../src/localstorage/storage-sync.ts","../src/localstorage/clear-storage.ts","../src/create-pinia-client.ts","../src/feathers-ofetch.ts","../src/unplugin-auto-import-preset.ts","../node_modules/jwt-decode/build/jwt-decode.esm.js","../src/use-auth/use-auth.ts"],"sourcesContent":["'use strict';\n\n// do not edit .js files directly - edit src/index.jst\n\n\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n","var toStringFunction = Function.prototype.toString;\nvar create = Object.create;\nvar toStringObject = Object.prototype.toString;\n/**\n * @classdesc Fallback cache for when WeakMap is not natively supported\n */\nvar LegacyCache = /** @class */ (function () {\n    function LegacyCache() {\n        this._keys = [];\n        this._values = [];\n    }\n    LegacyCache.prototype.has = function (key) {\n        return !!~this._keys.indexOf(key);\n    };\n    LegacyCache.prototype.get = function (key) {\n        return this._values[this._keys.indexOf(key)];\n    };\n    LegacyCache.prototype.set = function (key, value) {\n        this._keys.push(key);\n        this._values.push(value);\n    };\n    return LegacyCache;\n}());\nfunction createCacheLegacy() {\n    return new LegacyCache();\n}\nfunction createCacheModern() {\n    return new WeakMap();\n}\n/**\n * Get a new cache object to prevent circular references.\n */\nvar createCache = typeof WeakMap !== 'undefined' ? createCacheModern : createCacheLegacy;\n/**\n * Get an empty version of the object with the same prototype it has.\n */\nfunction getCleanClone(prototype) {\n    if (!prototype) {\n        return create(null);\n    }\n    var Constructor = prototype.constructor;\n    if (Constructor === Object) {\n        return prototype === Object.prototype ? {} : create(prototype);\n    }\n    if (~toStringFunction.call(Constructor).indexOf('[native code]')) {\n        try {\n            return new Constructor();\n        }\n        catch (_a) { }\n    }\n    return create(prototype);\n}\nfunction getRegExpFlagsLegacy(regExp) {\n    var flags = '';\n    if (regExp.global) {\n        flags += 'g';\n    }\n    if (regExp.ignoreCase) {\n        flags += 'i';\n    }\n    if (regExp.multiline) {\n        flags += 'm';\n    }\n    if (regExp.unicode) {\n        flags += 'u';\n    }\n    if (regExp.sticky) {\n        flags += 'y';\n    }\n    return flags;\n}\nfunction getRegExpFlagsModern(regExp) {\n    return regExp.flags;\n}\n/**\n * Get the flags to apply to the copied regexp.\n */\nvar getRegExpFlags = /test/g.flags === 'g' ? getRegExpFlagsModern : getRegExpFlagsLegacy;\nfunction getTagLegacy(value) {\n    var type = toStringObject.call(value);\n    return type.substring(8, type.length - 1);\n}\nfunction getTagModern(value) {\n    return value[Symbol.toStringTag] || getTagLegacy(value);\n}\n/**\n * Get the tag of the value passed, so that the correct copier can be used.\n */\nvar getTag = typeof Symbol !== 'undefined' ? getTagModern : getTagLegacy;\n\nvar defineProperty = Object.defineProperty, getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor, getOwnPropertyNames = Object.getOwnPropertyNames, getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar _a = Object.prototype, hasOwnProperty = _a.hasOwnProperty, propertyIsEnumerable = _a.propertyIsEnumerable;\nvar SUPPORTS_SYMBOL = typeof getOwnPropertySymbols === 'function';\nfunction getStrictPropertiesModern(object) {\n    return getOwnPropertyNames(object).concat(getOwnPropertySymbols(object));\n}\n/**\n * Get the properites used when copying objects strictly. This includes both keys and symbols.\n */\nvar getStrictProperties = SUPPORTS_SYMBOL\n    ? getStrictPropertiesModern\n    : getOwnPropertyNames;\n/**\n * Striclty copy all properties contained on the object.\n */\nfunction copyOwnPropertiesStrict(value, clone, state) {\n    var properties = getStrictProperties(value);\n    for (var index = 0, length_1 = properties.length, property = void 0, descriptor = void 0; index < length_1; ++index) {\n        property = properties[index];\n        if (property === 'callee' || property === 'caller') {\n            continue;\n        }\n        descriptor = getOwnPropertyDescriptor(value, property);\n        if (!descriptor) {\n            // In extra edge cases where the property descriptor cannot be retrived, fall back to\n            // the loose assignment.\n            clone[property] = state.copier(value[property], state);\n            continue;\n        }\n        // Only clone the value if actually a value, not a getter / setter.\n        if (!descriptor.get && !descriptor.set) {\n            descriptor.value = state.copier(descriptor.value, state);\n        }\n        try {\n            defineProperty(clone, property, descriptor);\n        }\n        catch (error) {\n            // Tee above can fail on node in edge cases, so fall back to the loose assignment.\n            clone[property] = descriptor.value;\n        }\n    }\n    return clone;\n}\n/**\n * Deeply copy the indexed values in the array.\n */\nfunction copyArrayLoose(array, state) {\n    var clone = new state.Constructor();\n    // set in the cache immediately to be able to reuse the object recursively\n    state.cache.set(array, clone);\n    for (var index = 0, length_2 = array.length; index < length_2; ++index) {\n        clone[index] = state.copier(array[index], state);\n    }\n    return clone;\n}\n/**\n * Deeply copy the indexed values in the array, as well as any custom properties.\n */\nfunction copyArrayStrict(array, state) {\n    var clone = new state.Constructor();\n    // set in the cache immediately to be able to reuse the object recursively\n    state.cache.set(array, clone);\n    return copyOwnPropertiesStrict(array, clone, state);\n}\n/**\n * Copy the contents of the ArrayBuffer.\n */\nfunction copyArrayBuffer(arrayBuffer, _state) {\n    return arrayBuffer.slice(0);\n}\n/**\n * Create a new Blob with the contents of the original.\n */\nfunction copyBlob(blob, _state) {\n    return blob.slice(0, blob.size, blob.type);\n}\n/**\n * Create a new DataView with the contents of the original.\n */\nfunction copyDataView(dataView, state) {\n    return new state.Constructor(copyArrayBuffer(dataView.buffer));\n}\n/**\n * Create a new Date based on the time of the original.\n */\nfunction copyDate(date, state) {\n    return new state.Constructor(date.getTime());\n}\n/**\n * Deeply copy the keys and values of the original.\n */\nfunction copyMapLoose(map, state) {\n    var clone = new state.Constructor();\n    // set in the cache immediately to be able to reuse the object recursively\n    state.cache.set(map, clone);\n    map.forEach(function (value, key) {\n        clone.set(key, state.copier(value, state));\n    });\n    return clone;\n}\n/**\n * Deeply copy the keys and values of the original, as well as any custom properties.\n */\nfunction copyMapStrict(map, state) {\n    return copyOwnPropertiesStrict(map, copyMapLoose(map, state), state);\n}\nfunction copyObjectLooseLegacy(object, state) {\n    var clone = getCleanClone(state.prototype);\n    // set in the cache immediately to be able to reuse the object recursively\n    state.cache.set(object, clone);\n    for (var key in object) {\n        if (hasOwnProperty.call(object, key)) {\n            clone[key] = state.copier(object[key], state);\n        }\n    }\n    return clone;\n}\nfunction copyObjectLooseModern(object, state) {\n    var clone = getCleanClone(state.prototype);\n    // set in the cache immediately to be able to reuse the object recursively\n    state.cache.set(object, clone);\n    for (var key in object) {\n        if (hasOwnProperty.call(object, key)) {\n            clone[key] = state.copier(object[key], state);\n        }\n    }\n    var symbols = getOwnPropertySymbols(object);\n    for (var index = 0, length_3 = symbols.length, symbol = void 0; index < length_3; ++index) {\n        symbol = symbols[index];\n        if (propertyIsEnumerable.call(object, symbol)) {\n            clone[symbol] = state.copier(object[symbol], state);\n        }\n    }\n    return clone;\n}\n/**\n * Deeply copy the properties (keys and symbols) and values of the original.\n */\nvar copyObjectLoose = SUPPORTS_SYMBOL\n    ? copyObjectLooseModern\n    : copyObjectLooseLegacy;\n/**\n * Deeply copy the properties (keys and symbols) and values of the original, as well\n * as any hidden or non-enumerable properties.\n */\nfunction copyObjectStrict(object, state) {\n    var clone = getCleanClone(state.prototype);\n    // set in the cache immediately to be able to reuse the object recursively\n    state.cache.set(object, clone);\n    return copyOwnPropertiesStrict(object, clone, state);\n}\n/**\n * Create a new primitive wrapper from the value of the original.\n */\nfunction copyPrimitiveWrapper(primitiveObject, state) {\n    return new state.Constructor(primitiveObject.valueOf());\n}\n/**\n * Create a new RegExp based on the value and flags of the original.\n */\nfunction copyRegExp(regExp, state) {\n    var clone = new state.Constructor(regExp.source, getRegExpFlags(regExp));\n    clone.lastIndex = regExp.lastIndex;\n    return clone;\n}\n/**\n * Return the original value (an identity function).\n *\n * @note\n * THis is used for objects that cannot be copied, such as WeakMap.\n */\nfunction copySelf(value, _state) {\n    return value;\n}\n/**\n * Deeply copy the values of the original.\n */\nfunction copySetLoose(set, state) {\n    var clone = new state.Constructor();\n    // set in the cache immediately to be able to reuse the object recursively\n    state.cache.set(set, clone);\n    set.forEach(function (value) {\n        clone.add(state.copier(value, state));\n    });\n    return clone;\n}\n/**\n * Deeply copy the values of the original, as well as any custom properties.\n */\nfunction copySetStrict(set, state) {\n    return copyOwnPropertiesStrict(set, copySetLoose(set, state), state);\n}\n\nvar isArray = Array.isArray;\nvar assign = Object.assign;\nvar getPrototypeOf = Object.getPrototypeOf || (function (obj) { return obj.__proto__; });\nvar DEFAULT_LOOSE_OPTIONS = {\n    array: copyArrayLoose,\n    arrayBuffer: copyArrayBuffer,\n    blob: copyBlob,\n    dataView: copyDataView,\n    date: copyDate,\n    error: copySelf,\n    map: copyMapLoose,\n    object: copyObjectLoose,\n    regExp: copyRegExp,\n    set: copySetLoose,\n};\nvar DEFAULT_STRICT_OPTIONS = assign({}, DEFAULT_LOOSE_OPTIONS, {\n    array: copyArrayStrict,\n    map: copyMapStrict,\n    object: copyObjectStrict,\n    set: copySetStrict,\n});\n/**\n * Get the copiers used for each specific object tag.\n */\nfunction getTagSpecificCopiers(options) {\n    return {\n        Arguments: options.object,\n        Array: options.array,\n        ArrayBuffer: options.arrayBuffer,\n        Blob: options.blob,\n        Boolean: copyPrimitiveWrapper,\n        DataView: options.dataView,\n        Date: options.date,\n        Error: options.error,\n        Float32Array: options.arrayBuffer,\n        Float64Array: options.arrayBuffer,\n        Int8Array: options.arrayBuffer,\n        Int16Array: options.arrayBuffer,\n        Int32Array: options.arrayBuffer,\n        Map: options.map,\n        Number: copyPrimitiveWrapper,\n        Object: options.object,\n        Promise: copySelf,\n        RegExp: options.regExp,\n        Set: options.set,\n        String: copyPrimitiveWrapper,\n        WeakMap: copySelf,\n        WeakSet: copySelf,\n        Uint8Array: options.arrayBuffer,\n        Uint8ClampedArray: options.arrayBuffer,\n        Uint16Array: options.arrayBuffer,\n        Uint32Array: options.arrayBuffer,\n        Uint64Array: options.arrayBuffer,\n    };\n}\n/**\n * Create a custom copier based on the object-specific copy methods passed.\n */\nfunction createCopier(options) {\n    var normalizedOptions = assign({}, DEFAULT_LOOSE_OPTIONS, options);\n    var tagSpecificCopiers = getTagSpecificCopiers(normalizedOptions);\n    var array = tagSpecificCopiers.Array, object = tagSpecificCopiers.Object;\n    function copier(value, state) {\n        state.prototype = state.Constructor = undefined;\n        if (!value || typeof value !== 'object') {\n            return value;\n        }\n        if (state.cache.has(value)) {\n            return state.cache.get(value);\n        }\n        state.prototype = getPrototypeOf(value);\n        state.Constructor = state.prototype && state.prototype.constructor;\n        // plain objects\n        if (!state.Constructor || state.Constructor === Object) {\n            return object(value, state);\n        }\n        // arrays\n        if (isArray(value)) {\n            return array(value, state);\n        }\n        var tagSpecificCopier = tagSpecificCopiers[getTag(value)];\n        if (tagSpecificCopier) {\n            return tagSpecificCopier(value, state);\n        }\n        return typeof value.then === 'function' ? value : object(value, state);\n    }\n    return function copy(value) {\n        return copier(value, {\n            Constructor: undefined,\n            cache: createCache(),\n            copier: copier,\n            prototype: undefined,\n        });\n    };\n}\n/**\n * Create a custom copier based on the object-specific copy methods passed, defaulting to the\n * same internals as `copyStrict`.\n */\nfunction createStrictCopier(options) {\n    return createCopier(assign({}, DEFAULT_STRICT_OPTIONS, options));\n}\n/**\n * Copy an value deeply as much as possible, where strict recreation of object properties\n * are maintained. All properties (including non-enumerable ones) are copied with their\n * original property descriptors on both objects and arrays.\n */\nvar copyStrict = createStrictCopier({});\n/**\n * Copy an value deeply as much as possible.\n */\nvar index = createCopier({});\n\nexport { copyStrict, createCopier, createStrictCopier, index as default };\n//# sourceMappingURL=index.mjs.map\n","import type { AnyData } from '../types'\n\n/**\n * Defines all provided properties as non-enumerable, configurable, values\n */\nexport const defineValues = <M extends AnyData, D extends AnyData>(data: M, properties: D) => {\n  Object.keys(properties).forEach((key) => {\n    Object.defineProperty(data, key, {\n      enumerable: false,\n      configurable: true,\n      value: properties[key],\n    })\n  })\n  return data\n}\n\n/**\n * Defines all provided properties as non-enumerable, configurable, getters\n */\nexport const defineGetters = <M extends AnyData, D extends AnyData>(data: M, properties: D) => {\n  Object.keys(properties).forEach((key) => {\n    Object.defineProperty(data, key, {\n      enumerable: false,\n      configurable: true,\n      get: properties[key],\n    })\n  })\n  return data\n}\n\n/**\n * Defines all provided properties as non-enumerable, configurable, setters\n */\nexport const defineSetters = <M extends AnyData, D extends AnyData>(data: M, properties: D) => {\n  Object.keys(properties).forEach((key) => {\n    Object.defineProperty(data, key, {\n      enumerable: false,\n      configurable: true,\n      set: properties[key],\n    })\n  })\n  return data\n}\n","import type { FeathersService } from '@feathersjs/feathers'\nimport type { PiniaService } from '../create-pinia-service'\nimport type { AnyData, AnyDataOrArray } from '../types'\nimport { ServiceInstance } from '../modeling'\n\nexport function convertData(service: PiniaService<FeathersService>, result: AnyDataOrArray<AnyData>) {\n  if (!result) {\n    return result\n  } else if (Array.isArray(result)) {\n    return result.map((i) => service.new(i)) as ServiceInstance<AnyData>[]\n  } else if (result && Array.isArray(result.data)) {\n    result.data = result.data.map((i) => service.new(i)) as ServiceInstance<AnyData>[]\n    return result\n  } else {\n    return service.new(result) as ServiceInstance<AnyData>\n  }\n}\n","import type { MaybeRef } from '@vueuse/core'\nimport type { Ref } from 'vue-demi'\nimport { _ } from '@feathersjs/commons'\nimport { unref } from 'vue-demi'\nimport isEqual from 'fast-deep-equal'\nimport fastCopy from 'fast-copy'\nimport type { AnyData, AnyDataOrArray, DiffDefinition, Params, Query, QueryInfo } from '../types'\nimport { defineValues } from './define-properties'\nimport { convertData } from './convert-data'\n\ninterface GetExtendedQueryInfoOptions {\n  queryInfo: QueryInfo\n  service: any\n  store: any\n  qid: Ref<string>\n}\nexport function getExtendedQueryInfo({ queryInfo, service, store, qid }: GetExtendedQueryInfoOptions) {\n  const qidState: any = store.pagination[qid.value]\n  const queryState = qidState[queryInfo.queryId]\n  if (!queryState) return null\n\n  const { total } = queryState\n  const pageState = queryState[queryInfo.pageId as string]\n  if (!pageState) return null\n\n  const { ids, queriedAt, ssr } = pageState\n  const result = ids.map((id: any) => store.itemsById[id]).filter((i: any) => i)\n  const items = convertData(service, result)\n  const info = { ...queryInfo, ids, items, total, queriedAt, queryState, ssr }\n  return info || null\n}\n\nexport function hasOwn(obj: AnyData, prop: string) {\n  return Object.prototype.hasOwnProperty.call(obj, prop)\n}\n\n/**\n *\n * @param data item or array of items\n * @returns object with { items[], isArray } where isArray is a boolean of if the data was an array.\n */\nexport function getArray<T>(data: T | T[]) {\n  const isArray = Array.isArray(data)\n  return { items: isArray ? data : [data], isArray }\n}\n\nexport function pickDiff(obj: any, diffDef: DiffDefinition) {\n  // If no diff definition was given, return the entire object.\n  if (!diffDef) return obj\n\n  // Normalize all types into an array and pick the keys\n  const keys = typeof diffDef === 'string' ? [diffDef] : Array.isArray(diffDef) ? diffDef : Object.keys(diffDef || obj)\n  const topLevelKeys = keys.map((key) => key.toString().split('.')[0])\n  return _.pick(obj, ...topLevelKeys)\n}\n\nexport function diff(original: AnyData, clone: AnyData, diffDef: DiffDefinition) {\n  const originalVal = pickDiff(original, diffDef)\n  const cloneVal = pickDiff(clone, diffDef)\n\n  // If diff was an object, merge the values into the cloneVal\n  if (typeof diffDef !== 'string' && !Array.isArray(diffDef)) Object.assign(cloneVal, diffDef)\n\n  const areEqual = isEqual(originalVal, cloneVal)\n\n  if (areEqual) return {}\n\n  // Loop through clone, compare original value to clone value, if different add to diff object.\n  const diff = Object.keys(cloneVal).reduce((diff: AnyData, key) => {\n    if (!isEqual(original[key], cloneVal[key])) diff[key] = cloneVal[key]\n\n    return diff\n  }, {})\n\n  return diff\n}\n\n/**\n * Restores tempIds to the records returned from the server. The tempIds need to be\n * temporarily put back in place in order to migrate the objects from the tempsById\n * into the itemsById. A shallow copy of the object\n *\n * Note when data is an array, it doesn't matter if the server\n * returns the items in the same order. It's only important that all of the correct\n * records are moved from tempsById to itemsById\n *\n * @param data item(s) before being passed to the server\n * @param responseData items(s) returned from the server\n */\nexport function restoreTempIds(data: AnyDataOrArray<any>, resData: AnyDataOrArray<any>, tempIdField = '__tempId') {\n  const { items: sourceItems, isArray } = getArray(data)\n  const { items: responseItems } = getArray(resData)\n\n  responseItems.forEach((item: any, index: number) => {\n    const tempId = sourceItems[index][tempIdField]\n    if (tempId) defineValues(item, { [tempIdField]: tempId })\n  })\n\n  return isArray ? responseItems : responseItems[0]\n}\n\nfunction stringifyIfObject(val: any): string | any {\n  if (typeof val === 'object' && val != null) return val.toString()\n\n  return val\n}\n\n/**\n * Get the id from a record in this order:\n *   1. the `idField`\n *   2. id\n *   3. _id\n * @param item\n * @param idField\n */\nexport function getId(item: any, idField: string) {\n  if (!item) return\n  if (idField && item[idField] !== undefined) return stringifyIfObject(item[idField as string])\n\n  if (item.id !== undefined) return stringifyIfObject(item.id)\n\n  if (item._id !== undefined) return stringifyIfObject(item._id)\n}\n\n/**\n * Assures params exist.\n * @param params existing params\n */\nexport function getParams(params?: MaybeRef<Params<Query>>): Params<Query> {\n  if (!params) return {}\n\n  return fastCopy(unref(params))\n}\n\nexport function timeout(ms: number) {\n  return new Promise((resolve) => setTimeout(resolve, ms))\n}\n","import { ref } from 'vue-demi'\n\n/**\n * Use a counter to track the number of pending queries. Prevents collisions with overlapping queries.\n */\nexport const useCounter = () => {\n  const count = ref(0)\n  const add = () => {\n    count.value = count.value + 1\n  }\n  const sub = () => {\n    count.value = count.value === 0 ? 0 : count.value - 1\n  }\n  return { count, add, sub }\n}\n","import { MaybeRef } from '@vueuse/core'\nimport { unref, isRef } from 'vue-demi'\n\nconst isObject = (val: Record<string, any>) => val !== null && typeof val === 'object'\nconst isArray = Array.isArray\n\n/**\n * Deeply unref a value, recursing into objects and arrays.\n *\n * Adapted from https://github.com/DanHulton/vue-deepunref\n */\nexport function deepUnref(val: MaybeRef<Record<string, any>>) {\n  const checkedVal: any = isRef(val) ? unref(val) : val\n\n  if (!isObject(checkedVal)) {\n    return checkedVal\n  }\n\n  if (isArray(checkedVal)) {\n    return unrefArray(checkedVal)\n  }\n\n  return unrefObject(checkedVal)\n}\n\n// Unref a value, recursing into it if it's an object.\nconst smartUnref = (val: Record<string, any>) => {\n  // Non-ref object?  Go deeper!\n  if (val !== null && !isRef(val) && typeof val === 'object') {\n    return deepUnref(val)\n  }\n\n  return unref(val)\n}\n\n// Unref an array, recursively.\nconst unrefArray = (arr: any) => arr.map(smartUnref)\n\n// Unref an object, recursively.\nconst unrefObject = (obj: Record<string, any>) => {\n  const unreffed: Record<string, any> = {}\n\n  Object.keys(obj).forEach((key) => {\n    unreffed[key] = smartUnref(obj[key])\n  })\n\n  return unreffed\n}\n","import fastCopy from 'fast-copy'\nimport { AnyData } from '../types'\nimport { _ } from '@feathersjs/commons'\n\nexport const useInstanceDefaults = <D extends AnyData, M extends AnyData>(defaults: D, data: M) => {\n  const dataKeys = Object.keys(data)\n  const defaultsToApply = _.omit(defaults, ...dataKeys) as D\n  const cloned = Object.assign(data, fastCopy(defaultsToApply))\n\n  return cloned\n}\n","import { shallowRef, watchEffect, readonly, ref, watch, customRef, getCurrentScope, onScopeDispose, effectScope, provide, inject, isVue3, version, isRef, unref, computed, reactive, toRefs as toRefs$1, toRef as toRef$1, isVue2, set as set$1, getCurrentInstance, onBeforeMount, nextTick, onBeforeUnmount, onMounted, onUnmounted, isReactive } from 'vue-demi';\n\nvar __defProp$b = Object.defineProperty;\nvar __defProps$8 = Object.defineProperties;\nvar __getOwnPropDescs$8 = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols$d = Object.getOwnPropertySymbols;\nvar __hasOwnProp$d = Object.prototype.hasOwnProperty;\nvar __propIsEnum$d = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp$b = (obj, key, value) => key in obj ? __defProp$b(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues$b = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp$d.call(b, prop))\n      __defNormalProp$b(a, prop, b[prop]);\n  if (__getOwnPropSymbols$d)\n    for (var prop of __getOwnPropSymbols$d(b)) {\n      if (__propIsEnum$d.call(b, prop))\n        __defNormalProp$b(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps$8 = (a, b) => __defProps$8(a, __getOwnPropDescs$8(b));\nfunction computedEager(fn, options) {\n  var _a;\n  const result = shallowRef();\n  watchEffect(() => {\n    result.value = fn();\n  }, __spreadProps$8(__spreadValues$b({}, options), {\n    flush: (_a = options == null ? void 0 : options.flush) != null ? _a : \"sync\"\n  }));\n  return readonly(result);\n}\n\nfunction computedWithControl(source, fn) {\n  let v = void 0;\n  let track;\n  let trigger;\n  const dirty = ref(true);\n  const update = () => {\n    dirty.value = true;\n    trigger();\n  };\n  watch(source, update, { flush: \"sync\" });\n  const get = typeof fn === \"function\" ? fn : fn.get;\n  const set = typeof fn === \"function\" ? void 0 : fn.set;\n  const result = customRef((_track, _trigger) => {\n    track = _track;\n    trigger = _trigger;\n    return {\n      get() {\n        if (dirty.value) {\n          v = get();\n          dirty.value = false;\n        }\n        track();\n        return v;\n      },\n      set(v2) {\n        set == null ? void 0 : set(v2);\n      }\n    };\n  });\n  if (Object.isExtensible(result))\n    result.trigger = update;\n  return result;\n}\n\nfunction tryOnScopeDispose(fn) {\n  if (getCurrentScope()) {\n    onScopeDispose(fn);\n    return true;\n  }\n  return false;\n}\n\nfunction createEventHook() {\n  const fns = /* @__PURE__ */ new Set();\n  const off = (fn) => {\n    fns.delete(fn);\n  };\n  const on = (fn) => {\n    fns.add(fn);\n    const offFn = () => off(fn);\n    tryOnScopeDispose(offFn);\n    return {\n      off: offFn\n    };\n  };\n  const trigger = (param) => {\n    return Promise.all(Array.from(fns).map((fn) => fn(param)));\n  };\n  return {\n    on,\n    off,\n    trigger\n  };\n}\n\nfunction createGlobalState(stateFactory) {\n  let initialized = false;\n  let state;\n  const scope = effectScope(true);\n  return (...args) => {\n    if (!initialized) {\n      state = scope.run(() => stateFactory(...args));\n      initialized = true;\n    }\n    return state;\n  };\n}\n\nfunction createInjectionState(composable) {\n  const key = Symbol(\"InjectionState\");\n  const useProvidingState = (...args) => {\n    const state = composable(...args);\n    provide(key, state);\n    return state;\n  };\n  const useInjectedState = () => inject(key);\n  return [useProvidingState, useInjectedState];\n}\n\nfunction createSharedComposable(composable) {\n  let subscribers = 0;\n  let state;\n  let scope;\n  const dispose = () => {\n    subscribers -= 1;\n    if (scope && subscribers <= 0) {\n      scope.stop();\n      state = void 0;\n      scope = void 0;\n    }\n  };\n  return (...args) => {\n    subscribers += 1;\n    if (!state) {\n      scope = effectScope(true);\n      state = scope.run(() => composable(...args));\n    }\n    tryOnScopeDispose(dispose);\n    return state;\n  };\n}\n\nfunction extendRef(ref, extend, { enumerable = false, unwrap = true } = {}) {\n  if (!isVue3 && !version.startsWith(\"2.7.\")) {\n    if (process.env.NODE_ENV !== \"production\")\n      throw new Error(\"[VueUse] extendRef only works in Vue 2.7 or above.\");\n    return;\n  }\n  for (const [key, value] of Object.entries(extend)) {\n    if (key === \"value\")\n      continue;\n    if (isRef(value) && unwrap) {\n      Object.defineProperty(ref, key, {\n        get() {\n          return value.value;\n        },\n        set(v) {\n          value.value = v;\n        },\n        enumerable\n      });\n    } else {\n      Object.defineProperty(ref, key, { value, enumerable });\n    }\n  }\n  return ref;\n}\n\nfunction get(obj, key) {\n  if (key == null)\n    return unref(obj);\n  return unref(obj)[key];\n}\n\nfunction isDefined(v) {\n  return unref(v) != null;\n}\n\nvar __defProp$a = Object.defineProperty;\nvar __getOwnPropSymbols$c = Object.getOwnPropertySymbols;\nvar __hasOwnProp$c = Object.prototype.hasOwnProperty;\nvar __propIsEnum$c = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp$a = (obj, key, value) => key in obj ? __defProp$a(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues$a = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp$c.call(b, prop))\n      __defNormalProp$a(a, prop, b[prop]);\n  if (__getOwnPropSymbols$c)\n    for (var prop of __getOwnPropSymbols$c(b)) {\n      if (__propIsEnum$c.call(b, prop))\n        __defNormalProp$a(a, prop, b[prop]);\n    }\n  return a;\n};\nfunction makeDestructurable(obj, arr) {\n  if (typeof Symbol !== \"undefined\") {\n    const clone = __spreadValues$a({}, obj);\n    Object.defineProperty(clone, Symbol.iterator, {\n      enumerable: false,\n      value() {\n        let index = 0;\n        return {\n          next: () => ({\n            value: arr[index++],\n            done: index > arr.length\n          })\n        };\n      }\n    });\n    return clone;\n  } else {\n    return Object.assign([...arr], obj);\n  }\n}\n\nfunction toValue(r) {\n  return typeof r === \"function\" ? r() : unref(r);\n}\nconst resolveUnref = toValue;\n\nfunction reactify(fn, options) {\n  const unrefFn = (options == null ? void 0 : options.computedGetter) === false ? unref : toValue;\n  return function(...args) {\n    return computed(() => fn.apply(this, args.map((i) => unrefFn(i))));\n  };\n}\n\nfunction reactifyObject(obj, optionsOrKeys = {}) {\n  let keys = [];\n  let options;\n  if (Array.isArray(optionsOrKeys)) {\n    keys = optionsOrKeys;\n  } else {\n    options = optionsOrKeys;\n    const { includeOwnProperties = true } = optionsOrKeys;\n    keys.push(...Object.keys(obj));\n    if (includeOwnProperties)\n      keys.push(...Object.getOwnPropertyNames(obj));\n  }\n  return Object.fromEntries(\n    keys.map((key) => {\n      const value = obj[key];\n      return [\n        key,\n        typeof value === \"function\" ? reactify(value.bind(obj), options) : value\n      ];\n    })\n  );\n}\n\nfunction toReactive(objectRef) {\n  if (!isRef(objectRef))\n    return reactive(objectRef);\n  const proxy = new Proxy({}, {\n    get(_, p, receiver) {\n      return unref(Reflect.get(objectRef.value, p, receiver));\n    },\n    set(_, p, value) {\n      if (isRef(objectRef.value[p]) && !isRef(value))\n        objectRef.value[p].value = value;\n      else\n        objectRef.value[p] = value;\n      return true;\n    },\n    deleteProperty(_, p) {\n      return Reflect.deleteProperty(objectRef.value, p);\n    },\n    has(_, p) {\n      return Reflect.has(objectRef.value, p);\n    },\n    ownKeys() {\n      return Object.keys(objectRef.value);\n    },\n    getOwnPropertyDescriptor() {\n      return {\n        enumerable: true,\n        configurable: true\n      };\n    }\n  });\n  return reactive(proxy);\n}\n\nfunction reactiveComputed(fn) {\n  return toReactive(computed(fn));\n}\n\nfunction reactiveOmit(obj, ...keys) {\n  const flatKeys = keys.flat();\n  const predicate = flatKeys[0];\n  return reactiveComputed(\n    () => typeof predicate === \"function\" ? Object.fromEntries(Object.entries(toRefs$1(obj)).filter(([k, v]) => !predicate(toValue(v), k))) : Object.fromEntries(Object.entries(toRefs$1(obj)).filter((e) => !flatKeys.includes(e[0])))\n  );\n}\n\nconst isClient = typeof window !== \"undefined\";\nconst isDef = (val) => typeof val !== \"undefined\";\nconst notNullish = (val) => val != null;\nconst assert = (condition, ...infos) => {\n  if (!condition)\n    console.warn(...infos);\n};\nconst toString = Object.prototype.toString;\nconst isObject = (val) => toString.call(val) === \"[object Object]\";\nconst now = () => Date.now();\nconst timestamp = () => +Date.now();\nconst clamp = (n, min, max) => Math.min(max, Math.max(min, n));\nconst noop = () => {\n};\nconst rand = (min, max) => {\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n};\nconst hasOwn = (val, key) => Object.prototype.hasOwnProperty.call(val, key);\nconst isIOS = /* @__PURE__ */ getIsIOS();\nfunction getIsIOS() {\n  var _a;\n  return isClient && ((_a = window == null ? void 0 : window.navigator) == null ? void 0 : _a.userAgent) && /* @__PURE__ */ /iP(ad|hone|od)/.test(window.navigator.userAgent);\n}\n\nfunction createFilterWrapper(filter, fn) {\n  function wrapper(...args) {\n    return new Promise((resolve, reject) => {\n      Promise.resolve(filter(() => fn.apply(this, args), { fn, thisArg: this, args })).then(resolve).catch(reject);\n    });\n  }\n  return wrapper;\n}\nconst bypassFilter = (invoke) => {\n  return invoke();\n};\nfunction debounceFilter(ms, options = {}) {\n  let timer;\n  let maxTimer;\n  let lastRejector = noop;\n  const _clearTimeout = (timer2) => {\n    clearTimeout(timer2);\n    lastRejector();\n    lastRejector = noop;\n  };\n  const filter = (invoke) => {\n    const duration = toValue(ms);\n    const maxDuration = toValue(options.maxWait);\n    if (timer)\n      _clearTimeout(timer);\n    if (duration <= 0 || maxDuration !== void 0 && maxDuration <= 0) {\n      if (maxTimer) {\n        _clearTimeout(maxTimer);\n        maxTimer = null;\n      }\n      return Promise.resolve(invoke());\n    }\n    return new Promise((resolve, reject) => {\n      lastRejector = options.rejectOnCancel ? reject : resolve;\n      if (maxDuration && !maxTimer) {\n        maxTimer = setTimeout(() => {\n          if (timer)\n            _clearTimeout(timer);\n          maxTimer = null;\n          resolve(invoke());\n        }, maxDuration);\n      }\n      timer = setTimeout(() => {\n        if (maxTimer)\n          _clearTimeout(maxTimer);\n        maxTimer = null;\n        resolve(invoke());\n      }, duration);\n    });\n  };\n  return filter;\n}\nfunction throttleFilter(ms, trailing = true, leading = true, rejectOnCancel = false) {\n  let lastExec = 0;\n  let timer;\n  let isLeading = true;\n  let lastRejector = noop;\n  let lastValue;\n  const clear = () => {\n    if (timer) {\n      clearTimeout(timer);\n      timer = void 0;\n      lastRejector();\n      lastRejector = noop;\n    }\n  };\n  const filter = (_invoke) => {\n    const duration = toValue(ms);\n    const elapsed = Date.now() - lastExec;\n    const invoke = () => {\n      return lastValue = _invoke();\n    };\n    clear();\n    if (duration <= 0) {\n      lastExec = Date.now();\n      return invoke();\n    }\n    if (elapsed > duration && (leading || !isLeading)) {\n      lastExec = Date.now();\n      invoke();\n    } else if (trailing) {\n      lastValue = new Promise((resolve, reject) => {\n        lastRejector = rejectOnCancel ? reject : resolve;\n        timer = setTimeout(() => {\n          lastExec = Date.now();\n          isLeading = true;\n          resolve(invoke());\n          clear();\n        }, Math.max(0, duration - elapsed));\n      });\n    }\n    if (!leading && !timer)\n      timer = setTimeout(() => isLeading = true, duration);\n    isLeading = false;\n    return lastValue;\n  };\n  return filter;\n}\nfunction pausableFilter(extendFilter = bypassFilter) {\n  const isActive = ref(true);\n  function pause() {\n    isActive.value = false;\n  }\n  function resume() {\n    isActive.value = true;\n  }\n  const eventFilter = (...args) => {\n    if (isActive.value)\n      extendFilter(...args);\n  };\n  return { isActive: readonly(isActive), pause, resume, eventFilter };\n}\n\nconst directiveHooks = {\n  mounted: isVue3 ? \"mounted\" : \"inserted\",\n  updated: isVue3 ? \"updated\" : \"componentUpdated\",\n  unmounted: isVue3 ? \"unmounted\" : \"unbind\"\n};\n\nfunction promiseTimeout(ms, throwOnTimeout = false, reason = \"Timeout\") {\n  return new Promise((resolve, reject) => {\n    if (throwOnTimeout)\n      setTimeout(() => reject(reason), ms);\n    else\n      setTimeout(resolve, ms);\n  });\n}\nfunction identity(arg) {\n  return arg;\n}\nfunction createSingletonPromise(fn) {\n  let _promise;\n  function wrapper() {\n    if (!_promise)\n      _promise = fn();\n    return _promise;\n  }\n  wrapper.reset = async () => {\n    const _prev = _promise;\n    _promise = void 0;\n    if (_prev)\n      await _prev;\n  };\n  return wrapper;\n}\nfunction invoke(fn) {\n  return fn();\n}\nfunction containsProp(obj, ...props) {\n  return props.some((k) => k in obj);\n}\nfunction increaseWithUnit(target, delta) {\n  var _a;\n  if (typeof target === \"number\")\n    return target + delta;\n  const value = ((_a = target.match(/^-?[0-9]+\\.?[0-9]*/)) == null ? void 0 : _a[0]) || \"\";\n  const unit = target.slice(value.length);\n  const result = parseFloat(value) + delta;\n  if (Number.isNaN(result))\n    return target;\n  return result + unit;\n}\nfunction objectPick(obj, keys, omitUndefined = false) {\n  return keys.reduce((n, k) => {\n    if (k in obj) {\n      if (!omitUndefined || obj[k] !== void 0)\n        n[k] = obj[k];\n    }\n    return n;\n  }, {});\n}\nfunction objectOmit(obj, keys, omitUndefined = false) {\n  return Object.fromEntries(Object.entries(obj).filter(([key, value]) => {\n    return (!omitUndefined || value !== void 0) && !keys.includes(key);\n  }));\n}\nfunction objectEntries(obj) {\n  return Object.entries(obj);\n}\n\nfunction toRef(...args) {\n  if (args.length !== 1)\n    return toRef$1(...args);\n  const r = args[0];\n  return typeof r === \"function\" ? readonly(customRef(() => ({ get: r, set: noop }))) : ref(r);\n}\nconst resolveRef = toRef;\n\nfunction reactivePick(obj, ...keys) {\n  const flatKeys = keys.flat();\n  const predicate = flatKeys[0];\n  return reactiveComputed(() => typeof predicate === \"function\" ? Object.fromEntries(Object.entries(toRefs$1(obj)).filter(([k, v]) => predicate(toValue(v), k))) : Object.fromEntries(flatKeys.map((k) => [k, toRef(obj, k)])));\n}\n\nfunction refAutoReset(defaultValue, afterMs = 1e4) {\n  return customRef((track, trigger) => {\n    let value = defaultValue;\n    let timer;\n    const resetAfter = () => setTimeout(() => {\n      value = defaultValue;\n      trigger();\n    }, toValue(afterMs));\n    tryOnScopeDispose(() => {\n      clearTimeout(timer);\n    });\n    return {\n      get() {\n        track();\n        return value;\n      },\n      set(newValue) {\n        value = newValue;\n        trigger();\n        clearTimeout(timer);\n        timer = resetAfter();\n      }\n    };\n  });\n}\n\nfunction useDebounceFn(fn, ms = 200, options = {}) {\n  return createFilterWrapper(\n    debounceFilter(ms, options),\n    fn\n  );\n}\n\nfunction refDebounced(value, ms = 200, options = {}) {\n  const debounced = ref(value.value);\n  const updater = useDebounceFn(() => {\n    debounced.value = value.value;\n  }, ms, options);\n  watch(value, () => updater());\n  return debounced;\n}\n\nfunction refDefault(source, defaultValue) {\n  return computed({\n    get() {\n      var _a;\n      return (_a = source.value) != null ? _a : defaultValue;\n    },\n    set(value) {\n      source.value = value;\n    }\n  });\n}\n\nfunction useThrottleFn(fn, ms = 200, trailing = false, leading = true, rejectOnCancel = false) {\n  return createFilterWrapper(\n    throttleFilter(ms, trailing, leading, rejectOnCancel),\n    fn\n  );\n}\n\nfunction refThrottled(value, delay = 200, trailing = true, leading = true) {\n  if (delay <= 0)\n    return value;\n  const throttled = ref(value.value);\n  const updater = useThrottleFn(() => {\n    throttled.value = value.value;\n  }, delay, trailing, leading);\n  watch(value, () => updater());\n  return throttled;\n}\n\nfunction refWithControl(initial, options = {}) {\n  let source = initial;\n  let track;\n  let trigger;\n  const ref = customRef((_track, _trigger) => {\n    track = _track;\n    trigger = _trigger;\n    return {\n      get() {\n        return get();\n      },\n      set(v) {\n        set(v);\n      }\n    };\n  });\n  function get(tracking = true) {\n    if (tracking)\n      track();\n    return source;\n  }\n  function set(value, triggering = true) {\n    var _a, _b;\n    if (value === source)\n      return;\n    const old = source;\n    if (((_a = options.onBeforeChange) == null ? void 0 : _a.call(options, value, old)) === false)\n      return;\n    source = value;\n    (_b = options.onChanged) == null ? void 0 : _b.call(options, value, old);\n    if (triggering)\n      trigger();\n  }\n  const untrackedGet = () => get(false);\n  const silentSet = (v) => set(v, false);\n  const peek = () => get(false);\n  const lay = (v) => set(v, false);\n  return extendRef(\n    ref,\n    {\n      get,\n      set,\n      untrackedGet,\n      silentSet,\n      peek,\n      lay\n    },\n    { enumerable: true }\n  );\n}\nconst controlledRef = refWithControl;\n\nfunction set(...args) {\n  if (args.length === 2) {\n    const [ref, value] = args;\n    ref.value = value;\n  }\n  if (args.length === 3) {\n    if (isVue2) {\n      set$1(...args);\n    } else {\n      const [target, key, value] = args;\n      target[key] = value;\n    }\n  }\n}\n\nfunction syncRef(left, right, options = {}) {\n  var _a, _b;\n  const {\n    flush = \"sync\",\n    deep = false,\n    immediate = true,\n    direction = \"both\",\n    transform = {}\n  } = options;\n  let watchLeft;\n  let watchRight;\n  const transformLTR = (_a = transform.ltr) != null ? _a : (v) => v;\n  const transformRTL = (_b = transform.rtl) != null ? _b : (v) => v;\n  if (direction === \"both\" || direction === \"ltr\") {\n    watchLeft = watch(\n      left,\n      (newValue) => right.value = transformLTR(newValue),\n      { flush, deep, immediate }\n    );\n  }\n  if (direction === \"both\" || direction === \"rtl\") {\n    watchRight = watch(\n      right,\n      (newValue) => left.value = transformRTL(newValue),\n      { flush, deep, immediate }\n    );\n  }\n  return () => {\n    watchLeft == null ? void 0 : watchLeft();\n    watchRight == null ? void 0 : watchRight();\n  };\n}\n\nfunction syncRefs(source, targets, options = {}) {\n  const {\n    flush = \"sync\",\n    deep = false,\n    immediate = true\n  } = options;\n  if (!Array.isArray(targets))\n    targets = [targets];\n  return watch(\n    source,\n    (newValue) => targets.forEach((target) => target.value = newValue),\n    { flush, deep, immediate }\n  );\n}\n\nvar __defProp$9 = Object.defineProperty;\nvar __defProps$7 = Object.defineProperties;\nvar __getOwnPropDescs$7 = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols$b = Object.getOwnPropertySymbols;\nvar __hasOwnProp$b = Object.prototype.hasOwnProperty;\nvar __propIsEnum$b = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp$9 = (obj, key, value) => key in obj ? __defProp$9(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues$9 = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp$b.call(b, prop))\n      __defNormalProp$9(a, prop, b[prop]);\n  if (__getOwnPropSymbols$b)\n    for (var prop of __getOwnPropSymbols$b(b)) {\n      if (__propIsEnum$b.call(b, prop))\n        __defNormalProp$9(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps$7 = (a, b) => __defProps$7(a, __getOwnPropDescs$7(b));\nfunction toRefs(objectRef) {\n  if (!isRef(objectRef))\n    return toRefs$1(objectRef);\n  const result = Array.isArray(objectRef.value) ? new Array(objectRef.value.length) : {};\n  for (const key in objectRef.value) {\n    result[key] = customRef(() => ({\n      get() {\n        return objectRef.value[key];\n      },\n      set(v) {\n        if (Array.isArray(objectRef.value)) {\n          const copy = [...objectRef.value];\n          copy[key] = v;\n          objectRef.value = copy;\n        } else {\n          const newObject = __spreadProps$7(__spreadValues$9({}, objectRef.value), { [key]: v });\n          Object.setPrototypeOf(newObject, objectRef.value);\n          objectRef.value = newObject;\n        }\n      }\n    }));\n  }\n  return result;\n}\n\nfunction tryOnBeforeMount(fn, sync = true) {\n  if (getCurrentInstance())\n    onBeforeMount(fn);\n  else if (sync)\n    fn();\n  else\n    nextTick(fn);\n}\n\nfunction tryOnBeforeUnmount(fn) {\n  if (getCurrentInstance())\n    onBeforeUnmount(fn);\n}\n\nfunction tryOnMounted(fn, sync = true) {\n  if (getCurrentInstance())\n    onMounted(fn);\n  else if (sync)\n    fn();\n  else\n    nextTick(fn);\n}\n\nfunction tryOnUnmounted(fn) {\n  if (getCurrentInstance())\n    onUnmounted(fn);\n}\n\nfunction createUntil(r, isNot = false) {\n  function toMatch(condition, { flush = \"sync\", deep = false, timeout, throwOnTimeout } = {}) {\n    let stop = null;\n    const watcher = new Promise((resolve) => {\n      stop = watch(\n        r,\n        (v) => {\n          if (condition(v) !== isNot) {\n            stop == null ? void 0 : stop();\n            resolve(v);\n          }\n        },\n        {\n          flush,\n          deep,\n          immediate: true\n        }\n      );\n    });\n    const promises = [watcher];\n    if (timeout != null) {\n      promises.push(\n        promiseTimeout(timeout, throwOnTimeout).then(() => toValue(r)).finally(() => stop == null ? void 0 : stop())\n      );\n    }\n    return Promise.race(promises);\n  }\n  function toBe(value, options) {\n    if (!isRef(value))\n      return toMatch((v) => v === value, options);\n    const { flush = \"sync\", deep = false, timeout, throwOnTimeout } = options != null ? options : {};\n    let stop = null;\n    const watcher = new Promise((resolve) => {\n      stop = watch(\n        [r, value],\n        ([v1, v2]) => {\n          if (isNot !== (v1 === v2)) {\n            stop == null ? void 0 : stop();\n            resolve(v1);\n          }\n        },\n        {\n          flush,\n          deep,\n          immediate: true\n        }\n      );\n    });\n    const promises = [watcher];\n    if (timeout != null) {\n      promises.push(\n        promiseTimeout(timeout, throwOnTimeout).then(() => toValue(r)).finally(() => {\n          stop == null ? void 0 : stop();\n          return toValue(r);\n        })\n      );\n    }\n    return Promise.race(promises);\n  }\n  function toBeTruthy(options) {\n    return toMatch((v) => Boolean(v), options);\n  }\n  function toBeNull(options) {\n    return toBe(null, options);\n  }\n  function toBeUndefined(options) {\n    return toBe(void 0, options);\n  }\n  function toBeNaN(options) {\n    return toMatch(Number.isNaN, options);\n  }\n  function toContains(value, options) {\n    return toMatch((v) => {\n      const array = Array.from(v);\n      return array.includes(value) || array.includes(toValue(value));\n    }, options);\n  }\n  function changed(options) {\n    return changedTimes(1, options);\n  }\n  function changedTimes(n = 1, options) {\n    let count = -1;\n    return toMatch(() => {\n      count += 1;\n      return count >= n;\n    }, options);\n  }\n  if (Array.isArray(toValue(r))) {\n    const instance = {\n      toMatch,\n      toContains,\n      changed,\n      changedTimes,\n      get not() {\n        return createUntil(r, !isNot);\n      }\n    };\n    return instance;\n  } else {\n    const instance = {\n      toMatch,\n      toBe,\n      toBeTruthy,\n      toBeNull,\n      toBeNaN,\n      toBeUndefined,\n      changed,\n      changedTimes,\n      get not() {\n        return createUntil(r, !isNot);\n      }\n    };\n    return instance;\n  }\n}\nfunction until(r) {\n  return createUntil(r);\n}\n\nfunction defaultComparator(value, othVal) {\n  return value === othVal;\n}\nfunction useArrayDifference(...args) {\n  var _a;\n  const list = args[0];\n  const values = args[1];\n  let compareFn = (_a = args[2]) != null ? _a : defaultComparator;\n  if (typeof compareFn === \"string\") {\n    const key = compareFn;\n    compareFn = (value, othVal) => value[key] === othVal[key];\n  }\n  return computed(() => toValue(list).filter((x) => toValue(values).findIndex((y) => compareFn(x, y)) === -1));\n}\n\nfunction useArrayEvery(list, fn) {\n  return computed(() => toValue(list).every((element, index, array) => fn(toValue(element), index, array)));\n}\n\nfunction useArrayFilter(list, fn) {\n  return computed(() => toValue(list).map((i) => toValue(i)).filter(fn));\n}\n\nfunction useArrayFind(list, fn) {\n  return computed(\n    () => toValue(\n      toValue(list).find((element, index, array) => fn(toValue(element), index, array))\n    )\n  );\n}\n\nfunction useArrayFindIndex(list, fn) {\n  return computed(() => toValue(list).findIndex((element, index, array) => fn(toValue(element), index, array)));\n}\n\nfunction findLast(arr, cb) {\n  let index = arr.length;\n  while (index-- > 0) {\n    if (cb(arr[index], index, arr))\n      return arr[index];\n  }\n  return void 0;\n}\nfunction useArrayFindLast(list, fn) {\n  return computed(\n    () => toValue(\n      !Array.prototype.findLast ? findLast(toValue(list), (element, index, array) => fn(toValue(element), index, array)) : toValue(list).findLast((element, index, array) => fn(toValue(element), index, array))\n    )\n  );\n}\n\nfunction isArrayIncludesOptions(obj) {\n  return isObject(obj) && containsProp(obj, \"formIndex\", \"comparator\");\n}\nfunction useArrayIncludes(...args) {\n  var _a;\n  const list = args[0];\n  const value = args[1];\n  let comparator = args[2];\n  let formIndex = 0;\n  if (isArrayIncludesOptions(comparator)) {\n    formIndex = (_a = comparator.fromIndex) != null ? _a : 0;\n    comparator = comparator.comparator;\n  }\n  if (typeof comparator === \"string\") {\n    const key = comparator;\n    comparator = (element, value2) => element[key] === toValue(value2);\n  }\n  comparator = comparator != null ? comparator : (element, value2) => element === toValue(value2);\n  return computed(\n    () => toValue(list).slice(formIndex).some(\n      (element, index, array) => comparator(toValue(element), toValue(value), index, toValue(array))\n    )\n  );\n}\n\nfunction useArrayJoin(list, separator) {\n  return computed(() => toValue(list).map((i) => toValue(i)).join(toValue(separator)));\n}\n\nfunction useArrayMap(list, fn) {\n  return computed(() => toValue(list).map((i) => toValue(i)).map(fn));\n}\n\nfunction useArrayReduce(list, reducer, ...args) {\n  const reduceCallback = (sum, value, index) => reducer(toValue(sum), toValue(value), index);\n  return computed(() => {\n    const resolved = toValue(list);\n    return args.length ? resolved.reduce(reduceCallback, toValue(args[0])) : resolved.reduce(reduceCallback);\n  });\n}\n\nfunction useArraySome(list, fn) {\n  return computed(() => toValue(list).some((element, index, array) => fn(toValue(element), index, array)));\n}\n\nfunction uniq(array) {\n  return Array.from(new Set(array));\n}\nfunction uniqueElementsBy(array, fn) {\n  return array.reduce((acc, v) => {\n    if (!acc.some((x) => fn(v, x, array)))\n      acc.push(v);\n    return acc;\n  }, []);\n}\nfunction useArrayUnique(list, compareFn) {\n  return computed(() => {\n    const resolvedList = toValue(list).map((element) => toValue(element));\n    return compareFn ? uniqueElementsBy(resolvedList, compareFn) : uniq(resolvedList);\n  });\n}\n\nfunction useCounter(initialValue = 0, options = {}) {\n  const count = ref(initialValue);\n  const {\n    max = Infinity,\n    min = -Infinity\n  } = options;\n  const inc = (delta = 1) => count.value = Math.min(max, count.value + delta);\n  const dec = (delta = 1) => count.value = Math.max(min, count.value - delta);\n  const get = () => count.value;\n  const set = (val) => count.value = Math.max(min, Math.min(max, val));\n  const reset = (val = initialValue) => {\n    initialValue = val;\n    return set(val);\n  };\n  return { count, inc, dec, get, set, reset };\n}\n\nconst REGEX_PARSE = /^(\\d{4})[-/]?(\\d{1,2})?[-/]?(\\d{0,2})[Tt\\s]*(\\d{1,2})?:?(\\d{1,2})?:?(\\d{1,2})?[.:]?(\\d+)?$/;\nconst REGEX_FORMAT = /\\[([^\\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a{1,2}|A{1,2}|m{1,2}|s{1,2}|Z{1,2}|SSS/g;\nfunction defaultMeridiem(hours, minutes, isLowercase, hasPeriod) {\n  let m = hours < 12 ? \"AM\" : \"PM\";\n  if (hasPeriod)\n    m = m.split(\"\").reduce((acc, curr) => acc += `${curr}.`, \"\");\n  return isLowercase ? m.toLowerCase() : m;\n}\nfunction formatDate(date, formatStr, options = {}) {\n  var _a;\n  const years = date.getFullYear();\n  const month = date.getMonth();\n  const days = date.getDate();\n  const hours = date.getHours();\n  const minutes = date.getMinutes();\n  const seconds = date.getSeconds();\n  const milliseconds = date.getMilliseconds();\n  const day = date.getDay();\n  const meridiem = (_a = options.customMeridiem) != null ? _a : defaultMeridiem;\n  const matches = {\n    YY: () => String(years).slice(-2),\n    YYYY: () => years,\n    M: () => month + 1,\n    MM: () => `${month + 1}`.padStart(2, \"0\"),\n    MMM: () => date.toLocaleDateString(options.locales, { month: \"short\" }),\n    MMMM: () => date.toLocaleDateString(options.locales, { month: \"long\" }),\n    D: () => String(days),\n    DD: () => `${days}`.padStart(2, \"0\"),\n    H: () => String(hours),\n    HH: () => `${hours}`.padStart(2, \"0\"),\n    h: () => `${hours % 12 || 12}`.padStart(1, \"0\"),\n    hh: () => `${hours % 12 || 12}`.padStart(2, \"0\"),\n    m: () => String(minutes),\n    mm: () => `${minutes}`.padStart(2, \"0\"),\n    s: () => String(seconds),\n    ss: () => `${seconds}`.padStart(2, \"0\"),\n    SSS: () => `${milliseconds}`.padStart(3, \"0\"),\n    d: () => day,\n    dd: () => date.toLocaleDateString(options.locales, { weekday: \"narrow\" }),\n    ddd: () => date.toLocaleDateString(options.locales, { weekday: \"short\" }),\n    dddd: () => date.toLocaleDateString(options.locales, { weekday: \"long\" }),\n    A: () => meridiem(hours, minutes),\n    AA: () => meridiem(hours, minutes, false, true),\n    a: () => meridiem(hours, minutes, true),\n    aa: () => meridiem(hours, minutes, true, true)\n  };\n  return formatStr.replace(REGEX_FORMAT, (match, $1) => $1 || matches[match]());\n}\nfunction normalizeDate(date) {\n  if (date === null)\n    return /* @__PURE__ */ new Date(NaN);\n  if (date === void 0)\n    return /* @__PURE__ */ new Date();\n  if (date instanceof Date)\n    return new Date(date);\n  if (typeof date === \"string\" && !/Z$/i.test(date)) {\n    const d = date.match(REGEX_PARSE);\n    if (d) {\n      const m = d[2] - 1 || 0;\n      const ms = (d[7] || \"0\").substring(0, 3);\n      return new Date(d[1], m, d[3] || 1, d[4] || 0, d[5] || 0, d[6] || 0, ms);\n    }\n  }\n  return new Date(date);\n}\nfunction useDateFormat(date, formatStr = \"HH:mm:ss\", options = {}) {\n  return computed(() => formatDate(normalizeDate(toValue(date)), toValue(formatStr), options));\n}\n\nfunction useIntervalFn(cb, interval = 1e3, options = {}) {\n  const {\n    immediate = true,\n    immediateCallback = false\n  } = options;\n  let timer = null;\n  const isActive = ref(false);\n  function clean() {\n    if (timer) {\n      clearInterval(timer);\n      timer = null;\n    }\n  }\n  function pause() {\n    isActive.value = false;\n    clean();\n  }\n  function resume() {\n    const intervalValue = toValue(interval);\n    if (intervalValue <= 0)\n      return;\n    isActive.value = true;\n    if (immediateCallback)\n      cb();\n    clean();\n    timer = setInterval(cb, intervalValue);\n  }\n  if (immediate && isClient)\n    resume();\n  if (isRef(interval) || typeof interval === \"function\") {\n    const stopWatch = watch(interval, () => {\n      if (isActive.value && isClient)\n        resume();\n    });\n    tryOnScopeDispose(stopWatch);\n  }\n  tryOnScopeDispose(pause);\n  return {\n    isActive,\n    pause,\n    resume\n  };\n}\n\nvar __defProp$8 = Object.defineProperty;\nvar __getOwnPropSymbols$a = Object.getOwnPropertySymbols;\nvar __hasOwnProp$a = Object.prototype.hasOwnProperty;\nvar __propIsEnum$a = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp$8 = (obj, key, value) => key in obj ? __defProp$8(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues$8 = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp$a.call(b, prop))\n      __defNormalProp$8(a, prop, b[prop]);\n  if (__getOwnPropSymbols$a)\n    for (var prop of __getOwnPropSymbols$a(b)) {\n      if (__propIsEnum$a.call(b, prop))\n        __defNormalProp$8(a, prop, b[prop]);\n    }\n  return a;\n};\nfunction useInterval(interval = 1e3, options = {}) {\n  const {\n    controls: exposeControls = false,\n    immediate = true,\n    callback\n  } = options;\n  const counter = ref(0);\n  const update = () => counter.value += 1;\n  const reset = () => {\n    counter.value = 0;\n  };\n  const controls = useIntervalFn(\n    callback ? () => {\n      update();\n      callback(counter.value);\n    } : update,\n    interval,\n    { immediate }\n  );\n  if (exposeControls) {\n    return __spreadValues$8({\n      counter,\n      reset\n    }, controls);\n  } else {\n    return counter;\n  }\n}\n\nfunction useLastChanged(source, options = {}) {\n  var _a;\n  const ms = ref((_a = options.initialValue) != null ? _a : null);\n  watch(\n    source,\n    () => ms.value = timestamp(),\n    options\n  );\n  return ms;\n}\n\nfunction useTimeoutFn(cb, interval, options = {}) {\n  const {\n    immediate = true\n  } = options;\n  const isPending = ref(false);\n  let timer = null;\n  function clear() {\n    if (timer) {\n      clearTimeout(timer);\n      timer = null;\n    }\n  }\n  function stop() {\n    isPending.value = false;\n    clear();\n  }\n  function start(...args) {\n    clear();\n    isPending.value = true;\n    timer = setTimeout(() => {\n      isPending.value = false;\n      timer = null;\n      cb(...args);\n    }, toValue(interval));\n  }\n  if (immediate) {\n    isPending.value = true;\n    if (isClient)\n      start();\n  }\n  tryOnScopeDispose(stop);\n  return {\n    isPending: readonly(isPending),\n    start,\n    stop\n  };\n}\n\nvar __defProp$7 = Object.defineProperty;\nvar __getOwnPropSymbols$9 = Object.getOwnPropertySymbols;\nvar __hasOwnProp$9 = Object.prototype.hasOwnProperty;\nvar __propIsEnum$9 = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp$7 = (obj, key, value) => key in obj ? __defProp$7(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues$7 = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp$9.call(b, prop))\n      __defNormalProp$7(a, prop, b[prop]);\n  if (__getOwnPropSymbols$9)\n    for (var prop of __getOwnPropSymbols$9(b)) {\n      if (__propIsEnum$9.call(b, prop))\n        __defNormalProp$7(a, prop, b[prop]);\n    }\n  return a;\n};\nfunction useTimeout(interval = 1e3, options = {}) {\n  const {\n    controls: exposeControls = false,\n    callback\n  } = options;\n  const controls = useTimeoutFn(\n    callback != null ? callback : noop,\n    interval,\n    options\n  );\n  const ready = computed(() => !controls.isPending.value);\n  if (exposeControls) {\n    return __spreadValues$7({\n      ready\n    }, controls);\n  } else {\n    return ready;\n  }\n}\n\nfunction useToNumber(value, options = {}) {\n  const {\n    method = \"parseFloat\",\n    radix,\n    nanToZero\n  } = options;\n  return computed(() => {\n    let resolved = toValue(value);\n    if (typeof resolved === \"string\")\n      resolved = Number[method](resolved, radix);\n    if (nanToZero && isNaN(resolved))\n      resolved = 0;\n    return resolved;\n  });\n}\n\nfunction useToString(value) {\n  return computed(() => `${toValue(value)}`);\n}\n\nfunction useToggle(initialValue = false, options = {}) {\n  const {\n    truthyValue = true,\n    falsyValue = false\n  } = options;\n  const valueIsRef = isRef(initialValue);\n  const _value = ref(initialValue);\n  function toggle(value) {\n    if (arguments.length) {\n      _value.value = value;\n      return _value.value;\n    } else {\n      const truthy = toValue(truthyValue);\n      _value.value = _value.value === truthy ? toValue(falsyValue) : truthy;\n      return _value.value;\n    }\n  }\n  if (valueIsRef)\n    return toggle;\n  else\n    return [_value, toggle];\n}\n\nfunction watchArray(source, cb, options) {\n  let oldList = (options == null ? void 0 : options.immediate) ? [] : [\n    ...source instanceof Function ? source() : Array.isArray(source) ? source : toValue(source)\n  ];\n  return watch(source, (newList, _, onCleanup) => {\n    const oldListRemains = new Array(oldList.length);\n    const added = [];\n    for (const obj of newList) {\n      let found = false;\n      for (let i = 0; i < oldList.length; i++) {\n        if (!oldListRemains[i] && obj === oldList[i]) {\n          oldListRemains[i] = true;\n          found = true;\n          break;\n        }\n      }\n      if (!found)\n        added.push(obj);\n    }\n    const removed = oldList.filter((_2, i) => !oldListRemains[i]);\n    cb(newList, oldList, added, removed, onCleanup);\n    oldList = [...newList];\n  }, options);\n}\n\nvar __getOwnPropSymbols$8 = Object.getOwnPropertySymbols;\nvar __hasOwnProp$8 = Object.prototype.hasOwnProperty;\nvar __propIsEnum$8 = Object.prototype.propertyIsEnumerable;\nvar __objRest$5 = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp$8.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols$8)\n    for (var prop of __getOwnPropSymbols$8(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum$8.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nfunction watchWithFilter(source, cb, options = {}) {\n  const _a = options, {\n    eventFilter = bypassFilter\n  } = _a, watchOptions = __objRest$5(_a, [\n    \"eventFilter\"\n  ]);\n  return watch(\n    source,\n    createFilterWrapper(\n      eventFilter,\n      cb\n    ),\n    watchOptions\n  );\n}\n\nvar __getOwnPropSymbols$7 = Object.getOwnPropertySymbols;\nvar __hasOwnProp$7 = Object.prototype.hasOwnProperty;\nvar __propIsEnum$7 = Object.prototype.propertyIsEnumerable;\nvar __objRest$4 = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp$7.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols$7)\n    for (var prop of __getOwnPropSymbols$7(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum$7.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nfunction watchAtMost(source, cb, options) {\n  const _a = options, {\n    count\n  } = _a, watchOptions = __objRest$4(_a, [\n    \"count\"\n  ]);\n  const current = ref(0);\n  const stop = watchWithFilter(\n    source,\n    (...args) => {\n      current.value += 1;\n      if (current.value >= toValue(count))\n        nextTick(() => stop());\n      cb(...args);\n    },\n    watchOptions\n  );\n  return { count: current, stop };\n}\n\nvar __defProp$6 = Object.defineProperty;\nvar __defProps$6 = Object.defineProperties;\nvar __getOwnPropDescs$6 = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols$6 = Object.getOwnPropertySymbols;\nvar __hasOwnProp$6 = Object.prototype.hasOwnProperty;\nvar __propIsEnum$6 = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp$6 = (obj, key, value) => key in obj ? __defProp$6(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues$6 = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp$6.call(b, prop))\n      __defNormalProp$6(a, prop, b[prop]);\n  if (__getOwnPropSymbols$6)\n    for (var prop of __getOwnPropSymbols$6(b)) {\n      if (__propIsEnum$6.call(b, prop))\n        __defNormalProp$6(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps$6 = (a, b) => __defProps$6(a, __getOwnPropDescs$6(b));\nvar __objRest$3 = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp$6.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols$6)\n    for (var prop of __getOwnPropSymbols$6(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum$6.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nfunction watchDebounced(source, cb, options = {}) {\n  const _a = options, {\n    debounce = 0,\n    maxWait = void 0\n  } = _a, watchOptions = __objRest$3(_a, [\n    \"debounce\",\n    \"maxWait\"\n  ]);\n  return watchWithFilter(\n    source,\n    cb,\n    __spreadProps$6(__spreadValues$6({}, watchOptions), {\n      eventFilter: debounceFilter(debounce, { maxWait })\n    })\n  );\n}\n\nvar __defProp$5 = Object.defineProperty;\nvar __defProps$5 = Object.defineProperties;\nvar __getOwnPropDescs$5 = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols$5 = Object.getOwnPropertySymbols;\nvar __hasOwnProp$5 = Object.prototype.hasOwnProperty;\nvar __propIsEnum$5 = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp$5 = (obj, key, value) => key in obj ? __defProp$5(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues$5 = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp$5.call(b, prop))\n      __defNormalProp$5(a, prop, b[prop]);\n  if (__getOwnPropSymbols$5)\n    for (var prop of __getOwnPropSymbols$5(b)) {\n      if (__propIsEnum$5.call(b, prop))\n        __defNormalProp$5(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps$5 = (a, b) => __defProps$5(a, __getOwnPropDescs$5(b));\nfunction watchDeep(source, cb, options) {\n  return watch(\n    source,\n    cb,\n    __spreadProps$5(__spreadValues$5({}, options), {\n      deep: true\n    })\n  );\n}\n\nvar __defProp$4 = Object.defineProperty;\nvar __defProps$4 = Object.defineProperties;\nvar __getOwnPropDescs$4 = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols$4 = Object.getOwnPropertySymbols;\nvar __hasOwnProp$4 = Object.prototype.hasOwnProperty;\nvar __propIsEnum$4 = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp$4 = (obj, key, value) => key in obj ? __defProp$4(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues$4 = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp$4.call(b, prop))\n      __defNormalProp$4(a, prop, b[prop]);\n  if (__getOwnPropSymbols$4)\n    for (var prop of __getOwnPropSymbols$4(b)) {\n      if (__propIsEnum$4.call(b, prop))\n        __defNormalProp$4(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps$4 = (a, b) => __defProps$4(a, __getOwnPropDescs$4(b));\nvar __objRest$2 = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp$4.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols$4)\n    for (var prop of __getOwnPropSymbols$4(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum$4.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nfunction watchIgnorable(source, cb, options = {}) {\n  const _a = options, {\n    eventFilter = bypassFilter\n  } = _a, watchOptions = __objRest$2(_a, [\n    \"eventFilter\"\n  ]);\n  const filteredCb = createFilterWrapper(\n    eventFilter,\n    cb\n  );\n  let ignoreUpdates;\n  let ignorePrevAsyncUpdates;\n  let stop;\n  if (watchOptions.flush === \"sync\") {\n    const ignore = ref(false);\n    ignorePrevAsyncUpdates = () => {\n    };\n    ignoreUpdates = (updater) => {\n      ignore.value = true;\n      updater();\n      ignore.value = false;\n    };\n    stop = watch(\n      source,\n      (...args) => {\n        if (!ignore.value)\n          filteredCb(...args);\n      },\n      watchOptions\n    );\n  } else {\n    const disposables = [];\n    const ignoreCounter = ref(0);\n    const syncCounter = ref(0);\n    ignorePrevAsyncUpdates = () => {\n      ignoreCounter.value = syncCounter.value;\n    };\n    disposables.push(\n      watch(\n        source,\n        () => {\n          syncCounter.value++;\n        },\n        __spreadProps$4(__spreadValues$4({}, watchOptions), { flush: \"sync\" })\n      )\n    );\n    ignoreUpdates = (updater) => {\n      const syncCounterPrev = syncCounter.value;\n      updater();\n      ignoreCounter.value += syncCounter.value - syncCounterPrev;\n    };\n    disposables.push(\n      watch(\n        source,\n        (...args) => {\n          const ignore = ignoreCounter.value > 0 && ignoreCounter.value === syncCounter.value;\n          ignoreCounter.value = 0;\n          syncCounter.value = 0;\n          if (ignore)\n            return;\n          filteredCb(...args);\n        },\n        watchOptions\n      )\n    );\n    stop = () => {\n      disposables.forEach((fn) => fn());\n    };\n  }\n  return { stop, ignoreUpdates, ignorePrevAsyncUpdates };\n}\n\nvar __defProp$3 = Object.defineProperty;\nvar __defProps$3 = Object.defineProperties;\nvar __getOwnPropDescs$3 = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols$3 = Object.getOwnPropertySymbols;\nvar __hasOwnProp$3 = Object.prototype.hasOwnProperty;\nvar __propIsEnum$3 = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp$3 = (obj, key, value) => key in obj ? __defProp$3(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues$3 = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp$3.call(b, prop))\n      __defNormalProp$3(a, prop, b[prop]);\n  if (__getOwnPropSymbols$3)\n    for (var prop of __getOwnPropSymbols$3(b)) {\n      if (__propIsEnum$3.call(b, prop))\n        __defNormalProp$3(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps$3 = (a, b) => __defProps$3(a, __getOwnPropDescs$3(b));\nfunction watchImmediate(source, cb, options) {\n  return watch(\n    source,\n    cb,\n    __spreadProps$3(__spreadValues$3({}, options), {\n      immediate: true\n    })\n  );\n}\n\nfunction watchOnce(source, cb, options) {\n  const stop = watch(source, (...args) => {\n    nextTick(() => stop());\n    return cb(...args);\n  }, options);\n}\n\nvar __defProp$2 = Object.defineProperty;\nvar __defProps$2 = Object.defineProperties;\nvar __getOwnPropDescs$2 = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols$2 = Object.getOwnPropertySymbols;\nvar __hasOwnProp$2 = Object.prototype.hasOwnProperty;\nvar __propIsEnum$2 = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp$2 = (obj, key, value) => key in obj ? __defProp$2(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues$2 = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp$2.call(b, prop))\n      __defNormalProp$2(a, prop, b[prop]);\n  if (__getOwnPropSymbols$2)\n    for (var prop of __getOwnPropSymbols$2(b)) {\n      if (__propIsEnum$2.call(b, prop))\n        __defNormalProp$2(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps$2 = (a, b) => __defProps$2(a, __getOwnPropDescs$2(b));\nvar __objRest$1 = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp$2.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols$2)\n    for (var prop of __getOwnPropSymbols$2(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum$2.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nfunction watchPausable(source, cb, options = {}) {\n  const _a = options, {\n    eventFilter: filter\n  } = _a, watchOptions = __objRest$1(_a, [\n    \"eventFilter\"\n  ]);\n  const { eventFilter, pause, resume, isActive } = pausableFilter(filter);\n  const stop = watchWithFilter(\n    source,\n    cb,\n    __spreadProps$2(__spreadValues$2({}, watchOptions), {\n      eventFilter\n    })\n  );\n  return { stop, pause, resume, isActive };\n}\n\nvar __defProp$1 = Object.defineProperty;\nvar __defProps$1 = Object.defineProperties;\nvar __getOwnPropDescs$1 = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols$1 = Object.getOwnPropertySymbols;\nvar __hasOwnProp$1 = Object.prototype.hasOwnProperty;\nvar __propIsEnum$1 = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp$1 = (obj, key, value) => key in obj ? __defProp$1(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues$1 = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp$1.call(b, prop))\n      __defNormalProp$1(a, prop, b[prop]);\n  if (__getOwnPropSymbols$1)\n    for (var prop of __getOwnPropSymbols$1(b)) {\n      if (__propIsEnum$1.call(b, prop))\n        __defNormalProp$1(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps$1 = (a, b) => __defProps$1(a, __getOwnPropDescs$1(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp$1.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols$1)\n    for (var prop of __getOwnPropSymbols$1(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum$1.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nfunction watchThrottled(source, cb, options = {}) {\n  const _a = options, {\n    throttle = 0,\n    trailing = true,\n    leading = true\n  } = _a, watchOptions = __objRest(_a, [\n    \"throttle\",\n    \"trailing\",\n    \"leading\"\n  ]);\n  return watchWithFilter(\n    source,\n    cb,\n    __spreadProps$1(__spreadValues$1({}, watchOptions), {\n      eventFilter: throttleFilter(throttle, trailing, leading)\n    })\n  );\n}\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nfunction watchTriggerable(source, cb, options = {}) {\n  let cleanupFn;\n  function onEffect() {\n    if (!cleanupFn)\n      return;\n    const fn = cleanupFn;\n    cleanupFn = void 0;\n    fn();\n  }\n  function onCleanup(callback) {\n    cleanupFn = callback;\n  }\n  const _cb = (value, oldValue) => {\n    onEffect();\n    return cb(value, oldValue, onCleanup);\n  };\n  const res = watchIgnorable(source, _cb, options);\n  const { ignoreUpdates } = res;\n  const trigger = () => {\n    let res2;\n    ignoreUpdates(() => {\n      res2 = _cb(getWatchSources(source), getOldValue(source));\n    });\n    return res2;\n  };\n  return __spreadProps(__spreadValues({}, res), {\n    trigger\n  });\n}\nfunction getWatchSources(sources) {\n  if (isReactive(sources))\n    return sources;\n  if (Array.isArray(sources))\n    return sources.map((item) => toValue(item));\n  return toValue(sources);\n}\nfunction getOldValue(source) {\n  return Array.isArray(source) ? source.map(() => void 0) : void 0;\n}\n\nfunction whenever(source, cb, options) {\n  return watch(\n    source,\n    (v, ov, onInvalidate) => {\n      if (v)\n        cb(v, ov, onInvalidate);\n    },\n    options\n  );\n}\n\nexport { assert, refAutoReset as autoResetRef, bypassFilter, clamp, computedEager, computedWithControl, containsProp, computedWithControl as controlledComputed, controlledRef, createEventHook, createFilterWrapper, createGlobalState, createInjectionState, reactify as createReactiveFn, createSharedComposable, createSingletonPromise, debounceFilter, refDebounced as debouncedRef, watchDebounced as debouncedWatch, directiveHooks, computedEager as eagerComputed, extendRef, formatDate, get, hasOwn, identity, watchIgnorable as ignorableWatch, increaseWithUnit, invoke, isClient, isDef, isDefined, isIOS, isObject, makeDestructurable, noop, normalizeDate, notNullish, now, objectEntries, objectOmit, objectPick, pausableFilter, watchPausable as pausableWatch, promiseTimeout, rand, reactify, reactifyObject, reactiveComputed, reactiveOmit, reactivePick, refAutoReset, refDebounced, refDefault, refThrottled, refWithControl, resolveRef, resolveUnref, set, syncRef, syncRefs, throttleFilter, refThrottled as throttledRef, watchThrottled as throttledWatch, timestamp, toReactive, toRef, toRefs, toValue, tryOnBeforeMount, tryOnBeforeUnmount, tryOnMounted, tryOnScopeDispose, tryOnUnmounted, until, useArrayDifference, useArrayEvery, useArrayFilter, useArrayFind, useArrayFindIndex, useArrayFindLast, useArrayIncludes, useArrayJoin, useArrayMap, useArrayReduce, useArraySome, useArrayUnique, useCounter, useDateFormat, refDebounced as useDebounce, useDebounceFn, useInterval, useIntervalFn, useLastChanged, refThrottled as useThrottle, useThrottleFn, useTimeout, useTimeoutFn, useToNumber, useToString, useToggle, watchArray, watchAtMost, watchDebounced, watchDeep, watchIgnorable, watchImmediate, watchOnce, watchPausable, watchThrottled, watchTriggerable, watchWithFilter, whenever };\n","'use strict';\n\nmodule.exports = function (data, opts) {\n    if (!opts) opts = {};\n    if (typeof opts === 'function') opts = { cmp: opts };\n    var cycles = (typeof opts.cycles === 'boolean') ? opts.cycles : false;\n\n    var cmp = opts.cmp && (function (f) {\n        return function (node) {\n            return function (a, b) {\n                var aobj = { key: a, value: node[a] };\n                var bobj = { key: b, value: node[b] };\n                return f(aobj, bobj);\n            };\n        };\n    })(opts.cmp);\n\n    var seen = [];\n    return (function stringify (node) {\n        if (node && node.toJSON && typeof node.toJSON === 'function') {\n            node = node.toJSON();\n        }\n\n        if (node === undefined) return;\n        if (typeof node == 'number') return isFinite(node) ? '' + node : 'null';\n        if (typeof node !== 'object') return JSON.stringify(node);\n\n        var i, out;\n        if (Array.isArray(node)) {\n            out = '[';\n            for (i = 0; i < node.length; i++) {\n                if (i) out += ',';\n                out += stringify(node[i]) || 'null';\n            }\n            return out + ']';\n        }\n\n        if (node === null) return 'null';\n\n        if (seen.indexOf(node) !== -1) {\n            if (cycles) return JSON.stringify('__cycle__');\n            throw new TypeError('Converting circular structure to JSON');\n        }\n\n        var seenIndex = seen.push(node) - 1;\n        var keys = Object.keys(node).sort(cmp && cmp(node));\n        out = '';\n        for (i = 0; i < keys.length; i++) {\n            var key = keys[i];\n            var value = stringify(node[key]);\n\n            if (!value) continue;\n            if (out) out += ',';\n            out += JSON.stringify(key) + ':' + value;\n        }\n        seen.splice(seenIndex, 1);\n        return '{' + out + '}';\n    })(data);\n};\n","import type { MaybeRef } from '@vueuse/core'\nimport type { Ref } from 'vue-demi'\nimport { _ } from '@feathersjs/commons'\nimport { unref } from 'vue-demi'\nimport type { Params, Query } from '../types'\nimport type { UseFindParams } from './types'\n\nexport function makeParamsWithoutPage(params: MaybeRef<UseFindParams>) {\n  params = unref(params)\n  const query = _.omit(params.query, '$limit', '$skip')\n  const newParams = _.omit(params, 'query', 'store')\n  return { ...newParams, query }\n}\n\n// Updates the _params with everything from _newParams except `$limit` and `$skip`\nexport function updateParamsExcludePage(_params: Ref<UseFindParams>, _newParams: MaybeRef<UseFindParams>) {\n  _params.value.query = {\n    ...unref(_newParams).query,\n    ..._.pick(unref(_params).query, '$limit', '$skip'),\n  }\n}\n\nexport function getIdsFromQueryInfo(pagination: any, queryInfo: any): any[] {\n  const { queryId, pageId } = queryInfo\n  const queryLevel = pagination[queryId]\n  const pageLevel = queryLevel && queryLevel[pageId]\n  const ids = pageLevel && pageLevel.ids\n\n  return ids || []\n}\n\n/**\n * A wrapper for findInStore that can return server-paginated data\n */\nexport function itemsFromPagination(store: any, service: any, params: Params<Query>) {\n  const qid = params.qid || 'default'\n  const pagination = store.pagination[qid] || {}\n  const queryInfo = store.getQueryInfo(params)\n  const ids = getIdsFromQueryInfo(pagination, queryInfo)\n  const items = ids\n    .map((id) => {\n      const fromStore = service.getFromStore(id).value\n      return fromStore\n    })\n    .filter(i => i) // filter out undefined values\n  return items\n}\n","import type { Ref } from 'vue-demi'\nimport { computed } from 'vue-demi'\nimport { timeout } from '../utils'\n\ninterface Options {\n  limit: Ref<number>\n  skip: Ref<number>\n  total: Ref<number>\n  request?: any\n}\n\nexport function usePageData(options: Options) {\n  const { limit, skip, total, request } = options\n  /**\n   * The number of pages available based on the results returned in the latestQuery prop.\n   */\n  const pageCount = computed(() => {\n    if (total.value)\n      return Math.ceil(total.value / limit.value)\n    else return 1\n  })\n\n  // Uses Math.floor so we can't land on a non-integer page like 1.4\n  const currentPage = computed({\n    set(pageNumber: number) {\n      if (pageNumber < 1)\n        pageNumber = 1\n      else if (pageNumber > pageCount.value)\n        pageNumber = pageCount.value\n      const newSkip = limit.value * Math.floor(pageNumber - 1)\n      skip.value = newSkip\n    },\n    get() {\n      const skipVal = skip.value || 0\n      return pageCount.value === 0 ? 0 : Math.floor(skipVal / limit.value + 1)\n    },\n  })\n\n  const canPrev = computed(() => {\n    return currentPage.value - 1 > 0\n  })\n  const canNext = computed(() => {\n    return currentPage.value < pageCount.value\n  })\n\n  const wait = async () => {\n    if (request?.value)\n      await request.value\n  }\n  const toStart = async () => {\n    currentPage.value = 1\n    await timeout(0)\n    return wait()\n  }\n  const toEnd = async () => {\n    currentPage.value = pageCount.value\n    await timeout(0)\n    return wait()\n  }\n  const toPage = async (page: number) => {\n    currentPage.value = page\n    await timeout(0)\n    return wait()\n  }\n  const next = async () => {\n    currentPage.value++\n    await timeout(0)\n    return wait()\n  }\n  const prev = async () => {\n    currentPage.value--\n    await timeout(0)\n    return wait()\n  }\n\n  return { pageCount, currentPage, canPrev, canNext, toStart, toEnd, toPage, next, prev }\n}\n","/* eslint-disable @typescript-eslint/no-use-before-define */\nimport type { ComputedRef, Ref } from 'vue-demi'\nimport { computed, ref, unref, watch } from 'vue-demi'\nimport { _ } from '@feathersjs/commons'\nimport { useDebounceFn } from '@vueuse/core'\nimport stringify from 'fast-json-stable-stringify'\nimport { deepUnref, getExtendedQueryInfo } from '../utils'\nimport type { AnyData, ExtendedQueryInfo, Paginated, Params, Query } from '../types'\nimport { itemsFromPagination } from './utils'\nimport { usePageData } from './utils-pagination'\nimport type { UseFindGetDeps, UseFindOptions, UseFindParams } from './types'\n\nexport function useFind(params: ComputedRef<UseFindParams | null>, options: UseFindOptions = {}, deps: UseFindGetDeps) {\n  const { pagination, debounce = 100, immediate = true, watch: _watch = true, paginateOn = 'client' } = options\n  const { service } = deps\n  const { store } = service\n\n  /** PARAMS **/\n  const qid = computed(() => params.value?.qid || 'default')\n  const limit = pagination?.limit || ref(params.value?.query?.$limit || store.defaultLimit)\n  const skip = pagination?.skip || ref(params.value?.query?.$skip || 0)\n\n  const paramsWithPagination = computed(() => {\n    const query = deepUnref(params.value?.query || {})\n    return {\n      ...params.value,\n      query: {\n        ...query,\n        $limit: limit.value,\n        $skip: skip.value,\n      },\n    }\n  })\n  const paramsWithoutPagination = computed(() => {\n    const queryShallowCopy = deepUnref(params.value?.query || {})\n    const query = _.omit(queryShallowCopy, '$limit', '$skip')\n    const newParams = { ...params.value, query }\n    return newParams\n  })\n\n  /** REQUEST STATE **/\n  const isPending = ref(false)\n  const haveBeenRequested = ref(false)\n  const haveLoaded = ref(false)\n  const error = ref<any>(null)\n  const clearError = () => (error.value = null)\n\n  /** Cached Params **/\n  const cachedParams = ref(deepUnref(params.value || {}))\n  function updateCachedParams() {\n    if (stringify(cachedParams.value) !== stringify(paramsWithPagination.value))\n      cachedParams.value = paramsWithPagination.value\n  }\n\n  /** STORE ITEMS **/\n  const localParams = computed(() => {\n    const beforeCurrent = itemsBeforeCurrent.value\n    const adjustedSkip = skip.value + (beforeCurrent.length - skip.value)\n    const params = {\n      ...paramsWithPagination.value,\n      query: {\n        ...paramsWithPagination.value.query,\n        $limit: limit.value,\n        $skip: adjustedSkip,\n      },\n    }\n    return params\n  })\n\n  const data = computed(() => {\n    if (paginateOn === 'server') {\n      const values = itemsFromPagination(store, service, cachedParams.value)\n      return values\n    } else if (paginateOn === 'hybrid') {\n      const result = service.findInStore(deepUnref(localParams)).data.value\n      return result.filter((i: any) => i)\n    } else {\n      const result = service.findInStore(deepUnref(paramsWithPagination)).data.value\n      return result.filter((i: any) => i)\n    }\n  })\n  const itemsBeforeCurrent = computed(() => {\n    const whichQuery = isPending.value ? cachedQuery.value : currentQuery.value\n    if (whichQuery == null) return []\n\n    const allItems = allLocalData.value\n    const firstOfCurrentPage = whichQuery.items.find((i: any) => i)\n    const indexInItems = allItems.findIndex((i: any) => i[store.idField] === firstOfCurrentPage[store.idField])\n    // if indexInItems is higher than skip, use the skip value instead\n    const adjustedIndex = Math.min(indexInItems, skip.value)\n    const beforeCurrent = allItems.slice(0, adjustedIndex)\n    return beforeCurrent\n  })\n  const allLocalData = computed(() => {\n    const whichQuery = isPending.value ? cachedQuery.value : currentQuery.value\n    if (whichQuery == null && paginateOn !== 'client')\n      return []\n\n    const allItems = service.findInStore(deepUnref(paramsWithoutPagination.value)).data.value\n    return allItems\n  })\n\n  /** QUERY WHEN **/\n  let queryWhenFn = () => true\n  const queryWhen = (_queryWhenFn: () => boolean) => {\n    queryWhenFn = _queryWhenFn\n  }\n  // returns cached query data from the store BEFORE the request is sent.\n  const cachedQuery = computed(() => {\n    const qidState: any = store.pagination[qid.value]\n    if (!qidState) return null\n\n    const queryInfo = store.getQueryInfo(cachedParams.value)\n    const extendedInfo = getExtendedQueryInfo({ queryInfo, service, store, qid })\n    return extendedInfo\n  })\n\n  const currentQuery = computed(() => {\n    const qidState: any = store.pagination[qid.value]\n    if (!qidState) return null\n\n    const queryInfo = store.getQueryInfo(paramsWithPagination.value)\n    const extendedInfo = getExtendedQueryInfo({ queryInfo, service, store, qid })\n    return extendedInfo\n  })\n\n  /** QUERIES **/\n  const queries: Ref<ExtendedQueryInfo[]> = ref([]) // query info after the response returns\n  const latestQuery = computed(() => {\n    return queries.value[queries.value.length - 1] || null\n  })\n  const previousQuery = computed(() => {\n    return queries.value[queries.value.length - 2] || null\n  })\n\n  /** SERVER FETCHING **/\n  const requestCount = ref(0)\n  const request = ref<Promise<Paginated<AnyData>> | null>(null)\n\n  // pulled into its own function so it can be called from `makeRequest` or `find`\n  function setupPendingState() {\n    // prevent setting pending state for cached ssr requests\n    if (currentQuery.value?.ssr) return\n\n    if (!haveBeenRequested.value) haveBeenRequested.value = true // never resets\n    clearError()\n    if (!isPending.value) isPending.value = true\n    if (haveLoaded.value) haveLoaded.value = false\n  }\n\n  async function find(__params?: Params<Query>) {\n    // When `paginateOn: 'server'` is enabled, the computed params will always be used, __params ignored.\n    const ___params = unref(__params != null ? __params : paginateOn === 'client' ? paramsWithoutPagination.value : paramsWithPagination.value)\n\n    // if queryWhen is falsey, return early with dummy data\n    if (!queryWhenFn()) return Promise.resolve({ data: [] as AnyData[] } as Paginated<AnyData>)\n\n    setupPendingState()\n    requestCount.value++\n\n    try {\n      const response = await service.find(___params as any)\n\n      // Keep the two most-recent queries\n      if (response.total) {\n        const queryInfo = store.getQueryInfo(paramsWithPagination.value)\n        const extendedQueryInfo = getExtendedQueryInfo({ queryInfo, service, store, qid })\n        if (extendedQueryInfo) queries.value.push(extendedQueryInfo as unknown as ExtendedQueryInfo)\n        if (queries.value.length > 2) queries.value.shift()\n      }\n      haveLoaded.value = true\n\n      return response\n    } catch (err: any) {\n      error.value = err\n      throw err\n    } finally {\n      isPending.value = false\n    }\n  }\n  const findDebounced = useDebounceFn<any>(find, debounce)\n\n  /** Query Gatekeeping **/\n  const makeRequest = async (p?: Params<Query>) => {\n    // If params are null, do nothing\n    if (params.value === null) return\n\n    // If we already have data for the currentQuery, update the cachedParams immediately\n    if (currentQuery.value) updateCachedParams()\n\n    // if the query passes queryWhen, setup the state before the debounce timer starts.\n    if (queryWhenFn()) setupPendingState()\n\n    request.value = findDebounced(p)\n    await request.value\n\n    // cache the params to update the computed `data``\n    updateCachedParams()\n  }\n\n  /** Pagination Data **/\n  const total = computed(() => {\n    if (['server', 'hybrid'].includes(paginateOn)) {\n      const whichQuery = currentQuery.value || cachedQuery.value\n      return whichQuery?.total || 0\n    } else {\n      const count = service.countInStore(paramsWithoutPagination.value)\n      return count.value\n    }\n  })\n  const pageData = usePageData({ limit, skip, total, request })\n  const { pageCount, currentPage, canPrev, canNext, toStart, toEnd, toPage, next, prev } = pageData\n\n  /** Query Watching **/\n  if (['server', 'hybrid'].includes(paginateOn) && _watch) {\n    watch(\n      paramsWithPagination,\n      () => {\n        makeRequest()\n      },\n      { immediate: false },\n    )\n\n    if (immediate) makeRequest()\n  }\n\n  if (paginateOn === 'server') {\n    // watch realtime events and re-query\n    // TODO: only re-query when relevant\n    service.on('created', () => {\n      makeRequest()\n    })\n    service.on('patched', () => {\n      makeRequest()\n    })\n\n    // if the current list had an item removed, re-query.\n    service.on('removed', () => {\n      // const id = item[service.store.idField]\n      // const currentIds = data.value.map((i: any) => i[service.store.idField])\n      // if (currentIds.includes(id))\n      makeRequest()\n    })\n  }\n\n  return {\n    paramsWithPagination,\n    isSsr: computed(() => {\n      // hack: read total early during SSR to prevent hydration mismatch\n      setTimeout(() => {\n        ref(total.value)\n      }, 0)\n      return store.isSsr\n    }), // ComputedRef<boolean>\n    qid, // WritableComputedRef<string>\n\n    // Data\n    data, // ComputedRef<M[]>\n    allLocalData, // ComputedRef<M[]>\n    total, // ComputedRef<number>\n    limit, // Ref<number>\n    skip, // Ref<number>\n\n    // Queries\n    currentQuery, // ComputedRef<CurrentQuery<M> | null>\n    cachedQuery, // ComputedRef<CurrentQuery<M> | null>\n    latestQuery, // ComputedRef<QueryInfo | null>\n    previousQuery, // ComputedRef<QueryInfo | null>\n\n    // Requests & Watching\n    find: makeRequest, // FindFn<M>\n    request, // Ref<Promise<Paginated<M>>>\n    requestCount, // Ref<number>\n    queryWhen, // (queryWhenFn: () => boolean) => void\n\n    // Request State\n    isPending: computed(() => isPending.value), // ComputedRef<boolean>\n    haveBeenRequested: computed(() => haveBeenRequested.value), // ComputedRef<boolean>\n    haveLoaded: computed(() => haveLoaded.value), // ComputedRef<boolean>\n    error: computed(() => error.value), // ComputedRef<any>\n    clearError, // () => void\n\n    // Pagination Utils\n    pageCount, // Ref<number>\n    currentPage, // Ref<number>\n    canPrev, // ComputedRef<boolean>\n    canNext, // ComputedRef<boolean>\n    next, // () => Promise<void>\n    prev, // () => Promise<void>\n    toStart, // () => Promise<void>\n    toEnd, // () => Promise<void>\n    toPage, // (page: number) => Promise<void>\n  }\n}\n","import type { Id } from '@feathersjs/feathers'\nimport type { ComputedRef } from 'vue-demi'\nimport type { AnyData } from '../types'\nimport type { UseFindGetDeps, UseGetParams } from './types'\nimport type { MaybeRef } from '@vueuse/core'\nimport { computed, ref, unref, watch, isRef } from 'vue-demi'\n\ntype MaybeComputed<M> = ComputedRef<M> | MaybeRef<M>\n\nexport const useGet = (\n  _id: MaybeComputed<Id | null>,\n  _params: MaybeRef<UseGetParams> = ref({}),\n  deps: UseFindGetDeps,\n) => {\n  const { service } = deps\n\n  // normalize args into refs\n  const id = isRef(_id) ? _id : ref(_id)\n  const params = isRef(_params) ? _params : ref(_params)\n\n  /** ID & PARAMS **/\n  const { immediate = true, watch: _watch = true } = params.value\n  const isSsr = computed(() => service.store.isSsr)\n\n  /** REQUEST STATE **/\n  const isPending = ref(false)\n  const hasBeenRequested = ref(false)\n  const error = ref<any>(null)\n  const clearError = () => (error.value = null)\n\n  /** STORE ITEMS **/\n  const ids = ref<Id[]>([])\n  const mostRecentId = computed(() => {\n    return ids.value.length && ids.value[ids.value.length - 1]\n  })\n  const data = computed(() => {\n    if (isPending.value && mostRecentId.value != null) {\n      const result = service.store.getFromStore(mostRecentId.value, params).value\n      return result\n    }\n    const result = service.store.getFromStore(id.value, params).value\n    return result\n  })\n  const getFromStore = service.store.getFromStore\n\n  const hasLoaded = computed(() => !!data.value)\n\n  /** QUERY WHEN **/\n  let queryWhenFn = () => true\n  const queryWhen = (_queryWhenFn: () => boolean) => {\n    queryWhenFn = _queryWhenFn\n  }\n\n  /** SERVER FETCHING **/\n  const requestCount = ref(0)\n  const request = ref<Promise<AnyData> | null>(null)\n  async function get() {\n    const _id = unref(id)\n    const _params = unref(params)\n\n    if (!queryWhenFn()) return\n\n    if (_id == null) return null\n\n    requestCount.value++\n    hasBeenRequested.value = true // never resets\n    isPending.value = true\n    error.value = null\n\n    try {\n      const response = await service.get(_id, _params)\n\n      // Keep a list of retrieved ids\n      if (response && _id) ids.value.push(_id)\n\n      return response\n    } catch (err: any) {\n      error.value = err\n    } finally {\n      isPending.value = false\n    }\n  }\n\n  async function makeRequest() {\n    request.value = get()\n    const val = await request.value\n    return val\n  }\n\n  // Watch the id\n  if (_watch)\n    watch(\n      id,\n      async () => {\n        await makeRequest()\n      },\n      { immediate },\n    )\n\n  return {\n    params, // Ref<GetClassParams>\n    isSsr, // ComputedRef<boolean>\n\n    // Data\n    data, // ComputedRef<M | null>\n    ids, // Ref<Id[]>\n    getFromStore, // (id: Id | null, params: Params<Query>) => M | undefined\n\n    // Requests & Watching\n    get: makeRequest, // GetFn<M>\n    request, // Ref<Promise<M | undefined>>\n    requestCount, // Ref<number>\n    queryWhen, // (queryWhenFn: () => boolean) => void\n\n    // Request State\n    isPending: computed(() => isPending.value), // ComputedRef<boolean>\n    hasBeenRequested: computed(() => hasBeenRequested.value), // ComputedRef<boolean>\n    hasLoaded: computed(() => hasLoaded.value), // ComputedRef<boolean>\n    error: computed(() => error.value), // ComputedRef<any>\n    clearError, // () => void\n  }\n}\n","import type { Params as FeathersParams, FeathersService, Id } from '@feathersjs/feathers'\nimport type { AnyData, Params, Query } from './types'\nimport type { MaybeRef } from '@vueuse/core'\nimport type { UseFindOptions, UseFindParams, UseGetParams } from './use-find-get'\nimport type { ComputedRef } from 'vue-demi'\nimport { reactive, computed, isRef, ref, unref } from 'vue-demi'\nimport { getParams } from './utils'\nimport { useFind, useGet } from './use-find-get'\nimport { convertData } from './utils/convert-data'\nimport { ServiceInstance } from './modeling'\n\ninterface PiniaServiceOptions {\n  servicePath: string\n  store: any\n}\n\nexport class PiniaService<Svc extends FeathersService> {\n  store\n  servicePath = ''\n\n  constructor(public service: Svc, public options: PiniaServiceOptions) {\n    this.store = options.store\n    this.servicePath = options.servicePath\n  }\n\n  /**\n   * Prepare new \"instances\" outside of store\n   *\n   * Functionally upgrades plain data to a service model \"instance\".\n   * - flags each record with `__isSetup` to avoid duplicate work.\n   */\n  new(data: AnyData = {}) {\n    const asInstance = this.store.new(data)\n    return reactive(asInstance)\n  }\n\n  /* service methods clone params */\n\n  async find(_params?: MaybeRef<Params<Query>>) {\n    const params = getParams(_params)\n    const result = await this.service.find(params as FeathersParams)\n    return result\n  }\n\n  async findOne(_params?: MaybeRef<Params<Query>>) {\n    const params = getParams(_params)\n    params.query = params.query || {}\n    params.query.$limit = 1\n    const result = await this.service.find(params as FeathersParams)\n    const item = (result.data || result)[0] || null\n    return item\n  }\n\n  async count(_params?: MaybeRef<Params<Query>>) {\n    const params = getParams(_params)\n    params.query = params.query || {}\n    params.query.$limit = 0\n    const result = await this.service.find(params as FeathersParams)\n    return result\n  }\n\n  async get(id: Id, _params?: MaybeRef<Params<Query>>) {\n    const params = getParams(_params)\n    const result = await this.service.get(id, params)\n    return result\n  }\n\n  async create(data: AnyData) {\n    const result = await this.service.create(data)\n    return result\n  }\n\n  async patch(id: Id, data: AnyData, _params?: MaybeRef<Params<Query>>) {\n    const params = getParams(_params)\n    const result = await this.service.patch(id, data, params)\n    return result\n  }\n\n  async remove(id: Id, _params?: MaybeRef<Params<Query>>) {\n    const params = getParams(_params)\n    const result = await this.service.remove(id, params)\n    return result\n  }\n\n  /* store methods accept refs and don't copy params */\n\n  findInStore(params?: MaybeRef<Params<Query>>) {\n    const result = this.store.findInStore(params)\n    return {\n      ...result,\n      data: computed(() => {\n        return result.data.value.map((i: any) => convertData(this, i))\n      }),\n    }\n  }\n\n  findOneInStore(params?: MaybeRef<Params<Query>>) {\n    const result = this.store.findOneInStore(params)\n    return result\n  }\n\n  countInStore(params?: MaybeRef<Params<Query>>) {\n    const result = this.store.countInStore(params)\n    return result\n  }\n\n  getFromStore(id: Id, params?: MaybeRef<Params<Query>>): ComputedRef<ServiceInstance<AnyData>> {\n    const result = this.store.getFromStore(id, params)\n    return result\n  }\n\n  createInStore(data: AnyData) {\n    const result = this.store.createInStore(data)\n    return result\n  }\n\n  patchInStore<M extends AnyData, Q extends AnyData>(\n    idOrData: MaybeRef<M | M[] | Id | null>,\n    data: MaybeRef<AnyData> = {},\n    params: MaybeRef<Params<Q>> = {},\n  ) {\n    const result = this.store.patchInStore(idOrData, data, params)\n    return result\n  }\n\n  removeFromStore(id?: Id, params?: MaybeRef<Params<Query>>) {\n    const item = id != null ? this.getFromStore(id).value : null\n    if (item) {\n      const result = this.store.removeFromStore(item)\n      return result\n    } else if (id == null && unref(params)?.query) {\n      const result = this.store.removeByQuery(params)\n      return result\n    }\n  }\n\n  /* hybrid methods */\n\n  useFind(params: ComputedRef<UseFindParams | null>, options?: UseFindOptions) {\n    const _params = isRef(params) ? params : ref(params)\n    return useFind(_params, options, { service: this })\n  }\n\n  useGet(id: MaybeRef<Id | null>, params: MaybeRef<UseGetParams> = ref({})) {\n    const _id = isRef(id) ? id : ref(id)\n    const _params = isRef(params) ? params : ref(params)\n    return useGet(_id, _params, { service: this })\n  }\n\n  useGetOnce(_id: MaybeRef<Id | null>, params: MaybeRef<UseGetParams> = {}) {\n    const _params = isRef(params) ? params : ref(params)\n    Object.assign(_params.value, { immediate: false })\n    const results = this.useGet(_id, _params)\n    results.queryWhen(() => !results.data.value)\n    results.get()\n    return results\n  }\n\n  /* events */\n\n  on(eventName: string | symbol, listener: (...args: any[]) => void) {\n    return this.service.on(eventName, listener)\n  }\n\n  emit(eventName: string | symbol, ...args: any[]): boolean {\n    return this.service.emit(eventName, ...args)\n  }\n\n  removeListener(eventName: string | symbol, listener: (...args: any[]) => void) {\n    return this.service.removeListener(eventName, listener)\n  }\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\n\nvar typeChecker = function (type) {\n    var typeString = \"[object \" + type + \"]\";\n    return function (value) {\n        return getClassName(value) === typeString;\n    };\n};\nvar getClassName = function (value) { return Object.prototype.toString.call(value); };\nvar comparable = function (value) {\n    if (value instanceof Date) {\n        return value.getTime();\n    }\n    else if (isArray(value)) {\n        return value.map(comparable);\n    }\n    else if (value && typeof value.toJSON === \"function\") {\n        return value.toJSON();\n    }\n    return value;\n};\nvar coercePotentiallyNull = function (value) {\n    return value == null ? null : value;\n};\nvar isArray = typeChecker(\"Array\");\nvar isObject = typeChecker(\"Object\");\nvar isFunction = typeChecker(\"Function\");\nvar isVanillaObject = function (value) {\n    return (value &&\n        (value.constructor === Object ||\n            value.constructor === Array ||\n            value.constructor.toString() === \"function Object() { [native code] }\" ||\n            value.constructor.toString() === \"function Array() { [native code] }\") &&\n        !value.toJSON);\n};\nvar equals = function (a, b) {\n    if (a == null && a == b) {\n        return true;\n    }\n    if (a === b) {\n        return true;\n    }\n    if (Object.prototype.toString.call(a) !== Object.prototype.toString.call(b)) {\n        return false;\n    }\n    if (isArray(a)) {\n        if (a.length !== b.length) {\n            return false;\n        }\n        for (var i = 0, length_1 = a.length; i < length_1; i++) {\n            if (!equals(a[i], b[i]))\n                return false;\n        }\n        return true;\n    }\n    else if (isObject(a)) {\n        if (Object.keys(a).length !== Object.keys(b).length) {\n            return false;\n        }\n        for (var key in a) {\n            if (!equals(a[key], b[key]))\n                return false;\n        }\n        return true;\n    }\n    return false;\n};\n\n/**\n * Walks through each value given the context - used for nested operations. E.g:\n * { \"person.address\": { $eq: \"blarg\" }}\n */\nvar walkKeyPathValues = function (item, keyPath, next, depth, key, owner) {\n    var currentKey = keyPath[depth];\n    // if array, then try matching. Might fall through for cases like:\n    // { $eq: [1, 2, 3] }, [ 1, 2, 3 ].\n    if (isArray(item) && isNaN(Number(currentKey))) {\n        for (var i = 0, length_1 = item.length; i < length_1; i++) {\n            // if FALSE is returned, then terminate walker. For operations, this simply\n            // means that the search critera was met.\n            if (!walkKeyPathValues(item[i], keyPath, next, depth, i, item)) {\n                return false;\n            }\n        }\n    }\n    if (depth === keyPath.length || item == null) {\n        return next(item, key, owner, depth === 0);\n    }\n    return walkKeyPathValues(item[currentKey], keyPath, next, depth + 1, currentKey, item);\n};\nvar BaseOperation = /** @class */ (function () {\n    function BaseOperation(params, owneryQuery, options, name) {\n        this.params = params;\n        this.owneryQuery = owneryQuery;\n        this.options = options;\n        this.name = name;\n        this.init();\n    }\n    BaseOperation.prototype.init = function () { };\n    BaseOperation.prototype.reset = function () {\n        this.done = false;\n        this.keep = false;\n    };\n    return BaseOperation;\n}());\nvar GroupOperation = /** @class */ (function (_super) {\n    __extends(GroupOperation, _super);\n    function GroupOperation(params, owneryQuery, options, children) {\n        var _this = _super.call(this, params, owneryQuery, options) || this;\n        _this.children = children;\n        return _this;\n    }\n    /**\n     */\n    GroupOperation.prototype.reset = function () {\n        this.keep = false;\n        this.done = false;\n        for (var i = 0, length_2 = this.children.length; i < length_2; i++) {\n            this.children[i].reset();\n        }\n    };\n    /**\n     */\n    GroupOperation.prototype.childrenNext = function (item, key, owner, root) {\n        var done = true;\n        var keep = true;\n        for (var i = 0, length_3 = this.children.length; i < length_3; i++) {\n            var childOperation = this.children[i];\n            if (!childOperation.done) {\n                childOperation.next(item, key, owner, root);\n            }\n            if (!childOperation.keep) {\n                keep = false;\n            }\n            if (childOperation.done) {\n                if (!childOperation.keep) {\n                    break;\n                }\n            }\n            else {\n                done = false;\n            }\n        }\n        this.done = done;\n        this.keep = keep;\n    };\n    return GroupOperation;\n}(BaseOperation));\nvar NamedGroupOperation = /** @class */ (function (_super) {\n    __extends(NamedGroupOperation, _super);\n    function NamedGroupOperation(params, owneryQuery, options, children, name) {\n        var _this = _super.call(this, params, owneryQuery, options, children) || this;\n        _this.name = name;\n        return _this;\n    }\n    return NamedGroupOperation;\n}(GroupOperation));\nvar QueryOperation = /** @class */ (function (_super) {\n    __extends(QueryOperation, _super);\n    function QueryOperation() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.propop = true;\n        return _this;\n    }\n    /**\n     */\n    QueryOperation.prototype.next = function (item, key, parent, root) {\n        this.childrenNext(item, key, parent, root);\n    };\n    return QueryOperation;\n}(GroupOperation));\nvar NestedOperation = /** @class */ (function (_super) {\n    __extends(NestedOperation, _super);\n    function NestedOperation(keyPath, params, owneryQuery, options, children) {\n        var _this = _super.call(this, params, owneryQuery, options, children) || this;\n        _this.keyPath = keyPath;\n        _this.propop = true;\n        /**\n         */\n        _this._nextNestedValue = function (value, key, owner, root) {\n            _this.childrenNext(value, key, owner, root);\n            return !_this.done;\n        };\n        return _this;\n    }\n    /**\n     */\n    NestedOperation.prototype.next = function (item, key, parent) {\n        walkKeyPathValues(item, this.keyPath, this._nextNestedValue, 0, key, parent);\n    };\n    return NestedOperation;\n}(GroupOperation));\nvar createTester = function (a, compare) {\n    if (a instanceof Function) {\n        return a;\n    }\n    if (a instanceof RegExp) {\n        return function (b) {\n            var result = typeof b === \"string\" && a.test(b);\n            a.lastIndex = 0;\n            return result;\n        };\n    }\n    var comparableA = comparable(a);\n    return function (b) { return compare(comparableA, comparable(b)); };\n};\nvar EqualsOperation = /** @class */ (function (_super) {\n    __extends(EqualsOperation, _super);\n    function EqualsOperation() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.propop = true;\n        return _this;\n    }\n    EqualsOperation.prototype.init = function () {\n        this._test = createTester(this.params, this.options.compare);\n    };\n    EqualsOperation.prototype.next = function (item, key, parent) {\n        if (!Array.isArray(parent) || parent.hasOwnProperty(key)) {\n            if (this._test(item, key, parent)) {\n                this.done = true;\n                this.keep = true;\n            }\n        }\n    };\n    return EqualsOperation;\n}(BaseOperation));\nvar createEqualsOperation = function (params, owneryQuery, options) { return new EqualsOperation(params, owneryQuery, options); };\nvar numericalOperationCreator = function (createNumericalOperation) { return function (params, owneryQuery, options, name) {\n    return createNumericalOperation(params, owneryQuery, options, name);\n}; };\nvar numericalOperation = function (createTester) {\n    return numericalOperationCreator(function (params, owneryQuery, options, name) {\n        var typeofParams = typeof comparable(params);\n        var test = createTester(params);\n        return new EqualsOperation(function (b) {\n            var actualValue = coercePotentiallyNull(b);\n            return (typeof comparable(actualValue) === typeofParams && test(actualValue));\n        }, owneryQuery, options, name);\n    });\n};\nvar createNamedOperation = function (name, params, parentQuery, options) {\n    var operationCreator = options.operations[name];\n    if (!operationCreator) {\n        throwUnsupportedOperation(name);\n    }\n    return operationCreator(params, parentQuery, options, name);\n};\nvar throwUnsupportedOperation = function (name) {\n    throw new Error(\"Unsupported operation: \" + name);\n};\nvar containsOperation = function (query, options) {\n    for (var key in query) {\n        if (options.operations.hasOwnProperty(key) || key.charAt(0) === \"$\")\n            return true;\n    }\n    return false;\n};\nvar createNestedOperation = function (keyPath, nestedQuery, parentKey, owneryQuery, options) {\n    if (containsOperation(nestedQuery, options)) {\n        var _a = createQueryOperations(nestedQuery, parentKey, options), selfOperations = _a[0], nestedOperations = _a[1];\n        if (nestedOperations.length) {\n            throw new Error(\"Property queries must contain only operations, or exact objects.\");\n        }\n        return new NestedOperation(keyPath, nestedQuery, owneryQuery, options, selfOperations);\n    }\n    return new NestedOperation(keyPath, nestedQuery, owneryQuery, options, [\n        new EqualsOperation(nestedQuery, owneryQuery, options)\n    ]);\n};\nvar createQueryOperation = function (query, owneryQuery, _a) {\n    if (owneryQuery === void 0) { owneryQuery = null; }\n    var _b = _a === void 0 ? {} : _a, compare = _b.compare, operations = _b.operations;\n    var options = {\n        compare: compare || equals,\n        operations: Object.assign({}, operations || {})\n    };\n    var _c = createQueryOperations(query, null, options), selfOperations = _c[0], nestedOperations = _c[1];\n    var ops = [];\n    if (selfOperations.length) {\n        ops.push(new NestedOperation([], query, owneryQuery, options, selfOperations));\n    }\n    ops.push.apply(ops, nestedOperations);\n    if (ops.length === 1) {\n        return ops[0];\n    }\n    return new QueryOperation(query, owneryQuery, options, ops);\n};\nvar createQueryOperations = function (query, parentKey, options) {\n    var selfOperations = [];\n    var nestedOperations = [];\n    if (!isVanillaObject(query)) {\n        selfOperations.push(new EqualsOperation(query, query, options));\n        return [selfOperations, nestedOperations];\n    }\n    for (var key in query) {\n        if (options.operations.hasOwnProperty(key)) {\n            var op = createNamedOperation(key, query[key], query, options);\n            if (op) {\n                if (!op.propop && parentKey && !options.operations[parentKey]) {\n                    throw new Error(\"Malformed query. \" + key + \" cannot be matched against property.\");\n                }\n            }\n            // probably just a flag for another operation (like $options)\n            if (op != null) {\n                selfOperations.push(op);\n            }\n        }\n        else if (key.charAt(0) === \"$\") {\n            throwUnsupportedOperation(key);\n        }\n        else {\n            nestedOperations.push(createNestedOperation(key.split(\".\"), query[key], key, query, options));\n        }\n    }\n    return [selfOperations, nestedOperations];\n};\nvar createOperationTester = function (operation) { return function (item, key, owner) {\n    operation.reset();\n    operation.next(item, key, owner);\n    return operation.keep;\n}; };\nvar createQueryTester = function (query, options) {\n    if (options === void 0) { options = {}; }\n    return createOperationTester(createQueryOperation(query, null, options));\n};\n\nvar $Ne = /** @class */ (function (_super) {\n    __extends($Ne, _super);\n    function $Ne() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.propop = true;\n        return _this;\n    }\n    $Ne.prototype.init = function () {\n        this._test = createTester(this.params, this.options.compare);\n    };\n    $Ne.prototype.reset = function () {\n        _super.prototype.reset.call(this);\n        this.keep = true;\n    };\n    $Ne.prototype.next = function (item) {\n        if (this._test(item)) {\n            this.done = true;\n            this.keep = false;\n        }\n    };\n    return $Ne;\n}(BaseOperation));\n// https://docs.mongodb.com/manual/reference/operator/query/elemMatch/\nvar $ElemMatch = /** @class */ (function (_super) {\n    __extends($ElemMatch, _super);\n    function $ElemMatch() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.propop = true;\n        return _this;\n    }\n    $ElemMatch.prototype.init = function () {\n        if (!this.params || typeof this.params !== \"object\") {\n            throw new Error(\"Malformed query. $elemMatch must by an object.\");\n        }\n        this._queryOperation = createQueryOperation(this.params, this.owneryQuery, this.options);\n    };\n    $ElemMatch.prototype.reset = function () {\n        _super.prototype.reset.call(this);\n        this._queryOperation.reset();\n    };\n    $ElemMatch.prototype.next = function (item) {\n        if (isArray(item)) {\n            for (var i = 0, length_1 = item.length; i < length_1; i++) {\n                // reset query operation since item being tested needs to pass _all_ query\n                // operations for it to be a success\n                this._queryOperation.reset();\n                var child = item[i];\n                this._queryOperation.next(child, i, item, false);\n                this.keep = this.keep || this._queryOperation.keep;\n            }\n            this.done = true;\n        }\n        else {\n            this.done = false;\n            this.keep = false;\n        }\n    };\n    return $ElemMatch;\n}(BaseOperation));\nvar $Not = /** @class */ (function (_super) {\n    __extends($Not, _super);\n    function $Not() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.propop = true;\n        return _this;\n    }\n    $Not.prototype.init = function () {\n        this._queryOperation = createQueryOperation(this.params, this.owneryQuery, this.options);\n    };\n    $Not.prototype.reset = function () {\n        _super.prototype.reset.call(this);\n        this._queryOperation.reset();\n    };\n    $Not.prototype.next = function (item, key, owner, root) {\n        this._queryOperation.next(item, key, owner, root);\n        this.done = this._queryOperation.done;\n        this.keep = !this._queryOperation.keep;\n    };\n    return $Not;\n}(BaseOperation));\nvar $Size = /** @class */ (function (_super) {\n    __extends($Size, _super);\n    function $Size() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.propop = true;\n        return _this;\n    }\n    $Size.prototype.init = function () { };\n    $Size.prototype.next = function (item) {\n        if (isArray(item) && item.length === this.params) {\n            this.done = true;\n            this.keep = true;\n        }\n        // if (parent && parent.length === this.params) {\n        //   this.done = true;\n        //   this.keep = true;\n        // }\n    };\n    return $Size;\n}(BaseOperation));\nvar assertGroupNotEmpty = function (values) {\n    if (values.length === 0) {\n        throw new Error(\"$and/$or/$nor must be a nonempty array\");\n    }\n};\nvar $Or = /** @class */ (function (_super) {\n    __extends($Or, _super);\n    function $Or() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.propop = false;\n        return _this;\n    }\n    $Or.prototype.init = function () {\n        var _this = this;\n        assertGroupNotEmpty(this.params);\n        this._ops = this.params.map(function (op) {\n            return createQueryOperation(op, null, _this.options);\n        });\n    };\n    $Or.prototype.reset = function () {\n        this.done = false;\n        this.keep = false;\n        for (var i = 0, length_2 = this._ops.length; i < length_2; i++) {\n            this._ops[i].reset();\n        }\n    };\n    $Or.prototype.next = function (item, key, owner) {\n        var done = false;\n        var success = false;\n        for (var i = 0, length_3 = this._ops.length; i < length_3; i++) {\n            var op = this._ops[i];\n            op.next(item, key, owner);\n            if (op.keep) {\n                done = true;\n                success = op.keep;\n                break;\n            }\n        }\n        this.keep = success;\n        this.done = done;\n    };\n    return $Or;\n}(BaseOperation));\nvar $Nor = /** @class */ (function (_super) {\n    __extends($Nor, _super);\n    function $Nor() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.propop = false;\n        return _this;\n    }\n    $Nor.prototype.next = function (item, key, owner) {\n        _super.prototype.next.call(this, item, key, owner);\n        this.keep = !this.keep;\n    };\n    return $Nor;\n}($Or));\nvar $In = /** @class */ (function (_super) {\n    __extends($In, _super);\n    function $In() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.propop = true;\n        return _this;\n    }\n    $In.prototype.init = function () {\n        var _this = this;\n        this._testers = this.params.map(function (value) {\n            if (containsOperation(value, _this.options)) {\n                throw new Error(\"cannot nest $ under \" + _this.name.toLowerCase());\n            }\n            return createTester(value, _this.options.compare);\n        });\n    };\n    $In.prototype.next = function (item, key, owner) {\n        var done = false;\n        var success = false;\n        for (var i = 0, length_4 = this._testers.length; i < length_4; i++) {\n            var test = this._testers[i];\n            if (test(item)) {\n                done = true;\n                success = true;\n                break;\n            }\n        }\n        this.keep = success;\n        this.done = done;\n    };\n    return $In;\n}(BaseOperation));\nvar $Nin = /** @class */ (function (_super) {\n    __extends($Nin, _super);\n    function $Nin(params, ownerQuery, options, name) {\n        var _this = _super.call(this, params, ownerQuery, options, name) || this;\n        _this.propop = true;\n        _this._in = new $In(params, ownerQuery, options, name);\n        return _this;\n    }\n    $Nin.prototype.next = function (item, key, owner, root) {\n        this._in.next(item, key, owner);\n        if (isArray(owner) && !root) {\n            if (this._in.keep) {\n                this.keep = false;\n                this.done = true;\n            }\n            else if (key == owner.length - 1) {\n                this.keep = true;\n                this.done = true;\n            }\n        }\n        else {\n            this.keep = !this._in.keep;\n            this.done = true;\n        }\n    };\n    $Nin.prototype.reset = function () {\n        _super.prototype.reset.call(this);\n        this._in.reset();\n    };\n    return $Nin;\n}(BaseOperation));\nvar $Exists = /** @class */ (function (_super) {\n    __extends($Exists, _super);\n    function $Exists() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.propop = true;\n        return _this;\n    }\n    $Exists.prototype.next = function (item, key, owner) {\n        if (owner.hasOwnProperty(key) === this.params) {\n            this.done = true;\n            this.keep = true;\n        }\n    };\n    return $Exists;\n}(BaseOperation));\nvar $And = /** @class */ (function (_super) {\n    __extends($And, _super);\n    function $And(params, owneryQuery, options, name) {\n        var _this = _super.call(this, params, owneryQuery, options, params.map(function (query) { return createQueryOperation(query, owneryQuery, options); }), name) || this;\n        _this.propop = false;\n        assertGroupNotEmpty(params);\n        return _this;\n    }\n    $And.prototype.next = function (item, key, owner, root) {\n        this.childrenNext(item, key, owner, root);\n    };\n    return $And;\n}(NamedGroupOperation));\nvar $All = /** @class */ (function (_super) {\n    __extends($All, _super);\n    function $All(params, owneryQuery, options, name) {\n        var _this = _super.call(this, params, owneryQuery, options, params.map(function (query) { return createQueryOperation(query, owneryQuery, options); }), name) || this;\n        _this.propop = true;\n        return _this;\n    }\n    $All.prototype.next = function (item, key, owner, root) {\n        this.childrenNext(item, key, owner, root);\n    };\n    return $All;\n}(NamedGroupOperation));\nvar $eq = function (params, owneryQuery, options) {\n    return new EqualsOperation(params, owneryQuery, options);\n};\nvar $ne = function (params, owneryQuery, options, name) { return new $Ne(params, owneryQuery, options, name); };\nvar $or = function (params, owneryQuery, options, name) { return new $Or(params, owneryQuery, options, name); };\nvar $nor = function (params, owneryQuery, options, name) { return new $Nor(params, owneryQuery, options, name); };\nvar $elemMatch = function (params, owneryQuery, options, name) { return new $ElemMatch(params, owneryQuery, options, name); };\nvar $nin = function (params, owneryQuery, options, name) { return new $Nin(params, owneryQuery, options, name); };\nvar $in = function (params, owneryQuery, options, name) {\n    return new $In(params, owneryQuery, options, name);\n};\nvar $lt = numericalOperation(function (params) { return function (b) {\n    return b != null && b < params;\n}; });\nvar $lte = numericalOperation(function (params) { return function (b) {\n    return b === params || b <= params;\n}; });\nvar $gt = numericalOperation(function (params) { return function (b) {\n    return b != null && b > params;\n}; });\nvar $gte = numericalOperation(function (params) { return function (b) {\n    return b === params || b >= params;\n}; });\nvar $mod = function (_a, owneryQuery, options) {\n    var mod = _a[0], equalsValue = _a[1];\n    return new EqualsOperation(function (b) { return comparable(b) % mod === equalsValue; }, owneryQuery, options);\n};\nvar $exists = function (params, owneryQuery, options, name) { return new $Exists(params, owneryQuery, options, name); };\nvar $regex = function (pattern, owneryQuery, options) {\n    return new EqualsOperation(new RegExp(pattern, owneryQuery.$options), owneryQuery, options);\n};\nvar $not = function (params, owneryQuery, options, name) { return new $Not(params, owneryQuery, options, name); };\nvar typeAliases = {\n    number: function (v) { return typeof v === \"number\"; },\n    string: function (v) { return typeof v === \"string\"; },\n    bool: function (v) { return typeof v === \"boolean\"; },\n    array: function (v) { return Array.isArray(v); },\n    null: function (v) { return v === null; },\n    timestamp: function (v) { return v instanceof Date; }\n};\nvar $type = function (clazz, owneryQuery, options) {\n    return new EqualsOperation(function (b) {\n        if (typeof clazz === \"string\") {\n            if (!typeAliases[clazz]) {\n                throw new Error(\"Type alias does not exist\");\n            }\n            return typeAliases[clazz](b);\n        }\n        return b != null ? b instanceof clazz || b.constructor === clazz : false;\n    }, owneryQuery, options);\n};\nvar $and = function (params, ownerQuery, options, name) { return new $And(params, ownerQuery, options, name); };\nvar $all = function (params, ownerQuery, options, name) { return new $All(params, ownerQuery, options, name); };\nvar $size = function (params, ownerQuery, options) { return new $Size(params, ownerQuery, options, \"$size\"); };\nvar $options = function () { return null; };\nvar $where = function (params, ownerQuery, options) {\n    var test;\n    if (isFunction(params)) {\n        test = params;\n    }\n    else if (!process.env.CSP_ENABLED) {\n        test = new Function(\"obj\", \"return \" + params);\n    }\n    else {\n        throw new Error(\"In CSP mode, sift does not support strings in \\\"$where\\\" condition\");\n    }\n    return new EqualsOperation(function (b) { return test.bind(b)(b); }, ownerQuery, options);\n};\n\nvar defaultOperations = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    $Size: $Size,\n    $eq: $eq,\n    $ne: $ne,\n    $or: $or,\n    $nor: $nor,\n    $elemMatch: $elemMatch,\n    $nin: $nin,\n    $in: $in,\n    $lt: $lt,\n    $lte: $lte,\n    $gt: $gt,\n    $gte: $gte,\n    $mod: $mod,\n    $exists: $exists,\n    $regex: $regex,\n    $not: $not,\n    $type: $type,\n    $and: $and,\n    $all: $all,\n    $size: $size,\n    $options: $options,\n    $where: $where\n});\n\nvar createDefaultQueryOperation = function (query, ownerQuery, _a) {\n    var _b = _a === void 0 ? {} : _a, compare = _b.compare, operations = _b.operations;\n    return createQueryOperation(query, ownerQuery, {\n        compare: compare,\n        operations: Object.assign({}, defaultOperations, operations || {})\n    });\n};\nvar createDefaultQueryTester = function (query, options) {\n    if (options === void 0) { options = {}; }\n    var op = createDefaultQueryOperation(query, null, options);\n    return createOperationTester(op);\n};\n\nexport { $Size, $all, $and, $elemMatch, $eq, $exists, $gt, $gte, $in, $lt, $lte, $mod, $ne, $nin, $nor, $not, $options, $or, $regex, $size, $type, $where, EqualsOperation, createDefaultQueryOperation, createEqualsOperation, createOperationTester, createQueryOperation, createQueryTester, createDefaultQueryTester as default };\n//# sourceMappingURL=index.js.map\n","import { createEqualsOperation } from 'sift'\n\n// Simulate SQL's case-sensitive LIKE.\n// A combination of answers from https://stackoverflow.com/questions/1314045/emulating-sql-like-in-javascript\nexport function like(value: string, search: string, regexOptions = 'g') {\n  const specials = ['/', '.', '*', '+', '?', '|', '(', ')', '[', ']', '{', '}', '\\\\']\n  // Remove specials\n  search = search.replace(new RegExp(`(\\\\${specials.join('|\\\\')})`, regexOptions), '\\\\$1')\n  // Replace % and _ with equivalent regex\n  search = search.replace(/%/g, '.*').replace(/_/g, '.')\n  // Check matches\n  return RegExp(`^${search}$`, regexOptions).test(value)\n}\n\n// Simulate PostgreSQL's case-insensitive ILIKE\nexport function iLike(str: string, search: string) {\n  return like(str, search, 'ig')\n}\n\nexport const $like = (params: any, ownerQuery: any, options: any) => {\n  return createEqualsOperation((value: any) => like(value, params), ownerQuery, options)\n}\n\nexport const $notLike = (params: any, ownerQuery: any, options: any) => {\n  return createEqualsOperation((value: any) => !like(value, params), ownerQuery, options)\n}\n\nexport const $ilike = (params: any, ownerQuery: any, options: any) => {\n  return createEqualsOperation((value: any) => iLike(value, params), ownerQuery, options)\n}\n\nconst $notILike = (params: any, ownerQuery: any, options: any) => {\n  return createEqualsOperation((value: any) => !iLike(value, params), ownerQuery, options)\n}\n\nexport const sqlOperations = {\n  $like,\n  $notLike,\n  $notlike: $notLike,\n  $ilike,\n  $iLike: $ilike,\n  $notILike,\n}\n","import { MaybeRef } from '@vueuse/core'\nimport type { Id } from '@feathersjs/feathers'\nimport { _ } from '@feathersjs/commons'\nimport { computed, unref } from 'vue-demi'\nimport { filterQuery, select, sorter } from '@feathersjs/adapter-commons'\nimport sift from 'sift'\nimport fastCopy from 'fast-copy'\nimport type { AnyData, Params } from '../types'\nimport { deepUnref, getArray } from '../utils'\nimport { sqlOperations } from './utils-custom-operators'\nimport type { StorageMapUtils } from './storage'\n\ninterface UseServiceLocalOptions<M extends AnyData> {\n  idField: string\n  itemStorage: StorageMapUtils<M>\n  tempStorage?: StorageMapUtils<M>\n  cloneStorage?: StorageMapUtils<M>\n  addItemToStorage: any\n  whitelist?: string[]\n  paramsForServer?: string[]\n  customSiftOperators?: Record<string, any>\n}\n\nconst FILTERS = ['$sort', '$limit', '$skip', '$select']\nconst additionalOperators = [\n  '$in',\n  '$nin',\n  '$exists',\n  'eq',\n  'ne',\n  '$mod',\n  '$all',\n  '$not',\n  '$size',\n  '$type',\n  '$regex',\n  '$options',\n  '$where',\n  '$elemMatch',\n]\n\nexport function useServiceLocal<M extends AnyData, Q extends AnyData>(options: UseServiceLocalOptions<M>) {\n  const {\n    idField,\n    itemStorage,\n    tempStorage,\n    cloneStorage,\n    addItemToStorage,\n    paramsForServer = [],\n    whitelist = [],\n    customSiftOperators = {},\n  } = options\n\n  const operations = Object.assign({}, sqlOperations, customSiftOperators)\n\n  /** @private */\n  const _filterQueryOperators = computed(() => {\n    return additionalOperators.concat(whitelist || []).concat(Object.keys(operations))\n  })\n\n  const filterItems = (params: Params<Q>, startingValues: M[] = []) => {\n    params = { ...unref(params) } || {}\n    const _paramsForServer = paramsForServer\n    const q = _.omit(params.query || {}, ..._paramsForServer)\n\n    const { query, filters } = filterQuery(q, {\n      operators: _filterQueryOperators.value,\n    })\n    let values = startingValues.concat(itemStorage.list.value)\n\n    if (tempStorage && params.temps) values.push(...tempStorage.list.value)\n\n    if (filters.$or) query.$or = filters.$or\n\n    if (filters.$and) query.$and = filters.$and\n\n    values = values.filter(sift(query, { operations }))\n    return { values, filters }\n  }\n\n  function findInStore(_params: MaybeRef<Params<Q>>) {\n    const result = computed(() => {\n      const params = unref(_params)\n      // clean up any nested refs\n      if (params.query) params.query = deepUnref(params.query)\n\n      const filtered = filterItems(params)\n      const filters = filtered.filters\n      let values = filtered.values\n\n      const total = values.length\n\n      if (filters.$sort) values.sort(sorter(filters.$sort))\n\n      if (filters.$skip) values = values.slice(filters.$skip)\n\n      if (typeof filters.$limit !== 'undefined') values = values.slice(0, filters.$limit)\n\n      return {\n        total,\n        limit: filters.$limit || 0,\n        skip: filters.$skip || 0,\n        data: params.clones\n          ? values.map((v: any) => (v.clone ? v.clone(undefined, { useExisting: true }) : v))\n          : values,\n      }\n    })\n    return {\n      total: computed(() => result.value.total),\n      limit: computed(() => result.value.limit),\n      skip: computed(() => result.value.skip),\n      data: computed(() => result.value.data),\n    }\n  }\n\n  function findOneInStore(params: MaybeRef<Params<Q>>) {\n    const result = findInStore(params)\n    const item = computed(() => {\n      return result.data.value[0] || null\n    })\n    return item\n  }\n\n  function countInStore(params: MaybeRef<Params<Q>>) {\n    const value = computed(() => {\n      params = { ...unref(params) }\n\n      if (!params.query) throw new Error('params must contain a query object')\n\n      params.query = _.omit(params.query, ...FILTERS)\n      return findInStore(params).total.value\n    })\n    return value\n  }\n\n  const getFromStore = (id: MaybeRef<Id | null>, params?: Params<Q>) => {\n    return computed((): M | null => {\n      id = unref(id)\n      params = fastCopy(unref(params) || {})\n      if (params.query) params.query = deepUnref(params.query)\n\n      let item = null\n      const existingItem = itemStorage.getItem(id as Id) && select(params, idField)(itemStorage.getItem(id as Id))\n      const tempItem =\n        tempStorage && tempStorage.getItem(id as Id) && select(params, '__tempId')(tempStorage.getItem(id as Id))\n\n      if (existingItem) item = existingItem\n      else if (tempItem) item = tempItem\n\n      const toReturn = params.clones && item.clone ? item.clone(undefined, { useExisting: true }) : item || null\n      return toReturn\n    })\n  }\n\n  /**\n   * Write records to the store.\n   * @param data a single record or array of records.\n   * @returns data added or modified in the store. If you pass an array, you get an array back.\n   */\n  function createInStore<N = MaybeRef<M | M[]>>(data: N): N {\n    const { items, isArray } = getArray(unref(data))\n\n    const _items = items.map((item: N) => {\n      const stored = addItemToStorage(unref(item))\n      return stored\n    })\n\n    return isArray ? _items : _items[0]\n  }\n\n  // TODO\n  function patchInStore(\n    _idOrData: MaybeRef<M | M[] | Id | null>,\n    _data: MaybeRef<AnyData> = {},\n    _params: MaybeRef<Params<Q>> = {},\n  ) {\n    const idOrData = unref(_idOrData)\n    const data = unref(_data)\n    const params = unref(_params)\n\n    // patches provided items using the `data` from the closure scope.\n    function updateItems(items: any[]) {\n      const patched = items\n        .map((item: M | Id | null) => {\n          item = unref(item)\n          // convert ids to items from the store\n          if (typeof item === 'number' || typeof item === 'string') {\n            item = getFromStore(item as Id).value\n          }\n          if (item == null) return null\n\n          const toWrite = { ...item, ...data }\n          const stored = addItemToStorage(toWrite)\n          return stored\n        })\n        .filter((i) => i)\n      return patched\n    }\n\n    if (idOrData === null) {\n      // patching multiple cannot use an empty array\n      if (params?.query && !Object.keys(params?.query).length) {\n        throw new Error(\n          `cannot perform multiple patchInStore with an empty query. You must explicitly provide a query. To patch all items, try using a query that matches all items, like \"{ id: { $exists: true } }\"`,\n        )\n      }\n      // patch by query\n      const fromStore = findInStore(params).data.value\n      const items = updateItems(fromStore)\n\n      return items\n    } else {\n      // patch provided data\n      const { items, isArray } = getArray(idOrData)\n      const patchedItems = updateItems(items)\n\n      return isArray ? patchedItems : patchedItems[0]\n    }\n  }\n\n  /**\n   * If a clone is provided, it removes the clone from the store.\n   * If a temp is provided, it removes the temp from the store.\n   * If an item is provided, the item and its associated temp and clone are removed.\n   * If a string is provided, it removes any item, temp, or clone from the stores.\n   * @param data\n   */\n  function removeFromStore(data: M | M[] | null, params?: Params<Q>) {\n    if (data === null && params?.query && Object.keys(params?.query).length) {\n      const clones = cloneStorage ? cloneStorage.list.value : []\n      const { values } = filterItems(params, clones)\n      const result = removeItems(values)\n      return result\n    } else if (data !== null) {\n      removeItems(data)\n    }\n\n    return data\n  }\n\n  function removeItems(data: M | M[]) {\n    const { items } = getArray(data)\n    items.forEach((item: M) => {\n      if (typeof item === 'string') {\n        itemStorage.removeItem(item)\n        tempStorage?.removeItem(item)\n        cloneStorage?.removeItem(item)\n      } else {\n        if ((item as M).__isClone) return cloneStorage?.remove(item as M)\n\n        if ((item as M).__isTemp) return tempStorage?.remove(item as M)\n\n        itemStorage.remove(item)\n        tempStorage?.remove(item)\n        cloneStorage?.remove(item)\n      }\n    })\n    return data\n  }\n\n  return {\n    findInStore,\n    findOneInStore,\n    countInStore,\n    getFromStore,\n    createInStore,\n    patchInStore,\n    removeFromStore,\n  }\n}\n","import type { Id } from '@feathersjs/feathers'\nimport type { ById, AnyData } from '../types'\nimport type { AssignFn, beforeWriteFn, onReadFn } from './types'\nimport { computed, reactive, del as vueDel, set as vueSet } from 'vue-demi'\n\ninterface UseServiceStorageOptions<M extends AnyData> {\n  getId: (item: M) => string\n  onRead?: onReadFn<M>\n  beforeWrite?: beforeWriteFn<M>\n  assign?: AssignFn<M>\n}\n\nexport type StorageMapUtils<M extends AnyData> = ReturnType<typeof useServiceStorage<M>>\n\n/**\n * General storage adapter\n */\nexport const useServiceStorage = <M extends AnyData>({\n  getId,\n  onRead = (item) => item,\n  beforeWrite = (item) => item,\n  assign = (dest, src) => Object.assign(dest, src),\n}: UseServiceStorageOptions<M>) => {\n  const byId: ById<M> = reactive({})\n\n  const list = computed(() => {\n    return Object.values(byId)\n  })\n\n  const ids = computed(() => {\n    return Object.keys(byId)\n  })\n\n  /**\n   * Checks if the provided `item` is stored.\n   * @param item\n   * @returns boolean\n   */\n  const has = (item: M) => {\n    const id = getId(item)\n    return hasItem(id as Id)\n  }\n\n  /**\n   * Checks if an item with the provided `id` is stored.\n   * @param id\n   * @returns\n   */\n  const hasItem = (id: Id) => {\n    return !!byId[id]\n  }\n\n  /**\n   * If the item is stored, merges the `item` into the stored version.\n   * If not yet stored, the item is stored.\n   * @param item the item to merge or write to the store.\n   * @returns the stored item\n   */\n  const merge = (item: M) => {\n    const id = getId(item) as Id\n    const existing = getItem(id)\n    if (existing) assign(existing, item)\n    else setItem(id, item)\n\n    return getItem(id)\n  }\n\n  /**\n   * Retrieves the stored record that matches the provided `item`.\n   * @param item\n   * @returns\n   */\n  const get = (item: M) => {\n    const id = getId(item) as Id\n    return getItem(id)\n  }\n\n  /**\n   * Retrives the stored record that matches the provided `id`.\n   * @param id\n   * @returns\n   */\n  const getItem = (id: Id) => {\n    const inStore = byId[id]\n    const _item = inStore ? onRead(inStore) : null\n    return _item as M\n  }\n\n  /**\n   * Writes the provided item to the store\n   * @param item item to store\n   * @returns\n   */\n  const set = (item: M) => {\n    const id = getId(item) as Id\n    return setItem(id, item)\n  }\n\n  const setItem = (id: Id, item: M) => {\n    if (id == null) throw new Error('item has no id')\n    vueSet(byId, id, beforeWrite(item))\n    return getItem(id)\n  }\n\n  /**\n   * remove `item` if found\n   * @param item\n   * @returns boolean indicating if item was removed\n   */\n  const remove = (item: M) => {\n    const id = getId(item) as Id\n    return removeItem(id)\n  }\n\n  /**\n   * Remove item with matching `id`, if found.\n   * @param id\n   * @returns boolean indicating if an item was removed\n   */\n  const removeItem = (id: Id) => {\n    const hadItem = hasItem(id)\n    if (hadItem) vueDel(byId, id)\n\n    return hadItem\n  }\n\n  const getKeys = () => {\n    return ids.value\n  }\n\n  /**\n   * empties the store\n   */\n  const clear = () => {\n    Object.keys(byId).forEach((id) => {\n      vueDel(byId, id)\n    })\n  }\n\n  return { byId, list, ids, getId, clear, has, hasItem, get, getItem, set, setItem, remove, removeItem, getKeys, merge }\n}\n","import type { AnyData } from '../types'\nimport type { beforeWriteFn, onReadFn } from './types'\nimport type { StorageMapUtils } from './storage'\nimport { useServiceStorage } from './storage'\n\ninterface UseServiceTempsOptions<M extends AnyData> {\n  getId: (item: M) => string\n  itemStorage: StorageMapUtils<M>\n  onRead?: onReadFn<M>\n  beforeWrite?: beforeWriteFn<M>\n}\n\nexport const useServiceTemps = <M extends AnyData>(options: UseServiceTempsOptions<M>) => {\n  const { getId, itemStorage, onRead, beforeWrite } = options\n\n  const tempStorage = useServiceStorage<M>({\n    getId,\n    onRead,\n    beforeWrite,\n  })\n\n  function moveTempToItems(data: M) {\n    if (tempStorage.has(data)) tempStorage.remove(data)\n\n    return itemStorage.set(data)\n  }\n\n  return { tempStorage, moveTempToItems }\n}\n","import type { AnyData, MakeCopyOptions } from '../types'\nimport type { CloneOptions, beforeWriteFn, onReadFn } from './types'\nimport type { StorageMapUtils } from './storage'\nimport { useServiceStorage } from './storage'\nimport { del as vueDelete } from 'vue-demi'\nimport fastCopy from 'fast-copy'\n\nexport interface UseServiceClonesOptions<M extends AnyData> {\n  itemStorage: StorageMapUtils<M>\n  tempStorage: StorageMapUtils<M>\n  onRead?: onReadFn<M>\n  beforeWrite?: beforeWriteFn<M>\n  makeCopy?: (item: M, data: AnyData, { isClone }: MakeCopyOptions) => M\n}\n\nexport const useServiceClones = <M extends AnyData>(options: UseServiceClonesOptions<M>) => {\n  const { itemStorage, tempStorage, onRead, beforeWrite } = options\n  const defaultMakeCopy = (item: M, data: AnyData = {}, { isClone }: MakeCopyOptions) => {\n    return fastCopy(Object.assign({}, item, data, { __isClone: isClone }))\n  }\n  const makeCopy = options.makeCopy || defaultMakeCopy\n\n  const cloneStorage = useServiceStorage({\n    getId: (item) => {\n      const id = itemStorage.getId(item as M)\n      return id != null ? id : tempStorage.getId(item)\n    },\n    onRead,\n    beforeWrite,\n  })\n\n  /**\n   * Makes sure the provided item is stored in itemStorage or tempStorage.\n   * Private\n   */\n  function assureOriginalIsStored(item: M): M {\n    // Make sure the stored version is always up to date with the latest instance data. (the instance used to call instance.clone)\n    if (!item.__isClone) {\n      if (itemStorage.has(item)) itemStorage.merge(item)\n      else if (tempStorage.has(item)) tempStorage.merge(item)\n    }\n    const existingItem = itemStorage.get(item) || tempStorage.get(item)\n    if (!existingItem) {\n      if (itemStorage.getId(item) != null) itemStorage.merge(item)\n      else if (tempStorage.getId(item) != null) tempStorage.merge(item)\n    }\n    return itemStorage.get(item) || tempStorage.get(item)\n  }\n\n  /**\n   * Fast-copies the provided `item`, placing it in `cloneStorage`.\n   * @param item the object to clone.\n   * @param data an object to be merged before storing in cloneStorage.\n   * @param options.useExisting {Boolean} allows using the existing clone instead of re-cloning.\n   * @returns\n   */\n  function clone(item: M, data = {}, options: CloneOptions = {}): M {\n    const existingClone = cloneStorage.get(item)\n\n    assureOriginalIsStored(item)\n\n    if (existingClone && options.useExisting) {\n      return existingClone as M\n    } else {\n      const clone = reset(item, data)\n      return clone as M\n    }\n  }\n\n  /**\n   * If the `item` has an id, it's merged or written to the itemStore.\n   * If the `item` does not have an id, it's merged or written to the tempStore.\n   * @param item\n   * @param data\n   * @returns stored item or stored temp\n   */\n  function commit(item: M, data: Partial<M> = {}) {\n    const itemId = itemStorage.getId(item)\n    const _item = makeCopy(item, data, { isClone: false })\n    // copyAssociations(clone, newOriginal, clone.getModel().associations)\n    if (itemId) {\n      itemStorage.merge(_item)\n      return itemStorage.get(_item)\n    } else {\n      tempStorage.merge(_item)\n      return tempStorage.get(_item)\n    }\n  }\n\n  /**\n   * If a clone exists, resets the clone to match the item or temp\n   * If a clone does not exist, writes the item as the clone.\n   * @param item\n   * @param data\n   * @returns\n   */\n  function reset(item: M, data = {}): M {\n    const original = assureOriginalIsStored(item)\n    const existingClone = cloneStorage.get(item)\n\n    if (existingClone) {\n      const copied = makeCopy(original, data, { isClone: true })\n      Object.keys(original).forEach((key) => {\n        if (original[key] == null) vueDelete(copied, key)\n      })\n      cloneStorage.merge(copied)\n    } else {\n      const copied = makeCopy(item, data, { isClone: true })\n      cloneStorage.set(copied)\n    }\n    return cloneStorage.get(item)\n  }\n\n  function markAsClone(item: M) {\n    Object.defineProperty(item, '__isClone', {\n      writable: false,\n      enumerable: false,\n      value: true,\n    })\n    return item\n  }\n\n  return {\n    cloneStorage,\n    clone,\n    commit,\n    reset,\n    markAsClone,\n  }\n}\n","import type { AnyData, MakeCopyOptions } from '../types'\nimport fastCopy from 'fast-copy'\nimport { defineValues } from '../utils'\nimport { useServiceTemps } from './temps'\nimport { useServiceClones } from './clones'\nimport { useServiceStorage } from './storage'\n\ninterface UseAllStorageOptions {\n  getIdField: (val: AnyData) => any\n  setupInstance: any\n}\n\nexport const useAllStorageTypes = <M extends AnyData>(options: UseAllStorageOptions) => {\n  const { getIdField, setupInstance } = options\n\n  /**\n   * Makes a copy of the Model instance with __isClone properly set\n   * Private\n   */\n  const makeCopy = (item: M, data: AnyData = {}, { isClone }: MakeCopyOptions) => {\n    const copied = fastCopy(item)\n    Object.assign(copied, data)\n    // instance.__isTemp\n    Object.defineProperty(copied, '__isTemp', {\n      configurable: true,\n      enumerable: false,\n      get() {\n        return this[this.__idField] == null\n      },\n    })\n    const withExtras = defineValues(copied, {\n      __isClone: isClone,\n      __tempId: item.__tempId,\n    })\n    return withExtras\n  }\n\n  // item storage\n  const itemStorage = useServiceStorage<M>({\n    getId: getIdField,\n    beforeWrite: setupInstance,\n    onRead: setupInstance,\n  })\n\n  // temp item storage\n  const { tempStorage, moveTempToItems } = useServiceTemps<M>({\n    getId: (item) => item.__tempId,\n    itemStorage,\n    beforeWrite: setupInstance,\n    onRead: setupInstance,\n  })\n\n  // clones\n  const { cloneStorage, clone, commit, reset, markAsClone } = useServiceClones<M>({\n    itemStorage,\n    tempStorage,\n    makeCopy,\n    beforeWrite: (item) => {\n      markAsClone(item)\n      return setupInstance(item)\n    },\n    onRead: setupInstance,\n  })\n\n  /**\n   * Stores the provided item in the correct storage (itemStorage, tempStorage, or cloneStorage).\n   * If an item has both an id and a tempId, it gets moved from tempStorage to itemStorage.\n   * Private\n   */\n  const addItemToStorage = (item: M) => {\n    const id = getIdField(item)\n    item = setupInstance(item)\n\n    if (item.__isClone) return cloneStorage.merge(item)\n    else if (id != null && item.__tempId != null) return moveTempToItems(item)\n    else if (id != null) return itemStorage.merge(item)\n    else if (tempStorage && item.__tempId != null) return tempStorage?.merge(item)\n\n    return itemStorage.merge(item)\n  }\n\n  return {\n    itemStorage,\n    tempStorage,\n    cloneStorage,\n    clone,\n    commit,\n    reset,\n    addItemToStorage,\n  }\n}\n","/*!\n * isomorphic-mongo-objectid - v@version@\n * Pure JavaScript implementation of mongodb ObjectId for the browser and server\n * https://github.com/john-doherty/isomorphic-mongo-objectid\n * @author John Doherty <www.johndoherty.info>\n * @license MIT\n */\n(function () {\n\n    'use strict';\n\n    /*\n     * Refactored version of source by Jonathan Hberle (jonathan.haeberle@gmail.com)\n     * https://github.com/dreampulse/ObjectId.js\n     */\n\n    var _increment = 0;\n    var _pid = Math.floor(Math.random() * (32767));\n    var _machine = Math.floor(Math.random() * (16777216));\n\n    if (typeof window !== 'undefined') {\n\n        var storage = window.localStorage;\n\n        var mongoMachineId = parseInt(storage.mongoMachineId, 10);\n\n        if (mongoMachineId >= 0 && mongoMachineId <= 16777215) {\n            _machine = Math.floor(storage.mongoMachineId);\n        }\n\n        storage.mongoMachineId = _machine;\n    }\n\n    /**\n     * Creates a new mongo db style ObjectID\n     * @returns {ObjectID} instance of ObjectID\n     */\n    function ObjectID() {\n\n        var args = arguments;\n\n        if (!(this instanceof ObjectID)) {\n            if (args.length > 0) {\n                return new ObjectID(args[0], args[1], args[2], args[3]);\n            }\n            else {\n                return new ObjectID();\n            }\n        }\n\n        if (typeof args[0] === 'object') {\n            this.timestamp = args[0].timestamp;\n            this.machine = args[0].machine;\n            this.pid = args[0].pid;\n            this.increment = args[0].increment;\n        }\n        else if (typeof args[0] === 'string' && args[0].length === 24) {\n            this.timestamp = Number('0x' + args[0].substr(0, 8));\n            this.machine = Number('0x' + args[0].substr(8, 6));\n            this.pid = Number('0x' + args[0].substr(14, 4));\n            this.increment = Number('0x' + args[0].substr(18, 6));\n        }\n        else if (args.length === 4 && args[0] !== null) {\n            this.timestamp = args[0];\n            this.machine = args[1];\n            this.pid = args[2];\n            this.increment = args[3];\n        }\n        else {\n            this.timestamp = Math.floor(new Date().valueOf() / 1000);\n            this.machine = _machine;\n            this.pid = _pid;\n            this.increment = _increment++;\n            if (_increment > 0xffffff) {\n                _increment = 0;\n            }\n        }\n    }\n\n    ObjectID.prototype.getDate = function () {\n        return new Date(this.timestamp * 1000);\n    };\n\n    ObjectID.prototype.toArray = function () {\n        var strOid = this.toString();\n        var array = [];\n        var i;\n        for (i = 0; i < 12; i++) {\n            array[i] = parseInt(strOid.slice(i * 2, i * 2 + 2), 16);\n        }\n        return array;\n    };\n\n    ObjectID.prototype.toString = function () {\n\n        var timestamp = this.timestamp.toString(16);\n        var machine = this.machine.toString(16);\n        var pid = this.pid.toString(16);\n        var increment = this.increment.toString(16);\n\n        return [\n            '00000000'.substr(0, 8 - timestamp.length) + timestamp,\n            '000000'.substr(0, 6 - machine.length) + machine,\n            '0000'.substr(0, 4 - pid.length) + pid,\n            '000000'.substr(0, 6 - increment.length) + increment\n        ].join('');\n    };\n\n    if (typeof module !== 'undefined') {\n        module.exports = ObjectID;\n    }\n    else {\n        window.ObjectID = ObjectID;\n    }\n\n})();\n","module.exports = require('./src/isomorphic-mongo-objectid.js');\n","import type { CloneOptions } from '../stores'\nimport type { AnyData, ById, Params } from '../types'\nimport type { BaseModelData, StoreInstanceProps, ModelInstanceData } from './types'\nimport ObjectID from 'isomorphic-mongo-objectid'\nimport { defineValues } from '../utils/define-properties'\n\ninterface UseModelInstanceOptions<M, Q extends AnyData> {\n  idField: string\n  clonesById: ById<AnyData>\n  clone: (item: M, data?: {}, options?: CloneOptions) => M\n  commit: (item: M, data?: Partial<M>) => M\n  reset: (item: M, data?: {}) => M\n  createInStore: (data: M | M[]) => M | M[]\n  removeFromStore: (data: M | M[] | null, params?: Params<Q>) => M | M[] | null\n}\n\nexport const useModelInstance = <M extends AnyData, Q extends AnyData>(\n  data: ModelInstanceData<M>,\n  options: UseModelInstanceOptions<M, Q>,\n) => {\n  if (data.__isStoreInstance) return data\n\n  const { idField, clonesById, clone, commit, reset, createInStore, removeFromStore } = options\n  const __isClone = data.__isClone || false\n\n  // instance.__isTemp\n  Object.defineProperty(data, '__isTemp', {\n    configurable: true,\n    enumerable: false,\n    get() {\n      return this[this.__idField] == null\n    },\n  })\n\n  // BaseModel properties\n  const asBaseModel = defineValues(data, {\n    __isStoreInstance: true,\n    __isClone,\n    __idField: idField,\n    __tempId: data[idField] == null && data.__tempId == null ? new ObjectID().toString() : data.__tempId || undefined,\n    hasClone(this: M) {\n      const id = this[this.__idField] || this.__tempId\n      const item = clonesById[id]\n      return item || null\n    },\n    clone(this: M, data: Partial<M> = {}, options: CloneOptions = {}) {\n      const item = clone(this, data, options)\n      return item\n    },\n    commit(this: M, data: Partial<M> = {}) {\n      const item = commit(this, data)\n      return item\n    },\n    reset(this: M, data: Partial<M> = {}) {\n      const item = reset(this, data)\n      return item\n    },\n    createInStore(this: M) {\n      const item = createInStore(this)\n      return item\n    },\n    removeFromStore(this: M) {\n      const item = removeFromStore(this)\n      return item\n    },\n  }) as M & BaseModelData & StoreInstanceProps<M>\n\n  return asBaseModel\n}\n","import type { Query } from '@feathersjs/feathers'\n\nimport { computed, unref } from 'vue-demi'\nimport type { AnyData } from '../types'\nimport { MaybeRef } from '@vueuse/core'\nimport { useServiceLocal } from './local-queries'\n\nimport { useAllStorageTypes } from './all-storage-types'\nimport { useModelInstance } from '../modeling/use-model-instance'\n\nexport interface UseDataStoreOptions {\n  idField: string\n  ssr?: MaybeRef<boolean>\n  customSiftOperators?: Record<string, any>\n  setupInstance?: any\n}\n\nconst makeDefaultOptions = () => ({\n  skipGetIfExists: false,\n})\n\nexport const useDataStore = <M extends AnyData, Q extends Query>(_options: UseDataStoreOptions) => {\n  const options = Object.assign({}, makeDefaultOptions(), _options)\n  const { idField, customSiftOperators } = options\n\n  function setupInstance<N extends M>(this: any, data: N) {\n    const asBaseModel = useModelInstance(data, {\n      idField,\n      clonesById: cloneStorage.byId,\n      clone,\n      commit,\n      reset,\n      createInStore,\n      removeFromStore,\n    })\n\n    if (data.__isSetup) return asBaseModel\n    else {\n      const afterSetup = options.setupInstance ? options.setupInstance(asBaseModel) : asBaseModel\n      Object.defineProperty(afterSetup, '__isSetup', { value: true })\n      return afterSetup\n    }\n  }\n\n  // storage\n  const { itemStorage, tempStorage, cloneStorage, clone, commit, reset, addItemToStorage } = useAllStorageTypes<M>({\n    getIdField: (val: AnyData) => val[idField],\n    setupInstance,\n  })\n\n  const isSsr = computed(() => {\n    const ssr = unref(options.ssr)\n    return !!ssr\n  })\n\n  function clearAll() {\n    itemStorage.clear()\n    tempStorage.clear()\n    cloneStorage.clear()\n  }\n\n  // local data filtering\n  const { findInStore, findOneInStore, countInStore, getFromStore, createInStore, patchInStore, removeFromStore } =\n    useServiceLocal<M, Q>({\n      idField,\n      itemStorage,\n      tempStorage,\n      cloneStorage,\n      addItemToStorage,\n      customSiftOperators,\n    })\n\n  const store = {\n    new: setupInstance,\n    idField,\n    isSsr,\n\n    // items\n    itemsById: itemStorage.byId,\n    items: itemStorage.list,\n    itemIds: itemStorage.ids,\n\n    // temps\n    tempsById: tempStorage.byId,\n    temps: tempStorage.list,\n    tempIds: tempStorage.ids,\n\n    // clones\n    clonesById: cloneStorage.byId,\n    clones: cloneStorage.list,\n    cloneIds: cloneStorage.ids,\n    clone,\n    commit,\n    reset,\n\n    // local queries\n    findInStore,\n    findOneInStore,\n    countInStore,\n    createInStore,\n    getFromStore,\n    patchInStore,\n    removeFromStore,\n    clearAll,\n  }\n\n  return store\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createDebug = exports.setDebug = exports.noopDebug = void 0;\nconst debuggers = {};\nfunction noopDebug() {\n    return function () { };\n}\nexports.noopDebug = noopDebug;\nlet defaultInitializer = noopDebug;\nfunction setDebug(debug) {\n    defaultInitializer = debug;\n    Object.keys(debuggers).forEach((name) => {\n        debuggers[name] = debug(name);\n    });\n}\nexports.setDebug = setDebug;\nfunction createDebug(name) {\n    if (!debuggers[name]) {\n        debuggers[name] = defaultInitializer(name);\n    }\n    return (...args) => debuggers[name](...args);\n}\nexports.createDebug = createDebug;\n//# sourceMappingURL=debug.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createSymbol = exports.isPromise = exports._ = exports.stripSlashes = void 0;\n// Removes all leading and trailing slashes from a path\nfunction stripSlashes(name) {\n    return name.replace(/^(\\/+)|(\\/+)$/g, '');\n}\nexports.stripSlashes = stripSlashes;\n// A set of lodash-y utility functions that use ES6\nexports._ = {\n    each(obj, callback) {\n        if (obj && typeof obj.forEach === 'function') {\n            obj.forEach(callback);\n        }\n        else if (exports._.isObject(obj)) {\n            Object.keys(obj).forEach((key) => callback(obj[key], key));\n        }\n    },\n    some(value, callback) {\n        return Object.keys(value)\n            .map((key) => [value[key], key])\n            .some(([val, key]) => callback(val, key));\n    },\n    every(value, callback) {\n        return Object.keys(value)\n            .map((key) => [value[key], key])\n            .every(([val, key]) => callback(val, key));\n    },\n    keys(obj) {\n        return Object.keys(obj);\n    },\n    values(obj) {\n        return exports._.keys(obj).map((key) => obj[key]);\n    },\n    isMatch(obj, item) {\n        return exports._.keys(item).every((key) => obj[key] === item[key]);\n    },\n    isEmpty(obj) {\n        return exports._.keys(obj).length === 0;\n    },\n    isObject(item) {\n        return typeof item === 'object' && !Array.isArray(item) && item !== null;\n    },\n    isObjectOrArray(value) {\n        return typeof value === 'object' && value !== null;\n    },\n    extend(first, ...rest) {\n        return Object.assign(first, ...rest);\n    },\n    omit(obj, ...keys) {\n        const result = exports._.extend({}, obj);\n        keys.forEach((key) => delete result[key]);\n        return result;\n    },\n    pick(source, ...keys) {\n        return keys.reduce((result, key) => {\n            if (source[key] !== undefined) {\n                result[key] = source[key];\n            }\n            return result;\n        }, {});\n    },\n    // Recursively merge the source object into the target object\n    merge(target, source) {\n        if (exports._.isObject(target) && exports._.isObject(source)) {\n            Object.keys(source).forEach((key) => {\n                if (exports._.isObject(source[key])) {\n                    if (!target[key]) {\n                        Object.assign(target, { [key]: {} });\n                    }\n                    exports._.merge(target[key], source[key]);\n                }\n                else {\n                    Object.assign(target, { [key]: source[key] });\n                }\n            });\n        }\n        return target;\n    }\n};\n// Duck-checks if an object looks like a promise\nfunction isPromise(result) {\n    return exports._.isObject(result) && typeof result.then === 'function';\n}\nexports.isPromise = isPromise;\nfunction createSymbol(name) {\n    return typeof Symbol !== 'undefined' ? Symbol.for(name) : name;\n}\nexports.createSymbol = createSymbol;\n__exportStar(require(\"./debug\"), exports);\n//# sourceMappingURL=index.js.map","import type { ComputedRef, Ref } from 'vue-demi'\nimport type { PaginationState, UpdatePaginationForQueryOptions } from './types'\nimport { ref, set } from 'vue-demi'\nimport { deepUnref, getId, hasOwn } from '../utils'\nimport stringify from 'fast-json-stable-stringify'\nimport { _ } from '@feathersjs/commons/lib'\nimport { Params, Query, QueryInfo } from '../types'\n\nexport interface UseServicePagination {\n  idField: string\n  isSsr: ComputedRef<boolean>\n  defaultLimit?: number\n}\n\nexport const useServicePagination = (options: UseServicePagination) => {\n  const { idField, isSsr } = options\n  const defaultLimit = options.defaultLimit || 10\n\n  const pagination = ref({}) as Ref<PaginationState>\n\n  function clearPagination() {\n    const { defaultLimit, defaultSkip } = pagination.value\n    pagination.value = { defaultLimit, defaultSkip } as any\n  }\n\n  /**\n   * Stores pagination data on state.pagination based on the query identifier\n   * (qid) The qid must be manually assigned to `params.qid`\n   */\n  function updatePaginationForQuery({\n    qid,\n    response,\n    query = {},\n    preserveSsr = false,\n  }: UpdatePaginationForQueryOptions) {\n    const { data, total } = response\n    const ids = data.map((i: any) => getId(i, idField))\n    const queriedAt = new Date().getTime()\n    const { queryId, queryParams, pageId, pageParams } = getQueryInfo({ qid, query })\n\n    if (!pagination.value[qid]) set(pagination.value, qid, {})\n\n    if (!hasOwn(query, '$limit') && hasOwn(response, 'limit')) set(pagination.value, 'defaultLimit', response.limit)\n\n    if (!hasOwn(query, '$skip') && hasOwn(response, 'skip')) set(pagination.value, 'defaultSkip', response.skip)\n\n    const mostRecent = {\n      query,\n      queryId,\n      queryParams,\n      pageId,\n      pageParams,\n      queriedAt,\n      total,\n    }\n\n    const existingPageData = pagination.value[qid]?.[queryId]?.[pageId as string]\n\n    const qidData = pagination.value[qid] || {}\n    Object.assign(qidData, { mostRecent })\n\n    set(qidData, queryId, qidData[queryId] || {})\n    const queryData = {\n      total,\n      queryParams,\n    }\n\n    set(qidData, queryId, Object.assign({}, qidData[queryId], queryData))\n\n    const ssr = preserveSsr ? existingPageData?.ssr : isSsr.value\n\n    const pageData = {\n      [pageId as string]: { pageParams, ids, queriedAt, ssr: !!ssr },\n    }\n\n    Object.assign(qidData[queryId], pageData)\n\n    const newState = Object.assign({}, pagination.value[qid], qidData)\n\n    set(pagination.value, qid, newState)\n  }\n\n  function unflagSsr(params: Params<Query>) {\n    const queryInfo = getQueryInfo(params)\n    const { qid, queryId, pageId } = queryInfo\n\n    const pageData = pagination.value[qid]?.[queryId]?.[pageId as string]\n    pageData.ssr = false\n  }\n\n  function getQueryInfo(_params: Params<Query>): QueryInfo {\n    const params = deepUnref(_params)\n    const { query = {} } = params\n    const qid = params.qid || 'default'\n    const $limit = query?.$limit || defaultLimit\n    const $skip = query?.$skip || 0\n  \n    const pageParams = $limit !== undefined ? { $limit, $skip } : undefined\n    const pageId = pageParams ? stringify(pageParams) : undefined\n  \n    const queryParams = _.omit(query, '$limit', '$skip')\n    const queryId = stringify(queryParams)\n  \n    return {\n      qid,\n      query,\n      queryId,\n      queryParams,\n      pageParams,\n      pageId,\n      isExpired: false,\n    }\n  }\n\n  return {\n    pagination,\n    updatePaginationForQuery,\n    unflagSsr,\n    getQueryInfo,\n    clearPagination,\n  }\n}\n","import type { NullableId } from '@feathersjs/feathers'\nimport type { Ref } from 'vue-demi'\nimport type { RequestTypeById } from './types'\nimport { computed, del, ref, set } from 'vue-demi'\n\nconst defaultPending = () => ({\n  find: 0,\n  count: 0,\n  get: 0,\n  create: 0,\n  update: 0,\n  patch: 0,\n  remove: 0,\n})\n\nexport const useServicePending = () => {\n  const isPending = ref(defaultPending())\n\n  const createPendingById = ref({}) as Ref<Record<string | number | symbol, true>>\n  const updatePendingById = ref({}) as Ref<Record<string | number | symbol, true>>\n  const patchPendingById = ref({}) as Ref<Record<string | number | symbol, true>>\n  const removePendingById = ref({}) as Ref<Record<string | number | symbol, true>>\n\n  const isFindPending = computed(() => {\n    return isPending.value.find > 0\n  })\n\n  const isCountPending = computed(() => {\n    return isPending.value.count > 0\n  })\n\n  const isGetPending = computed(() => {\n    return isPending.value.get > 0\n  })\n\n  const isCreatePending = computed(() => {\n    return isPending.value.create > 0 || Object.keys(createPendingById.value).length > 0\n  })\n\n  const isUpdatePending = computed(() => {\n    return isPending.value.update > 0 || Object.keys(updatePendingById.value).length > 0\n  })\n\n  const isPatchPending = computed(() => {\n    return isPending.value.patch > 0 || Object.keys(patchPendingById.value).length > 0\n  })\n\n  const isRemovePending = computed(() => {\n    return isPending.value.remove > 0 || Object.keys(removePendingById.value).length > 0\n  })\n\n  function setPending(method: 'find' | 'count' | 'get' | 'create' | 'update' | 'patch' | 'remove', value: boolean) {\n    if (value) isPending.value[method]++\n    else isPending.value[method]--\n  }\n\n  function setPendingById(id: NullableId, method: RequestTypeById, val: boolean) {\n    if (id == null) return\n\n    let place\n\n    if (method === 'create') place = createPendingById.value\n    else if (method === 'update') place = updatePendingById.value\n    else if (method === 'patch') place = patchPendingById.value\n    else if (method === 'remove') place = removePendingById.value\n\n    if (val) set(place, id, true)\n    else del(place, id)\n  }\n\n  function unsetPendingById(...ids: NullableId[]) {\n    ids.forEach((id) => {\n      if (id == null) return\n      del(createPendingById.value, id)\n      del(updatePendingById.value, id)\n      del(patchPendingById.value, id)\n      del(removePendingById.value, id)\n    })\n  }\n\n  function clearAllPending() {\n    isPending.value = defaultPending()\n\n    createPendingById.value = {}\n    updatePendingById.value = {}\n    patchPendingById.value = {}\n    removePendingById.value = {}\n  }\n\n  return {\n    isPending,\n    createPendingById,\n    updatePendingById,\n    patchPendingById,\n    removePendingById,\n    isFindPending,\n    isCountPending,\n    isGetPending,\n    isCreatePending,\n    isUpdatePending,\n    isPatchPending,\n    isRemovePending,\n    setPending,\n    setPendingById,\n    unsetPendingById,\n    clearAllPending,\n  }\n}\n","import type { Id } from '@feathersjs/feathers'\nimport type { MaybeArray } from '../types'\nimport type { EventLocks, EventName } from './types'\nimport { del, reactive, set } from 'vue-demi'\nimport { getArray } from '../utils'\n\nexport const useServiceEventLocks = () => {\n  const eventLocks = reactive<EventLocks>({\n    created: {},\n    patched: {},\n    updated: {},\n    removed: {},\n  })\n\n  function toggleEventLock(data: MaybeArray<Id>, event: EventName) {\n    const { items: ids } = getArray(data)\n    ids.forEach((id) => {\n      const currentLock = eventLocks[event][id]\n      if (currentLock) {\n        clearEventLock(data, event)\n      } else {\n        set(eventLocks[event], id, true)\n        // auto-clear event lock after 250 ms\n        setTimeout(() => {\n          clearEventLock(data, event)\n        }, 250)\n      }\n    })\n  }\n  function clearEventLock(data: MaybeArray<Id>, event: EventName) {\n    const { items: ids } = getArray(data)\n    ids.forEach((id) => {\n      del(eventLocks[event], id)\n    })\n  }\n  return { eventLocks, toggleEventLock, clearEventLock }\n}\n","import type { Query } from '@feathersjs/feathers'\n\nimport { computed, unref } from 'vue-demi'\nimport type { AnyData } from '../types'\nimport { MaybeRef } from '@vueuse/core'\nimport { useServiceLocal } from './local-queries'\n\nimport { useServicePagination } from './pagination'\nimport { useServicePending } from './pending'\nimport { useServiceEventLocks } from './event-locks'\nimport { useAllStorageTypes } from './all-storage-types'\nimport { useModelInstance } from '../modeling/use-model-instance'\n\nexport interface UseServiceStoreOptions {\n  idField: string\n  defaultLimit?: number\n  whitelist?: string[]\n  paramsForServer?: string[]\n  skipGetIfExists?: boolean\n  ssr?: MaybeRef<boolean>\n  customSiftOperators?: Record<string, any>\n  setupInstance?: any\n}\n\nconst makeDefaultOptions = () => ({\n  skipGetIfExists: false,\n})\n\nexport const useServiceStore = <M extends AnyData, Q extends Query>(_options: UseServiceStoreOptions) => {\n  const options = Object.assign({}, makeDefaultOptions(), _options)\n  const { idField, whitelist, paramsForServer, defaultLimit, customSiftOperators } = options\n\n  function setupInstance<N extends M>(this: any, data: N) {\n    const asBaseModel = useModelInstance(data, {\n      idField,\n      clonesById: cloneStorage.byId,\n      clone,\n      commit,\n      reset,\n      createInStore,\n      removeFromStore,\n    })\n\n    if (data.__isSetup) return asBaseModel\n    else {\n      const afterSetup = options.setupInstance ? options.setupInstance(asBaseModel) : asBaseModel\n      Object.defineProperty(afterSetup, '__isSetup', { value: true })\n      return afterSetup\n    }\n  }\n\n  // pending state\n  const pendingState = useServicePending()\n\n  // storage\n  const { itemStorage, tempStorage, cloneStorage, clone, commit, reset, addItemToStorage } = useAllStorageTypes<M>({\n    getIdField: (val: AnyData) => val[idField],\n    setupInstance,\n  })\n\n  const isSsr = computed(() => {\n    const ssr = unref(options.ssr)\n    return !!ssr\n  })\n\n  // pagination\n  const { pagination, clearPagination, updatePaginationForQuery, getQueryInfo, unflagSsr } = useServicePagination({\n    idField,\n    isSsr,\n    defaultLimit,\n  })\n\n  function clearAll() {\n    itemStorage.clear()\n    tempStorage.clear()\n    cloneStorage.clear()\n    clearPagination()\n    pendingState.clearAllPending()\n  }\n\n  // local data filtering\n  const { findInStore, findOneInStore, countInStore, getFromStore, createInStore, patchInStore, removeFromStore } =\n    useServiceLocal<M, Q>({\n      idField,\n      itemStorage,\n      tempStorage,\n      cloneStorage,\n      addItemToStorage,\n      whitelist,\n      paramsForServer,\n      customSiftOperators,\n    })\n\n  // event locks\n  const eventLocks = useServiceEventLocks()\n\n  const store = {\n    new: setupInstance,\n    idField,\n    isSsr,\n    defaultLimit,\n\n    // items\n    itemsById: itemStorage.byId,\n    items: itemStorage.list,\n    itemIds: itemStorage.ids,\n\n    // temps\n    tempsById: tempStorage.byId,\n    temps: tempStorage.list,\n    tempIds: tempStorage.ids,\n\n    // clones\n    clonesById: cloneStorage.byId,\n    clones: cloneStorage.list,\n    cloneIds: cloneStorage.ids,\n    clone,\n    commit,\n    reset,\n\n    // local queries\n    findInStore,\n    findOneInStore,\n    countInStore,\n    createInStore,\n    getFromStore,\n    patchInStore,\n    removeFromStore,\n    clearAll,\n\n    // server options\n    whitelist,\n    paramsForServer,\n\n    // server pagination\n    pagination,\n    updatePaginationForQuery,\n    unflagSsr,\n    getQueryInfo,\n    ...pendingState,\n    ...eventLocks,\n  }\n\n  return store\n}\n","import { watch } from 'vue-demi'\n\ntype EventName = 'created' | 'updated' | 'patched' | 'removed'\n\ninterface QueuePromiseState {\n  promise: Promise<any>\n  isResolved: boolean\n  getter: 'isCreatePending' | 'isUpdatePending' | 'isPatchPending' | 'isRemovePending'\n}\n\nconst events = ['created', 'updated', 'patched', 'removed']\nconst state: { [key: string]: QueuePromiseState } = {}\n\nexport const makeGetterName = (event: EventName) =>\n  `is${event.slice(0, 1).toUpperCase()}${event.slice(1, event.length - 1)}Pending`\n\nexport const makeState = (event: EventName) => ({\n  promise: null,\n  isResolved: false,\n  getter: makeGetterName(event),\n})\nexport const resetState = () => {\n  events.forEach((e) => {\n    delete state[e]\n  })\n}\n/**\n * Creates or reuses a promise for each event type, like \"created\". The promise\n * resolves when the matching `isPending` attribute, like \"isCreatePending\" becomes\n * false.\n * @param store\n * @param event\n * @returns\n */\nexport function useQueuePromise(store: any, event: EventName) {\n  state[event] = state[event] || makeState(event)\n\n  if (!state[event].promise || state[event].isResolved) {\n    state[event].promise = new Promise((resolve) => {\n      const stopWatching = watch(\n        () => store[state[event].getter],\n        async (isPending) => {\n          if (!isPending) {\n            setTimeout(() => {\n              stopWatching()\n              state[event].isResolved = true\n              resolve(state[event].isResolved)\n            }, 0)\n          }\n        },\n        { immediate: true },\n      )\n    })\n  }\n  return state[event].promise\n}\n","module.exports = debounce;\n\nfunction debounce(fn, delay, atStart, guarantee) {\n  var timeout;\n  var args;\n  var self;\n\n  return function debounced() {\n    self = this;\n    args = Array.prototype.slice.call(arguments);\n\n    if (timeout && (atStart || guarantee)) {\n      return;\n    } else if (!atStart) {\n      clear();\n\n      timeout = setTimeout(run, delay);\n      return timeout;\n    }\n\n    timeout = setTimeout(clear, delay);\n    fn.apply(self, args);\n\n    function run() {\n      clear();\n      fn.apply(self, args);\n    }\n\n    function clear() {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n  };\n}\n","import type { FeathersService } from '@feathersjs/feathers'\nimport type { HandleEvents, HandledEvents } from './types'\nimport type { AnyData } from '../types'\nimport { del, ref, set } from 'vue-demi'\nimport { convertData, getId, hasOwn } from '../utils'\nimport _debounce from 'just-debounce'\nimport type { PiniaService } from '../create-pinia-service'\n\ninterface UseServiceStoreEventsOptions<M extends AnyData> {\n  service: PiniaService<FeathersService>\n  debounceEventsTime?: number\n  debounceEventsGuarantee?: boolean\n  handleEvents?: HandleEvents<M>\n}\n\nexport const useServiceEvents = <M extends AnyData>(options: UseServiceStoreEventsOptions<M>) => {\n  if (!options.service || options.handleEvents === false) return\n\n  const service = options.service\n\n  const addOrUpdateById = ref({})\n  const removeItemsById = ref({})\n\n  const flushAddOrUpdateQueue = _debounce(\n    async () => {\n      const values = Object.values(addOrUpdateById.value)\n      if (values.length === 0) return\n      service.store.createInStore(values)\n      addOrUpdateById.value = {}\n    },\n    options.debounceEventsTime || 20,\n    undefined,\n    options.debounceEventsGuarantee,\n  )\n\n  function enqueueAddOrUpdate(item: any) {\n    const id = getId(item, service.store.idField)\n    if (!id) return\n\n    set(addOrUpdateById, id, item)\n\n    if (hasOwn(removeItemsById.value, id)) del(removeItemsById, id)\n\n    flushAddOrUpdateQueue()\n  }\n\n  const flushRemoveItemQueue = _debounce(\n    () => {\n      const values = Object.values(removeItemsById.value)\n      if (values.length === 0) return\n      service.store.removeFromStore(values)\n      removeItemsById.value = {}\n    },\n    options.debounceEventsTime || 20,\n    undefined,\n    options.debounceEventsGuarantee,\n  )\n\n  function enqueueRemoval(item: any) {\n    const id = getId(item, service.store.idField)\n    if (!id) return\n\n    set(removeItemsById, id, item)\n\n    if (hasOwn(addOrUpdateById.value, id)) del(addOrUpdateById.value, id)\n\n    flushRemoveItemQueue()\n  }\n\n  function handleEvent(eventName: HandledEvents, item: any) {\n    const handler = (options.handleEvents as any)?.[eventName]\n    if (handler === false) return\n\n    /**\n     * For `created` events, we don't know the id since it gets assigned on the server. Also, since `created` events\n     * arrive before the `create` response, we only act on other events. For all other events, toggle the event lock.\n     */\n    const id = getId(item, service.store.idField)\n    if (eventName !== 'created' && service.store.eventLocks[eventName][id]) {\n      service.store.toggleEventLock(id, eventName)\n      return\n    }\n\n    if (handler) {\n      const handled = handler(item, { service })\n      if (!handled) return\n    }\n\n    if (!options.debounceEventsTime)\n      eventName === 'removed' ? service.store.removeFromStore(item) : service.store.createInStore(item)\n    else eventName === 'removed' ? enqueueRemoval(item) : enqueueAddOrUpdate(item)\n  }\n\n  // Listen to socket events when available.\n  service.on('created', (item: any) => {\n    const data = convertData(service, item)\n    handleEvent('created', data)\n  })\n  service.on('updated', (item: any) => {\n    const data = convertData(service, item)\n    handleEvent('updated', data)\n  })\n  service.on('patched', (item: any) => {\n    const data = convertData(service, item)\n    handleEvent('patched', data)\n  })\n  service.on('removed', (item: any) => {\n    const data = convertData(service, item)\n    handleEvent('removed', data)\n  })\n}\n","import type { HookContext, NextFunction } from '@feathersjs/feathers'\nimport { deepUnref } from '../utils'\n\n/**\n * deeply unrefs `params.query`\n */\nexport const unrefQuery = () => async (context: HookContext, next: NextFunction) => {\n  if (context.params.query) {\n    context.params.query = deepUnref(context.params.query)\n  }\n\n  if (context.method === 'find') {\n    const query = context.params.query || {}\n    if (query.$limit == null) {\n      query.$limit = context.service.store.defaultLimit\n    }\n    if (query.$skip == null) {\n      query.$skip = 0\n    }\n    context.params.query = query\n  }\n\n  await next()\n}\n","import type { HookContext, NextFunction } from '@feathersjs/feathers'\n\n/**\n * Controls pending state\n */\nexport const setPending = () => async (context: HookContext, next: NextFunction) => {\n  const store = context.service.store\n  let unsetPending\n\n  if (!store.isSsr) {\n    const method = context.method === 'find' ? (context.params.query?.$limit === 0 ? 'count' : 'find') : context.method\n\n    store.setPending(method, true)\n    if (context.id != null && method !== 'get')\n      store.setPendingById(context.id, method, true)\n\n    const isTemp = context.data?.__isTemp\n    const tempId = context.data?.__tempId\n    if (isTemp && method === 'create')\n      store.setPendingById(context.data.__tempId, method, true)\n\n    unsetPending = () => {\n      store.setPending(method, false)\n      const id = context.id != null ? context.id : tempId\n      if (id != null && method !== 'get')\n        store.setPendingById(id, method, false)\n    }\n  }\n\n  try {\n    await next()\n  }\n  catch (error) {\n    if (unsetPending)\n      unsetPending()\n\n    throw error\n  }\n\n  if (unsetPending)\n    unsetPending()\n}\n","import type { HookContext, NextFunction } from '@feathersjs/feathers'\n\nexport const eventLocks = () => async (context: HookContext, next: NextFunction) => {\n  const { id, method } = context\n  const store = context.service.store\n  const isLockableMethod = ['update', 'patch', 'remove'].includes(method)\n  const eventNames: any = {\n    update: 'updated',\n    patch: 'patched',\n    remove: 'removed',\n  }\n  const eventName = eventNames[method]\n\n  if (isLockableMethod && id && !store.isSsr)\n    store.toggleEventLock(id, eventName)\n\n  await next()\n\n  if (isLockableMethod && id && !store.isSsr)\n    store.clearEventLock(id, eventName)\n}\n","import type { HookContext, NextFunction } from '@feathersjs/feathers'\nimport { restoreTempIds } from '../utils'\n\nexport const syncStore = () => async (context: HookContext, next: NextFunction) => {\n  const { method, params } = context\n  const store = context.service.store\n\n  if (method === 'patch' && params.data) context.data = params.data\n\n  if (next) await next()\n\n  if (!context.params.skipStore) {\n    if (method === 'remove') {\n      store.removeFromStore(context.result)\n    } else if (method === 'create') {\n      const restoredTempIds = restoreTempIds(context.data, context.result)\n      context.result = store.createInStore(restoredTempIds)\n    } else if (method === 'find' && Array.isArray(context.result.data)) {\n      context.result.data = store.createInStore(context.result.data)\n    } else {\n      context.result = store.createInStore(context.result)\n    }\n\n    // Update pagination based on the qid\n    if (method === 'find' && context.result.total) {\n      const { qid = 'default', query, preserveSsr = false } = context.params\n      store.updatePaginationForQuery({ qid, response: context.result, query, preserveSsr })\n    }\n  }\n}\n","import type { HookContext, NextFunction } from '@feathersjs/feathers'\nimport type { AnyData } from '../types'\n\nexport const makeModelInstances = () => {\n  return async (context: HookContext, next: NextFunction) => {\n    if (next)\n      await next()\n\n    if (context.service.new) {\n      if (Array.isArray(context.result?.data))\n        context.result.data = context.result.data.map((i: AnyData) => context.service.new(i))\n\n      else if (Array.isArray(context.result))\n        context.result = context.result.map((i: AnyData) => context.service.new(i))\n\n      else\n        context.result = context.service.new(context.result)\n    }\n  }\n}\n","import type { HookContext, Id, NextFunction } from '@feathersjs/feathers'\n\n/**\n * Assures that the client reuses SSR-provided data instead of re-making the same query.\n *\n * Checks the `store.pagination` object to see if a query's results came from SSR-provided data.\n * If the data was from SSR, the SSR'd data is used and then set to `fromSSR = false` to allow\n * normal queries to happen again.\n */\nexport function handleFindSsr() {\n  return async (context: HookContext, next: NextFunction) => {\n    const store = context.service.store\n\n    if (context.method === 'find') {\n      const { params } = context\n      const info = store.getQueryInfo(params)\n      const qidData = store.pagination[info.qid]\n      const queryData = qidData?.[info.queryId]\n      const pageData = queryData?.[info.pageId as string]\n\n      if (pageData?.ssr) {\n        context.result = {\n          data: pageData.ids.map((id: Id) => store.getFromStore(id).value),\n          limit: pageData.pageParams.$limit,\n          skip: pageData.pageParams.$skip,\n          total: queryData.total,\n          fromSsr: true,\n        }\n        if (!params.preserveSsr)\n          store.unflagSsr(params)\n      }\n    }\n\n    if (next)\n      await next()\n  }\n}\n","import type { HookContext, NextFunction } from '@feathersjs/feathers'\nimport { hasOwn } from '../utils'\n\n/**\n * Normalizes two things\n *  - pagination across all adapters, including @feathersjs/memory\n *  - the find response so that it always holds data at `response.data`\n * @returns { data: AnyData[] }\n */\nexport const normalizeFind = () => async (context: HookContext, next?: NextFunction) => {\n  // Client-side services, like feathers-memory, require paginate.default to be truthy.\n  if (context.method === 'find') {\n    const { params } = context\n    const { query = {} } = params\n    const isPaginated = params.paginate === true || hasOwn(query, '$limit') || hasOwn(query, '$skip')\n    if (isPaginated) params.paginate = { default: true }\n  }\n\n  if (next) await next()\n\n  if (context.method === 'find' && !context.result.data) {\n    // context.result = { data: context.result }\n  }\n}\n","import type { HookContext, NextFunction } from '@feathersjs/feathers'\n\nexport const skipGetIfExists = () => async (context: HookContext, next: NextFunction) => {\n  const { params, id } = context\n  const store = context.service.store\n\n  if (context.method === 'get' && id != null) {\n    const skipIfExists = params.skipGetIfExists || store.skipGetIfExists\n    delete params.skipGetIfExists\n\n    // If the records is already in store, return it\n    const existingItem = store.getFromStore(context.id, params)\n    if (existingItem && skipIfExists) context.result = existingItem\n  }\n  await next()\n}\n","import type { HookContext, NextFunction } from '@feathersjs/feathers'\nimport fastCopy from 'fast-copy'\nimport { diff, pickDiff } from '../utils'\n\nexport const patchDiffing = () => async (context: HookContext, next: NextFunction) => {\n  const { method, data, params, id } = context\n  const store = context.service.store\n\n  let rollbackData: any\n  let clone: any\n  const shouldDiff = method === 'patch' && !params.data && (data.__isClone || params.diff)\n\n  if (shouldDiff) {\n    clone = data\n    const original = store.getFromStore(id).value\n    const diffedData = diff(original, clone, params.diff)\n    rollbackData = fastCopy(original)\n\n    // Do eager updating.\n    if (params.eager !== false) data.commit(diffedData)\n\n    // Always include matching values from `params.with`.\n    if (params.with) {\n      const dataFromWith = pickDiff(clone, params.with)\n      // If params.with was an object, merge the values into dataFromWith\n      if (typeof params.with !== 'string' && !Array.isArray(params.with)) Object.assign(dataFromWith, params.with)\n\n      Object.assign(diffedData, dataFromWith)\n    }\n\n    context.data = diffedData\n\n    // If diff is empty, return the clone without making a request.\n    if (Object.keys(context.data).length === 0) context.result = clone\n  } else {\n    context.data = fastCopy(data)\n  }\n\n  try {\n    await next()\n  } catch (error) {\n    if (shouldDiff) {\n      // If saving fails, reverse the eager update\n      clone && clone.commit(rollbackData)\n    }\n    throw error\n  }\n}\n","import { unrefQuery } from './0-prepare-query'\nimport { setPending } from './1-set-pending'\nimport { eventLocks } from './2-event-locks'\nimport { syncStore } from './3-sync-store'\nimport { makeModelInstances } from './4-model-instances'\nimport { handleFindSsr } from './5-handle-find-ssr'\nimport { normalizeFind } from './6-normalize-find'\nimport { skipGetIfExists } from './7-skip-get-if-exists'\nimport { patchDiffing } from './8-patch-diffs'\n\nexport { syncStore, setPending, eventLocks, normalizeFind, skipGetIfExists, makeModelInstances }\n\nexport const feathersPiniaHooks = () => [\n  unrefQuery(),\n  setPending(),\n  eventLocks(),\n  syncStore(),\n  makeModelInstances(),\n  handleFindSsr(),\n  normalizeFind(),\n  skipGetIfExists(),\n  patchDiffing(),\n]\n","import { BadRequest } from '@feathersjs/errors'\nimport type { FeathersService, Params } from '@feathersjs/feathers'\nimport type { AnyData } from '../types'\nimport { defineValues, defineGetters } from '../utils/define-properties'\nimport type { ServiceInstanceProps } from './types'\nimport type { PiniaService } from '../create-pinia-service'\n\ntype Service = FeathersService | PiniaService<FeathersService>\n\nexport interface useServiceInstanceOptions<S extends Service> {\n  service: S\n  store: any\n}\n\nexport const useServiceInstance = <M extends AnyData, S extends Service, P extends Params = Params>(\n  data: M,\n  options: useServiceInstanceOptions<S>,\n) => {\n  if (data.__isServiceInstance) return data\n\n  const { service, store } = options\n  const merge = (data: M, toMerge: AnyData) => Object.assign(data, toMerge)\n\n  defineGetters(data, {\n    isPending() {\n      return this.isCreatePending || this.isPatchPending || this.isRemovePending\n    },\n    isSavePending() {\n      return this.isCreatePending || this.isPatchPending\n    },\n    isCreatePending() {\n      return !!(store.createPendingById[this[store.idField]] || store.createPendingById[this.__tempId])\n    },\n    isPatchPending() {\n      return !!store.patchPendingById[this[store.idField]]\n    },\n    isRemovePending() {\n      return !!store.removePendingById[this[store.idField]]\n    },\n  } as any)\n\n  defineValues(data, {\n    __isServiceInstance: true,\n    save(this: M, params?: P) {\n      const id = this[store.idField]\n      return id != null ? this.patch(params) : this.create(params)\n    },\n    create(this: M, params?: P): Promise<M> {\n      return service.create(this, params).then((result) => merge(this, result))\n    },\n    patch(this: M, params?: P): Promise<M> {\n      const id = this[store.idField]\n      if (id === undefined) throw new BadRequest('the item has no id')\n      return service.patch(id, this, params).then((result) => merge(this, result))\n    },\n    remove(this: M, params?: P): Promise<M> {\n      if (this.__isTemp) {\n        store.removeFromStore(this.__tempId)\n        return Promise.resolve(this)\n      } else {\n        const id = this[store.idField]\n        return service.remove(id, params).then((result) => merge(this, result))\n      }\n    },\n  })\n\n  return data as M & ServiceInstanceProps<M, AnyData, P>\n}\n","import { defineValues } from '../utils'\n\nexport function storeAssociated(this: any, data: any, config: Record<string, string>) {\n  const updatedValues: any = {}\n  Object.keys(config).forEach((key) => {\n    const related = data[key]\n    const servicePath = config[key]\n    const service = this.service(servicePath)\n    if (!service)\n      console.error('there is no service at path ' + servicePath + 'check your storeAssociated config', data, config)\n    if (related && service) {\n      const created = service.createInStore(related)\n      updatedValues[key] = created\n    }\n  })\n\n  defineValues(data, updatedValues)\n\n  return\n}\n","import { computed, watch } from 'vue-demi'\nimport { _ } from '@feathersjs/commons'\nimport debounce from 'just-debounce'\n\n// Writes data to localStorage\nexport function writeToStorage(id: string, data: any, storage: any) {\n  const compressed = JSON.stringify(data)\n  storage.setItem(id, compressed)\n}\n\n// Moves data from localStorage into the store\nexport function hydrateStore(store: any, storage: any) {\n  const data = storage.getItem(store.$id)\n  if (data) {\n    const hydrationData = JSON.parse(data as string) || {}\n    Object.assign(store, hydrationData)\n  }\n}\n\n/**\n *\n * @param store pinia store\n * @param keys an array of keys to watch and write to localStorage.\n */\nexport function syncWithStorage(store: any, stateKeys: Array<string>, storage: Storage = window.localStorage) {\n  hydrateStore(store, storage)\n\n  const debouncedWrite = debounce(writeToStorage, 500)\n  const toWatch = computed(() => _.pick(store, ...stateKeys))\n\n  watch(toWatch, (val) => debouncedWrite(store.$id, val, storage), { deep: true })\n}\n","/**\n * Clears all services from localStorage. You might use this when a user\n * logs out to make sure their data doesn't persist for the next user.\n *\n * @param storage an object using the Storage interface\n */\nexport function clearStorage(storage: Storage = window.localStorage) {\n  Object.keys(storage).map((key) => {\n    if (key.startsWith('service.')) {\n      storage.removeItem(key)\n    }\n  })\n}\n","import type { Application, FeathersService } from '@feathersjs/feathers'\nimport type { HandleEvents } from './stores'\nimport type { AnyData } from './types'\nimport { feathers } from '@feathersjs/feathers'\nimport { defineStore } from 'pinia'\nimport { PiniaService } from './create-pinia-service'\nimport { useServiceStore, useServiceEvents } from './stores'\nimport { feathersPiniaHooks } from './hooks'\nimport { storeAssociated, useServiceInstance } from './modeling'\nimport { defineGetters } from './utils'\nimport { clearStorage, syncWithStorage as __sync } from './localstorage'\n\ninterface SetupInstanceUtils {\n  app?: any\n  service?: any\n  servicePath?: string\n}\n\ninterface PiniaServiceConfig {\n  idField?: string\n  defaultLimit?: number\n  syncWithStorage?: boolean | string[]\n  whitelist?: string[]\n  paramsForServer?: string[]\n  skipGetIfExists?: boolean\n  handleEvents?: HandleEvents<AnyData>\n  debounceEventsTime?: number\n  debounceEventsGuarantee?: boolean\n  setupInstance?: (data: any, utils: SetupInstanceUtils) => any\n  customizeStore?: (data: ReturnType<typeof useServiceStore>) => Record<string, any>\n  customSiftOperators?: Record<string, any>\n}\n\ninterface CreatePiniaClientConfig extends PiniaServiceConfig {\n  idField: string\n  pinia: any\n  ssr?: boolean\n  storage?: Storage\n  services?: Record<string, PiniaServiceConfig>\n}\n\ntype CreatePiniaServiceTypes<T extends { [key: string]: FeathersService }> = {\n  [Key in keyof T]: PiniaService<T[Key]>\n}\n\ninterface AppExtensions {\n  storeAssociated: (data: any, config: Record<string, string>) => void\n  clearStorage: () => void\n}\n\nexport function createPiniaClient<Client extends Application>(\n  client: Client,\n  options: CreatePiniaClientConfig,\n): Application<CreatePiniaServiceTypes<Client['services']>> & AppExtensions {\n  const vueApp = feathers()\n\n  vueApp.defaultService = function (location: string) {\n    const serviceOptions = options.services?.[location] || {}\n\n    // combine service and global options\n    const idField = serviceOptions.idField || options.idField\n    const defaultLimit = serviceOptions.defaultLimit || options.defaultLimit || 10\n    const whitelist = (serviceOptions.whitelist || []).concat(options.whitelist || [])\n    const paramsForServer = (serviceOptions.paramsForServer || []).concat(options.paramsForServer || [])\n    const handleEvents = serviceOptions.handleEvents || options.handleEvents\n    const debounceEventsTime =\n      serviceOptions.debounceEventsTime != null ? serviceOptions.debounceEventsTime : options.debounceEventsTime\n    const debounceEventsGuarantee =\n      serviceOptions.debounceEventsGuarantee != null\n        ? serviceOptions.debounceEventsGuarantee\n        : options.debounceEventsGuarantee\n    const customSiftOperators = Object.assign(\n      {},\n      serviceOptions.customSiftOperators || {},\n      options.customSiftOperators || {},\n    )\n    function customizeStore(utils: any) {\n      const fromGlobal = Object.assign(utils, options.customizeStore ? options.customizeStore(utils) : utils)\n      const fromService = Object.assign(\n        fromGlobal,\n        serviceOptions.customizeStore ? serviceOptions.customizeStore(fromGlobal) : fromGlobal,\n      )\n      return fromService\n    }\n\n    function wrappedSetupInstance(data: any) {\n      const asFeathersModel = useServiceInstance(data, {\n        service: vueApp.service(location),\n        store,\n      })\n\n      // call the provided `setupInstance`\n      const utils = { app: vueApp, service: vueApp.service(location), servicePath: location }\n      const fromGlobal = options.setupInstance ? options.setupInstance(asFeathersModel, utils) : asFeathersModel\n      const serviceLevel = serviceOptions.setupInstance ? serviceOptions.setupInstance(data, utils) : fromGlobal\n      return serviceLevel\n    }\n\n    // create pinia store\n    const storeName = `service:${location}`\n    const useStore = defineStore(storeName, () => {\n      const utils = useServiceStore({\n        idField,\n        defaultLimit,\n        whitelist,\n        paramsForServer,\n        customSiftOperators,\n        ssr: options.ssr,\n        setupInstance: wrappedSetupInstance,\n      })\n      const custom = customizeStore(utils)\n      return { ...utils, ...custom }\n    })\n    const store = useStore(options.pinia)\n\n    // storage-sync\n    if (!options.ssr && options.storage) {\n      const defaultStorageKeys = ['itemsById', 'pagination']\n      const globalStorageKeys =\n        options.syncWithStorage === true\n          ? defaultStorageKeys\n          : Array.isArray(options.syncWithStorage)\n          ? options.syncWithStorage\n          : []\n      const serviceStorageKeys =\n        serviceOptions.syncWithStorage === true\n          ? defaultStorageKeys\n          : Array.isArray(serviceOptions.syncWithStorage)\n          ? serviceOptions.syncWithStorage\n          : []\n      const syncWithStorage = [...new Set([...globalStorageKeys, ...serviceStorageKeys])]\n      const shouldSyncStorage = syncWithStorage.length > 0\n      if (shouldSyncStorage) {\n        __sync(store, syncWithStorage, options.storage)\n      }\n    }\n\n    const clientService = client.service(location)\n    const piniaService = new PiniaService(clientService, { store, servicePath: location })\n\n    useServiceEvents({\n      service: piniaService,\n      debounceEventsTime,\n      debounceEventsGuarantee,\n      handleEvents,\n    })\n\n    return piniaService\n  }\n\n  // register hooks on every service\n  const mixin: any = (service: any) => {\n    service.hooks({\n      around: feathersPiniaHooks(),\n    })\n  }\n  vueApp.mixins.push(mixin)\n\n  defineGetters(vueApp, {\n    authentication() {\n      return (client as any).authentication\n    },\n    authenticate() {\n      return (client as any).authenticate\n    },\n    reAuthenticate() {\n      return (client as any).reAuthenticate\n    },\n    logout() {\n      return (client as any).logout\n    },\n    clearStorage() {\n      if (!options.ssr && options.storage) {\n        return clearStorage(options.storage)\n      }\n    },\n  })\n\n  Object.assign(vueApp, { storeAssociated })\n\n  return vueApp as Application<CreatePiniaServiceTypes<Client['services']>> & AppExtensions\n}\n","import { FetchClient } from '@feathersjs/rest-client'\nimport type { Params } from '@feathersjs/feathers'\n\n// A feathers-rest transport adapter for https://github.com/unjs/ofetch\nexport class OFetch extends FetchClient {\n  async request(options: any, params: Params) {\n    const fetchOptions = Object.assign({}, options, (params as any).connection)\n\n    fetchOptions.headers = Object.assign({ Accept: 'application/json' }, this.options.headers, fetchOptions.headers)\n\n    if (options.body) fetchOptions.body = options.body\n\n    try {\n      const response = await this.connection.raw(options.url, fetchOptions)\n      const { _data, status } = response\n\n      if (status === 204) return null\n      return _data\n    } catch (error) {\n      console.error('feathers-ofetch request error', error)\n      throw error\n    }\n  }\n}\n","export const feathersPiniaAutoImport = {\n  'feathers-pinia': [\n    'useServiceInstance',\n    'useInstanceDefaults',\n    'useDataStore',\n    'useAuth',\n    'createPiniaClient',\n    'defineGetters',\n    'defineSetters',\n    'defineValues',\n  ],\n}\n","function e(e){this.message=e}e.prototype=new Error,e.prototype.name=\"InvalidCharacterError\";var r=\"undefined\"!=typeof window&&window.atob&&window.atob.bind(window)||function(r){var t=String(r).replace(/=+$/,\"\");if(t.length%4==1)throw new e(\"'atob' failed: The string to be decoded is not correctly encoded.\");for(var n,o,a=0,i=0,c=\"\";o=t.charAt(i++);~o&&(n=a%4?64*n+o:o,a++%4)?c+=String.fromCharCode(255&n>>(-2*a&6)):0)o=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".indexOf(o);return c};function t(e){var t=e.replace(/-/g,\"+\").replace(/_/g,\"/\");switch(t.length%4){case 0:break;case 2:t+=\"==\";break;case 3:t+=\"=\";break;default:throw\"Illegal base64url string!\"}try{return function(e){return decodeURIComponent(r(e).replace(/(.)/g,(function(e,r){var t=r.charCodeAt(0).toString(16).toUpperCase();return t.length<2&&(t=\"0\"+t),\"%\"+t})))}(t)}catch(e){return r(t)}}function n(e){this.message=e}function o(e,r){if(\"string\"!=typeof e)throw new n(\"Invalid token specified\");var o=!0===(r=r||{}).header?0:1;try{return JSON.parse(t(e.split(\".\")[o]))}catch(e){throw new n(\"Invalid token specified: \"+e.message)}}n.prototype=new Error,n.prototype.name=\"InvalidTokenError\";export default o;export{n as InvalidTokenError};\n//# sourceMappingURL=jwt-decode.esm.js.map\n","import type { Ref } from 'vue-demi'\nimport type { NullableId } from '@feathersjs/feathers'\nimport { computed, ref } from 'vue-demi'\nimport { BadRequest } from '@feathersjs/errors'\nimport decode from 'jwt-decode'\nimport { useCounter } from '../utils/use-counter'\n\ntype SuccessHandler = (result: Record<string, any>) => Promise<Record<string, any> | void>\ntype ErrorHandler = (error: Error) => Promise<void>\n\ninterface UseAuthOptions {\n  api: any\n  servicePath?: string\n  skipTokenCheck?: boolean\n  entityKey?: string\n  onSuccess?: SuccessHandler\n  onError?: ErrorHandler\n  onInitSuccess?: SuccessHandler\n  onInitError?: ErrorHandler\n  onLogoutSuccess?: SuccessHandler\n  onLogoutError?: ErrorHandler\n}\n\ninterface AuthenticateData {\n  strategy: 'jwt' | 'local'\n  accessToken?: string\n  email?: string\n  password?: string\n}\n\nexport function useAuth<d = AuthenticateData>(options: UseAuthOptions) {\n  const { api, servicePath, skipTokenCheck } = options\n  const entityService = servicePath ? api.service(servicePath) : null\n  const entityKey = options.entityKey || 'user'\n\n  // external flow\n  const promise = ref() as Ref<Promise<Record<string, any>>>\n  const defaultHandler = async () => undefined\n  const defaultErrorHandler = async (error: any) => {\n    throw error\n  }\n  const onSuccess: SuccessHandler = options.onSuccess || defaultHandler\n  const onError: ErrorHandler = options.onError || defaultErrorHandler\n  const onInitSuccess: SuccessHandler = options.onInitSuccess || defaultHandler\n  const onInitError: ErrorHandler = options.onInitError || defaultHandler\n  const onLogoutSuccess: SuccessHandler = options.onLogoutSuccess || defaultHandler\n  const onLogoutError: ErrorHandler = options.onLogoutError || defaultErrorHandler\n\n  // user\n  const userId = ref<NullableId>(null)\n  const user = computed(() => {\n    if (!entityService) return null\n    const u = entityService?.getFromStore(userId)\n    return u.value || null\n  })\n\n  // error\n  const error = ref<Error | null>(null)\n  const clearError = () => (error.value = null)\n\n  // authenticate\n  const authCounter = useCounter()\n  const isPending = computed(() => !!authCounter.count.value)\n  const isAuthenticated = ref(false)\n  const handleAuthResult = (result: any) => {\n    const entity = result[entityKey]\n    if (entityService && entity) {\n      const stored = entityService.store.createInStore(entity)\n      userId.value = stored[entityService.store.idField] || stored.__tempId\n    }\n    isAuthenticated.value = true\n    return result\n  }\n  const authenticate = async (data?: d) => {\n    authCounter.add()\n    clearError()\n    promise.value = api\n      .authenticate(data)\n      .then(handleAuthResult)\n      .then(async (result: Record<string, any>) => {\n        const _result = await onSuccess(result)\n        return _result || result\n      })\n      .catch((err: any) => {\n        error.value = err\n        return onError(err)\n      })\n      .finally(() => {\n        authCounter.sub()\n      })\n    return promise.value\n  }\n\n  // token check\n  const isTokenExpired = (jwt: string) => {\n    try {\n      const payload = decode(jwt) as any\n      return new Date().getTime() > payload.exp * 1000\n    } catch (error) {\n      return false\n    }\n  }\n\n  // reauthentication at app start\n  const isInitDone = ref(false)\n  const reAuthenticate = async () => {\n    authCounter.add()\n    promise.value = api.authentication\n      .getAccessToken()\n      .then((accessToken: string) => {\n        if (accessToken && !skipTokenCheck && isTokenExpired(accessToken)) {\n          api.authentication.removeAccessToken()\n          throw new BadRequest('accessToken expired')\n        }\n      })\n      .then(() => api.reAuthenticate())\n      .then(handleAuthResult)\n      .then(async (result: Record<string, any>) => {\n        const _result = await onInitSuccess(result)\n        return _result || result\n      })\n      .catch((error: any) => {\n        error.value = error\n        return onInitError(error)\n      })\n      .finally(() => {\n        authCounter.sub()\n        isInitDone.value = true\n      })\n    return promise.value\n  }\n\n  // logout\n  const logoutCounter = useCounter()\n  const isLogoutPending = computed(() => !!logoutCounter.count.value)\n  const logout = async () => {\n    logoutCounter.add()\n    return api\n      .logout()\n      .then((response: any) => {\n        userId.value = null\n        isAuthenticated.value = false\n        return response\n      })\n      .then(onLogoutSuccess)\n      .catch((error: any) => {\n        error.value = error\n        return onLogoutError(error)\n      })\n      .finally(() => logoutCounter.sub())\n  }\n\n  // login redirect\n  const loginRedirect = ref<string | Record<string, any> | null>(null)\n\n  return {\n    user,\n    error,\n    isPending,\n    isLogoutPending,\n    isInitDone,\n    isAuthenticated,\n    loginRedirect,\n    getPromise: () => promise.value,\n    isTokenExpired,\n    authenticate,\n    reAuthenticate,\n    logout,\n    clearError,\n  }\n}\n"],"names":["fastDeepEqual","equal","a","b","length","i","keys","key","toStringFunction","create","toStringObject","LegacyCache","value","createCacheLegacy","createCacheModern","createCache","getCleanClone","prototype","Constructor","getRegExpFlagsLegacy","regExp","flags","getRegExpFlagsModern","getRegExpFlags","getTagLegacy","type","getTagModern","getTag","defineProperty","getOwnPropertyDescriptor","getOwnPropertyNames","getOwnPropertySymbols","_a","hasOwnProperty","propertyIsEnumerable","SUPPORTS_SYMBOL","getStrictPropertiesModern","object","getStrictProperties","copyOwnPropertiesStrict","clone","state","properties","index","length_1","property","descriptor","copyArrayLoose","array","length_2","copyArrayStrict","copyArrayBuffer","arrayBuffer","_state","copyBlob","blob","copyDataView","dataView","copyDate","date","copyMapLoose","map","copyMapStrict","copyObjectLooseLegacy","copyObjectLooseModern","symbols","length_3","symbol","copyObjectLoose","copyObjectStrict","copyPrimitiveWrapper","primitiveObject","copyRegExp","copySelf","copySetLoose","set","copySetStrict","isArray","assign","getPrototypeOf","obj","DEFAULT_LOOSE_OPTIONS","DEFAULT_STRICT_OPTIONS","getTagSpecificCopiers","options","createCopier","normalizedOptions","tagSpecificCopiers","copier","tagSpecificCopier","createStrictCopier","defineValues","data","defineGetters","defineSetters","convertData","service","result","getExtendedQueryInfo","queryInfo","store","qid","queryState","total","pageState","ids","queriedAt","ssr","id","items","hasOwn","prop","getArray","pickDiff","diffDef","topLevelKeys","_","diff","original","originalVal","cloneVal","isEqual","restoreTempIds","resData","tempIdField","sourceItems","responseItems","item","tempId","stringifyIfObject","val","getId","idField","getParams","params","fastCopy","unref","timeout","ms","resolve","useCounter","count","ref","isObject","deepUnref","checkedVal","isRef","unrefArray","unrefObject","smartUnref","arr","unreffed","useInstanceDefaults","defaults","dataKeys","defaultsToApply","toValue","r","noop","createFilterWrapper","filter","fn","wrapper","args","reject","debounceFilter","timer","maxTimer","lastRejector","_clearTimeout","timer2","invoke","duration","maxDuration","useDebounceFn","fastJsonStableStringify","opts","cycles","cmp","f","node","aobj","bobj","seen","stringify","out","seenIndex","getIdsFromQueryInfo","pagination","queryId","pageId","queryLevel","pageLevel","itemsFromPagination","usePageData","limit","skip","request","pageCount","computed","currentPage","pageNumber","newSkip","skipVal","canPrev","canNext","wait","page","useFind","deps","debounce","immediate","_watch","paginateOn","_b","_d","_c","paramsWithPagination","query","paramsWithoutPagination","queryShallowCopy","isPending","haveBeenRequested","haveLoaded","error","clearError","cachedParams","updateCachedParams","localParams","beforeCurrent","itemsBeforeCurrent","adjustedSkip","whichQuery","cachedQuery","currentQuery","allItems","allLocalData","firstOfCurrentPage","indexInItems","adjustedIndex","queryWhenFn","queryWhen","_queryWhenFn","queries","latestQuery","previousQuery","requestCount","setupPendingState","find","__params","___params","response","extendedQueryInfo","err","findDebounced","makeRequest","p","pageData","toStart","toEnd","toPage","next","prev","watch","useGet","_id","_params","isSsr","hasBeenRequested","mostRecentId","getFromStore","hasLoaded","get","PiniaService","__publicField","asInstance","reactive","idOrData","results","eventName","listener","extendStatics","d","__extends","__","typeChecker","typeString","getClassName","comparable","coercePotentiallyNull","isFunction","isVanillaObject","equals","walkKeyPathValues","keyPath","depth","owner","currentKey","BaseOperation","owneryQuery","name","GroupOperation","_super","children","_this","root","done","keep","childOperation","NamedGroupOperation","QueryOperation","parent","NestedOperation","createTester","compare","comparableA","EqualsOperation","createEqualsOperation","numericalOperationCreator","createNumericalOperation","numericalOperation","typeofParams","test","actualValue","createNamedOperation","parentQuery","operationCreator","throwUnsupportedOperation","containsOperation","createNestedOperation","nestedQuery","parentKey","createQueryOperations","selfOperations","nestedOperations","createQueryOperation","operations","ops","op","createOperationTester","operation","$Ne","$ElemMatch","child","$Not","$Size","assertGroupNotEmpty","values","$Or","success","$Nor","$In","length_4","$Nin","ownerQuery","$Exists","$And","$All","$eq","$ne","$or","$nor","$elemMatch","$nin","$in","$lt","$lte","$gt","$gte","$mod","mod","equalsValue","$exists","$regex","pattern","$not","typeAliases","v","$type","clazz","$and","$all","$size","$options","$where","defaultOperations","createDefaultQueryOperation","createDefaultQueryTester","like","search","regexOptions","specials","iLike","str","$like","$notLike","$ilike","sqlOperations","FILTERS","additionalOperators","useServiceLocal","itemStorage","tempStorage","cloneStorage","addItemToStorage","paramsForServer","whitelist","customSiftOperators","_filterQueryOperators","filterItems","startingValues","_paramsForServer","q","filters","filterQuery","sift","findInStore","filtered","sorter","findOneInStore","countInStore","existingItem","select","tempItem","createInStore","_items","patchInStore","_idOrData","_data","updateItems","toWrite","fromStore","patchedItems","removeFromStore","clones","removeItems","useServiceStorage","onRead","beforeWrite","dest","src","byId","list","has","hasItem","merge","existing","getItem","setItem","inStore","vueSet","remove","removeItem","hadItem","vueDel","useServiceTemps","moveTempToItems","useServiceClones","defaultMakeCopy","isClone","makeCopy","assureOriginalIsStored","existingClone","reset","commit","itemId","_item","copied","vueDelete","markAsClone","useAllStorageTypes","getIdField","setupInstance","_increment","_pid","_machine","storage","mongoMachineId","ObjectID","strOid","timestamp","machine","pid","increment","module","require$$0","useModelInstance","clonesById","__isClone","makeDefaultOptions","useDataStore","_options","asBaseModel","afterSetup","clearAll","debug","debuggers","noopDebug","defaultInitializer","setDebug","createDebug","__createBinding","this","m","k","k2","desc","__exportStar","exports","stripSlashes","callback","first","rest","source","target","isPromise","createSymbol","useServicePagination","defaultLimit","clearPagination","defaultSkip","updatePaginationForQuery","preserveSsr","queryParams","pageParams","getQueryInfo","mostRecent","existingPageData","qidData","queryData","newState","unflagSsr","$limit","$skip","defaultPending","useServicePending","createPendingById","updatePendingById","patchPendingById","removePendingById","isFindPending","isCountPending","isGetPending","isCreatePending","isUpdatePending","isPatchPending","isRemovePending","setPending","method","setPendingById","place","del","unsetPendingById","clearAllPending","useServiceEventLocks","eventLocks","toggleEventLock","event","clearEventLock","useServiceStore","pendingState","makeGetterName","makeState","useQueuePromise","stopWatching","justDebounce","delay","atStart","guarantee","self","clear","run","useServiceEvents","addOrUpdateById","removeItemsById","flushAddOrUpdateQueue","_debounce","enqueueAddOrUpdate","flushRemoveItemQueue","enqueueRemoval","handleEvent","handler","unrefQuery","context","unsetPending","isTemp","isLockableMethod","syncStore","restoredTempIds","makeModelInstances","handleFindSsr","info","normalizeFind","skipGetIfExists","skipIfExists","patchDiffing","rollbackData","shouldDiff","diffedData","dataFromWith","feathersPiniaHooks","useServiceInstance","toMerge","BadRequest","storeAssociated","config","updatedValues","related","servicePath","created","writeToStorage","compressed","hydrateStore","hydrationData","syncWithStorage","stateKeys","debouncedWrite","toWatch","clearStorage","createPiniaClient","client","vueApp","feathers","location","serviceOptions","handleEvents","debounceEventsTime","debounceEventsGuarantee","customizeStore","utils","fromGlobal","wrappedSetupInstance","asFeathersModel","storeName","defineStore","custom","defaultStorageKeys","globalStorageKeys","serviceStorageKeys","__sync","clientService","piniaService","mixin","OFetch","FetchClient","fetchOptions","status","feathersPiniaAutoImport","e","n","o","c","t","useAuth","api","skipTokenCheck","entityService","entityKey","promise","defaultHandler","defaultErrorHandler","onSuccess","onError","onInitSuccess","onInitError","onLogoutSuccess","onLogoutError","userId","user","authCounter","isAuthenticated","handleAuthResult","entity","stored","authenticate","isTokenExpired","jwt","payload","decode","isInitDone","reAuthenticate","accessToken","logoutCounter","isLogoutPending","logout","loginRedirect"],"mappings":"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","x_google_ignoreList":[0,1,8,9,15,22,23,26,27,33,52]}